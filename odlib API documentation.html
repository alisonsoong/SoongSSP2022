<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc 0.10.0">
<title>odlib API documentation</title>
<meta name="description" content="">
<link rel="preload stylesheet" as="style" href="odlib%20API%20documentation_files/sanitize.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin="">
<link rel="preload stylesheet" as="style" href="odlib%20API%20documentation_files/typography.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin="">
<link rel="stylesheet preload" as="style" href="odlib%20API%20documentation_files/github.css" crossorigin="">
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer="defer" src="odlib%20API%20documentation_files/highlight.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin=""></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<nav class="http-server-breadcrumbs">
<a href="http://localhost:1111/">All packages</a>
</nav>
<h1 class="title">Module <code>odlib</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> numpy.polynomial.polynomial <span class="hljs-keyword">as</span> poly
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> matplotlib.lines <span class="hljs-keyword">import</span> Line2D
<span class="hljs-keyword">from</span> astropy.io <span class="hljs-keyword">import</span> fits
<span class="hljs-keyword">from</span> odlib <span class="hljs-keyword">import</span> *

<span class="hljs-comment"># angles/radians (declination and right ascension)</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decToRad</span>(<span class="hljs-params">dec:float</span>)-&gt;float:</span>
    <span class="hljs-string">""" Given decimal value return in radians
        Args:
            dec (float): decimal value
        Returns:
            float: value in radians
    """</span>
    <span class="hljs-keyword">return</span> float(dec)/<span class="hljs-number">180</span>*math.pi

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">HMStoDeg</span>(<span class="hljs-params">h:float,m:float,s:float,convert=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Given HMS, return in degrees or radians
        Args:
            h (float): hours
            m (float): minutes
            s (float): seconds
            convert (bool): True to convert to radians
        Returns:
            float: value in degrees or radians
    """</span>
    <span class="hljs-keyword">try</span>: h,m,s=float(h),float(m),float(s)
    <span class="hljs-keyword">except</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"Values must be floats"</span>)
    res = h*<span class="hljs-number">15</span> + m/<span class="hljs-number">60</span>*<span class="hljs-number">15</span> + s/<span class="hljs-number">3600</span>*<span class="hljs-number">15</span>
    res%=<span class="hljs-number">360</span>
    <span class="hljs-keyword">return</span> np.deg2rad(res) <span class="hljs-keyword">if</span> convert <span class="hljs-keyword">else</span> res

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">DMStoDeg</span>(<span class="hljs-params">d:float,arcm:float,arcs:float,convert=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Given DMS, return in degrees or radians
        Args:
            d (float): degrees
            m (float): minutes
            s (float): seconds
            convert (bool): True to convert to radians
        Returns:
            float: value in degrees or radians
    """</span>
    <span class="hljs-keyword">return</span> np.deg2rad(math.copysign(abs(d)+arcm/<span class="hljs-number">60</span>+arcs/<span class="hljs-number">3600</span>,d)) <span class="hljs-keyword">if</span> convert <span class="hljs-keyword">else</span> math.copysign(abs(d)+arcm/<span class="hljs-number">60</span>+arcs/<span class="hljs-number">3600</span>,d)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RAdecimalToHMS</span>(<span class="hljs-params">dec:float</span>)-&gt;tuple:</span>
    <span class="hljs-string">""" Converts from decimal to HMS (right ascension)
        Args:
            dec (float): decimal value
        Returns:
            tuple: (hours, minutes, seconds)
    """</span>
    dec%=<span class="hljs-number">360</span>
    h=dec/<span class="hljs-number">15</span>
    m=(dec%<span class="hljs-number">15</span>)/<span class="hljs-number">15</span>*<span class="hljs-number">60</span>
    s=m%<span class="hljs-number">1</span>*<span class="hljs-number">60</span>
    h//=<span class="hljs-number">1</span>
    m//=<span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> (h,m,s)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">DECdecimalToDMS</span>(<span class="hljs-params">dec:float</span>)-&gt;tuple:</span>
    <span class="hljs-string">""" Converts from decimal to DMS (declination)
        Args:
            dec (float): decimal value
        Returns:
            tuple: (degrees, minutes, seconds)
    """</span>
    d=math.trunc(dec)
    dec=abs(dec)-abs(d)
    m=math.trunc(dec*<span class="hljs-number">60</span>)
    dec-=m/<span class="hljs-number">60</span>
    s=dec*<span class="hljs-number">3600</span>
    <span class="hljs-keyword">return</span> (d,m,s)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngle</span>(<span class="hljs-params">sin:float,cos:float</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the angle (in radians) in the correct quadrant given sin and cos
        Args:
            sin (float): sin value
            cos (float): cos value
        Returns:
            float: resulting angle in radians
    """</span>
    <span class="hljs-keyword">return</span> math.atan2(sin,cos) % (math.pi*<span class="hljs-number">2</span>)

<span class="hljs-comment"># vector stuff</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cross</span>(<span class="hljs-params">v1:list, v2:list</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns the cross product of two 3D vectors
        Args:
            v1 (list): vector1
            v2 (list): vector2
        Returns:
            list: resulting cross product
    """</span>
    <span class="hljs-keyword">return</span> [(v1[<span class="hljs-number">1</span>]*v2[<span class="hljs-number">2</span>] - v1[<span class="hljs-number">2</span>]*v2[<span class="hljs-number">1</span>]),-(v1[<span class="hljs-number">0</span>]*v2[<span class="hljs-number">2</span>] - v1[<span class="hljs-number">2</span>]*v2[<span class="hljs-number">0</span>]),(v1[<span class="hljs-number">0</span>]*v2[<span class="hljs-number">1</span>] - v1[<span class="hljs-number">1</span>]*v2[<span class="hljs-number">0</span>])]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dot</span>(<span class="hljs-params">v1:list,v2:list</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the dot product of two vectors
        Args:
            v1 (list): vector1
            v2 (list): vector2
        Returns:
            float: resulting dot product
    """</span>
    <span class="hljs-keyword">return</span> sum([v1[i]*v2[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(v1))])

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">det2x2</span>(<span class="hljs-params">m</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the determinant of a 2x2 matrix
        Args:
            m (list): matrix
        Returns:
            float: resulting determinant
    """</span>
    <span class="hljs-keyword">return</span> m[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]*m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]-m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]*m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getMag</span>(<span class="hljs-params">vec:list</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the magnitude given a vector
        Args:
            vec (list): vector
        Returns:
            float: the magnitude of the vector
    """</span>
    <span class="hljs-keyword">return</span> math.sqrt(sum([vec[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vec))]))
    
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rotZX</span>(<span class="hljs-params">v:list,alpha:float,beta:float</span>)-&gt;list:</span>
    <span class="hljs-string">""" Rotates a vector around z axis with alpha, then rotates around x axis with beta'''
        Args:
            v (list): original vector
            alpha (float): angle to rotate around z axis (in radians)
            beta (float): angle to rotate around x axis (in radians)
        Returns:
            list: rotated vector
    """</span>
    z=np.array([[np.cos(alpha),-np.sin(alpha),<span class="hljs-number">0</span>],
                [np.sin(alpha),np.cos(alpha),<span class="hljs-number">0</span>],
                [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]])
    x=np.array([[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],
                [<span class="hljs-number">0</span>,np.cos(beta),-np.sin(beta)],
                [<span class="hljs-number">0</span>,np.sin(beta),np.cos(beta)]])
    <span class="hljs-keyword">return</span> np.dot(np.matmul(x,z),v)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rotX</span>(<span class="hljs-params">v:list,omega:float</span>)-&gt;list:</span>
    <span class="hljs-string">""" Rotates a vector around x axis with omega (in radians)'''
        Args:
            v (list): original vector
            omega (float): angle to rotate around x axis (in radians)
        Returns:
            list: rotated vector
    """</span>
    x=np.array([[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],
                [<span class="hljs-number">0</span>,np.cos(omega),-np.sin(omega)],
                [<span class="hljs-number">0</span>,np.sin(omega),np.cos(omega)]])
    <span class="hljs-keyword">return</span> np.matmul(x,v)

<span class="hljs-comment"># assorted other functions</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">newton</span>(<span class="hljs-params">func,der,init:float,err:float</span>)-&gt;float:</span> <span class="hljs-comment">#function, derivative, inital_guess, error_tolerance</span>
    <span class="hljs-string">""" Performs the Newton-Rhapson method
        Args:
            func (function): function
            der (function): derivative of function
            init (float): initial guess
            err (float): tolerance
        Returns:
            float: the answer
    """</span>
    prev=<span class="hljs-number">-1e10</span>
    <span class="hljs-keyword">while</span> abs(init-prev)&gt;=err:
        prev,init=init,init-func(init)/der(init)
    <span class="hljs-keyword">return</span> init

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">error</span>(<span class="hljs-params">acc:float,exp:float</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the error given accepted and experimental values
        Args:
            acc (float): accepted value
            exp (float): experimental value
        Returns:
            float: the error in percent
    """</span>
    <span class="hljs-keyword">return</span> math.copysign(abs(acc-exp)/acc*<span class="hljs-number">100</span>,<span class="hljs-number">1</span>)


<span class="hljs-comment"># OD code</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ODElements</span>:</span>
    <span class="hljs-string">'''Class that represents and calculates orbital elements'''</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, pos:list, vel:list, time:float</span>):</span>
        <span class="hljs-string">""" Initializes ODElements class
            Args:
                pos (list): position of asteroid
                vel (list): velocity of asteroid (non Gaussian)
                time (float): given time in julian days
            Returns:
                None
        """</span>
        <span class="hljs-comment"># constants</span>
        self.k = <span class="hljs-number">0.0172020989484</span> <span class="hljs-comment"># au^(3/2)/day</span>
        
        self.time=time
        self.vel=vel
        self.vel=np.array([self.vel[i]/(<span class="hljs-number">2</span>*math.pi)*<span class="hljs-number">365.2568983</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]) <span class="hljs-comment"># convert to Gaussian</span>
        self.pos=pos
        self.angMoment=self.getAngMoment()
        
        self.mu=<span class="hljs-number">1</span>
        self.a=self.getSemiMajor() <span class="hljs-comment"># semi-major axis</span>
        self.e= self.getEcc() <span class="hljs-comment"># eccentricity</span>
        self.i=self.getInc() <span class="hljs-comment"># inclination</span>
        self.o=self.getLongAsc() <span class="hljs-comment"># longitude of ascending node</span>
        self.v=self.getTrueAnom() <span class="hljs-comment"># true anomaly</span>
        self.w=self.getArgPer() <span class="hljs-comment"># argument of perihelion</span>
        self.M=self.getMeanAnomaly() <span class="hljs-comment"># mean anomaly</span>
        self.T=self.getPeriT() <span class="hljs-comment"># time of perihelion passage T</span>
      
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns info from given day from initialization
            Args:
                None
            Returns:
                list: all info
        """</span>
        <span class="hljs-keyword">return</span> self.info
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPos</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns the position of the asteroid
            Args:
                None
            Returns:
                list: the position
        """</span>
        <span class="hljs-keyword">return</span> self.pos
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getVel</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns the velocity of the asteroid
            Args:
                None
            Returns:
                list: the velocity
        """</span>
        <span class="hljs-keyword">return</span> self.vel
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPosMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns the magnitude of the position vector
            Args:
                None
            Returns:
                float: magnitude of position
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(sum([self.pos[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getVelMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns the magnitude of the velocity vector
            Args:
                None
            Returns:
                float: magnitude of velocity
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(sum([self.vel[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngMoment</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Calculates and returns the specific angular momentum
            Args:
                None
            Returns:
                list: specific angular momentum components
        """</span>
        pos,vel=self.getPos(),self.getVel()
        res=cross(pos,vel)
        <span class="hljs-keyword">return</span> np.array([res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>], res[<span class="hljs-number">2</span>]])
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngMomentMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns the magnitude of the specific angular momentum
            Args:
                None
            Returns:
                float: the magnitude of specific angular momentum
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(sum([self.angMoment[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSemiMajor</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the semi major axis using vis-viva
            Args:
                None
            Returns:
                float: the semi major axis
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/(<span class="hljs-number">2</span>/self.getPosMag() - dot(self.vel,self.vel)/self.mu)
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getEcc</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the eccentricity
            Args:
                None
            Returns:
                float: eccentricity
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(<span class="hljs-number">1</span>-dot(self.angMoment, self.angMoment)/(self.mu*self.a))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInc</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the inclination in degrees
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the inclination in degrees or radians
        """</span>
        <span class="hljs-keyword">return</span> math.acos(self.angMoment[<span class="hljs-number">2</span>]/self.getAngMomentMag()) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(math.acos(self.angMoment[<span class="hljs-number">2</span>]/self.getAngMomentMag()))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getLongAsc</span>(<span class="hljs-params">self, rad:bool=False</span>):</span>
        <span class="hljs-string">""" Calculates and returns the longitude of ascending node in degrees
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the longitude of ascending node in degrees or radians
        """</span>
        s=self.angMoment[<span class="hljs-number">0</span>]/(self.getAngMomentMag()*math.sin(np.deg2rad(self.i)))
        c=-self.angMoment[<span class="hljs-number">1</span>]/(self.getAngMomentMag()*math.sin(np.deg2rad(self.i)))
        <span class="hljs-keyword">return</span> getAngle(s,c) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(getAngle(s,c))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getArgPer</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the argument of perihelion in degrees
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the longitude of ascending node in degrees or radians
        """</span>
        x,y,z=self.pos[<span class="hljs-number">0</span>],self.pos[<span class="hljs-number">1</span>],self.pos[<span class="hljs-number">2</span>]
        s=z/(self.getPosMag()*math.sin(np.deg2rad(self.i)))
        c=(x*math.cos(np.deg2rad(self.o)) + y*math.sin(np.deg2rad(self.o)))/self.getPosMag()
        U=np.rad2deg(getAngle(s,c))
        <span class="hljs-keyword">return</span> np.deg2rad((U-self.v)%<span class="hljs-number">360</span>) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> (U-self.v)%<span class="hljs-number">360</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTrueAnom</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the true anomaly
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the true anomaly in degrees or radians
        """</span>
        c=<span class="hljs-number">1</span>/self.e*(self.a*(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)/self.getPosMag() - <span class="hljs-number">1</span>)
        s=self.a*(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)/(self.getAngMomentMag() * self.e)*dot(self.pos,self.vel)/self.getPosMag()
        <span class="hljs-keyword">return</span> getAngle(s,c) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(getAngle(s,c))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPeriT</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the time of perihelion
            Args:
                None
            Returns:
                float: the time of perihelion
        """</span>
        n=self.k/(self.a**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>))
        <span class="hljs-keyword">return</span> self.time-np.deg2rad(self.M)/n
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getMeanAnomaly</span>(<span class="hljs-params">self,rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the mean anomaly
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the mean anomaly in degrees or radians
        """</span>
        s=(self.getPosMag()*math.sin(np.deg2rad(self.v)))/(self.a*np.sqrt(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>))
        c=(self.e+np.cos(np.deg2rad(self.v)))/(<span class="hljs-number">1</span>+self.e*np.cos(np.deg2rad(self.v)))
        E=getAngle(s,c)
        <span class="hljs-keyword">return</span> E-self.e*np.sin(E) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(E-self.e*np.sin(E))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTimeMeanAnomaly</span>(<span class="hljs-params">self, time:float, date:str</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates mean anomaly for given date
            Args:
                time (float): time in Julian days for the Mean Anomaly
                date (str): date for Mean Anomaly
            Returns:
                float: mean anomaly in degrees
        """</span>
        n=self.k*np.sqrt(self.mu/(self.a**<span class="hljs-number">3</span>))
        M=np.rad2deg(n*(time-self.T))
        <span class="hljs-keyword">return</span> M
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printError</span>(<span class="hljs-params">self, results:list</span>):</span>
        <span class="hljs-string">""" Prints everything
            Args:
                None
            Returns:
                None
        """</span>
        <span class="hljs-comment"># EC, QR, IN, OM, W, Tp, N, MA, TA, A, AD, PR,</span>
        print(<span class="hljs-string">"Semi-major axis:"</span>, <span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">9</span>], <span class="hljs-string">"\n\tcalculated:"</span>,self.a, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">9</span>],self.a))
        print(<span class="hljs-string">"Eccentricity:"</span>, <span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">0</span>], <span class="hljs-string">"\n\tcalculated:"</span>,self.e, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">0</span>],self.e))
        print(<span class="hljs-string">"Inclination:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">2</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.i, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">2</span>],self.i))
        print(<span class="hljs-string">"Longitude of Ascending Node:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">3</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.o, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">3</span>],self.o))
        <span class="hljs-comment">#print("True anomaly:",results[8],self.v,error(results[8],self.v))</span>
        print(<span class="hljs-string">"Argument of perihelion:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">4</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.w, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">4</span>],self.w))
        print(<span class="hljs-string">"Time of Perihelion Passage T:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">5</span>],<span class="hljs-string">"\n\tcalculated:"</span>, self.T,<span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">5</span>],self.T))
        <span class="hljs-comment">#print("Mean Anomaly:",results[7],self.M,error(results[7],self.M))</span>
        <span class="hljs-comment">#print(od.a, od.e, od.i, od.o, od.v, od.w)</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getElements</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">""" Returns all orbital elements
            Args:
                rad (bool): True if return in radians
            Returns:
                floats: a,e,i,o,v,w,T,M
        """</span>
        <span class="hljs-keyword">return</span> self.a, self.e, self.i, self.o, self.v, self.w, self.T, self.M

<span class="hljs-comment"># Data class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Data</span>:</span>
    <span class="hljs-string">'''Class that reads and interprets data from input file'''</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">""" Initializes the class
            Args:
                None
            Returns:
                None
        """</span> 
        self.info=np.array([]) <span class="hljs-comment"># non formatted data from input file</span>
        self.inputData=<span class="hljs-literal">None</span> <span class="hljs-comment"># formatted data from input file (list)]</span>
        
        self.infoByTime={}
        self.infoByDate={} <span class="hljs-comment"># dictionary of values. date is key. format for key: 2018-Jul-14 00:00:00.0000</span>
        self.sunFileName=<span class="hljs-string">""</span>
        self.inputFileName=<span class="hljs-string">""</span>
        
        <span class="hljs-comment"># constants</span>
        self.JDTIME=<span class="hljs-number">0</span>
        self.DATE=<span class="hljs-number">1</span>
        self.RA=<span class="hljs-number">2</span>
        self.DEC=<span class="hljs-number">3</span>
        self.R=<span class="hljs-number">4</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInput</span>(<span class="hljs-params">self, file:str</span>)-&gt;list:</span>
        <span class="hljs-string">""" Formats and returns formatted input. Stores into dictionaries, and converts all RA and Dec 
            into decimals. 
            Args:
                file (str): the input file name
            Returns:
                list: the formatted input [jdtime (float), date (str), ra (float), dec (float), [RX,RY,RZ] (np.array)]
        """</span> 
        self.inputFileName=file
        self.info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        <span class="hljs-comment"># store in dictionary for fast retrieval; also, formats all the dec and ra, converting to decimals</span>
        <span class="hljs-comment"># [jdtime, date(str), ra, dec, [RX,RY,RZ] (np.array)]</span>
        self.inputData=[]

        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(self.info)):
            data=self.info[line]
            jdtime = float(data[<span class="hljs-number">0</span>])
            date = data[<span class="hljs-number">1</span>].strip()
            
            strRA,strDec = data[<span class="hljs-number">2</span>].split(<span class="hljs-string">':'</span>), data[<span class="hljs-number">3</span>].split(<span class="hljs-string">':'</span>)
            h,m,s=float(strRA[<span class="hljs-number">0</span>]),float(strRA[<span class="hljs-number">1</span>]),float(strRA[<span class="hljs-number">2</span>])
            ra=HMStoDeg(h,m,s)
            d,m,s=float(strDec[<span class="hljs-number">0</span>]),float(strDec[<span class="hljs-number">1</span>]),float(strDec[<span class="hljs-number">2</span>])
            dec=DMStoDeg(d,m,s)
            
            R=[float(data[<span class="hljs-number">4</span>]),float(data[<span class="hljs-number">5</span>]),float(data[<span class="hljs-number">6</span>])]
            
            self.inputData.append([jdtime, date, ra, dec, R])
            self.infoByDate[date] = [jdtime, date, ra, dec, R]
            self.infoByTime[jdtime] = [jdtime, date, ra, dec, R]
            
        <span class="hljs-keyword">return</span> self.inputData <span class="hljs-comment"># nothing is formatted, just all information</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSunInput</span>(<span class="hljs-params">self,date:str=None,time:float=None</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns the sun input for a given time
            Args:
                date (str): optional; the date for sun vector
                time (float): optional; the time in Julian days for sun vector
            Returns:
                list: the sun vector
        """</span> 
        <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(date==<span class="hljs-literal">None</span>):
            <span class="hljs-keyword">return</span> self.infoByDate[date][self.R]
            
        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(time==<span class="hljs-literal">None</span>):
            <span class="hljs-keyword">return</span> self.infoByTime[time][self.R]
        
        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># nothing has been inputted, throw an exception</span>
            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No time has been given to find sun input"</span>)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getRADECInput</span>(<span class="hljs-params">self,date:str=None,time:float=None</span>):</span>
        <span class="hljs-string">""" Returns the right ascension and declination for a given time
            Args:
                date (str): optional; the date for right ascension and declination
                time (float): optional; the time in Julian days for right ascension and declination
            Returns:
                floats: ra, dec
        """</span> 
        <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(date==<span class="hljs-literal">None</span>):
            d=self.infoByDate[date]
            <span class="hljs-keyword">return</span> d[self.RA], d[self.DEC]
            
        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(time==<span class="hljs-literal">None</span>):
            d=self.infoByTime[time]
            <span class="hljs-keyword">return</span> d[self.RA], d[self.DEC]
            
        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># nothing has been inputted, throw an exception</span>
            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No time has been given to find ra"</span>)
            
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getJDTime</span>(<span class="hljs-params">self,date:str</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns Julian Days time given date
            Args:
                date (str): optional; the date for right ascension and declination
                time (float): optional; the time in Julian days for right ascension and declination
            Returns:
                floats: ra, dec
        """</span> 
        <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
        
        d=self.infoByDate[date]
        <span class="hljs-keyword">return</span> d[self.JDTIME]

    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">formatTestInputInfo</span>(<span class="hljs-params">self, file:str</span>):</span>
        <span class="hljs-string">""" Returns re-formatted data from test input file (for testing purposes, specifically OD elements generation)
            Args:
                file (str): file name
            Returns:
                lists: time (in julian days), data [[x,y,z],[dx,dy,dz]], timestamps (strings)
        """</span>
        info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        time=np.array([float(info[i,<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(info))])
        timestamps=np.copy(info[<span class="hljs-number">1</span>:,<span class="hljs-number">1</span>])
        
        <span class="hljs-keyword">return</span> time,np.array([([float(info[i][<span class="hljs-number">2</span>]),float(info[i][<span class="hljs-number">3</span>]),float(info[i][<span class="hljs-number">4</span>])], 
                        [float(info[i][<span class="hljs-number">5</span>]),float(info[i][<span class="hljs-number">6</span>]),float(info[i][<span class="hljs-number">7</span>])]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(info))]), timestamps
   
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTestInput</span>(<span class="hljs-params">self, file:str, date:str</span>):</span>
        <span class="hljs-string">""" Returns pos, vel, and times for testing asteroid (for testing purposes, specifically OD elements generation)
            Args:
                file (str): file name
                date (str): date for testing
            Returns:
                lists: pos, vel, time
        """</span>
        times,data,timestamps=self.formatTestInputInfo(file)           
        line = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(timestamps)):
            <span class="hljs-keyword">if</span> date <span class="hljs-keyword">in</span> timestamps[i]: 
                line = i
                <span class="hljs-keyword">break</span>
                
        time,info=times[line],data[line]
        pos,vel=info[<span class="hljs-number">0</span>],info[<span class="hljs-number">1</span>]
        <span class="hljs-keyword">return</span> pos, vel, time
                               
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSunPos</span>(<span class="hljs-params">self, date:str, file:str</span>)-&gt;list:</span>
        <span class="hljs-string">""" Gets the vector from the Earth to the Sun given the date
            Args:
                date (str): the date to use
                file (str): file name
            Returns:
                list: sun vector R
        """</span>
        info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        
        timestamps=info[:,<span class="hljs-number">1</span>]
        flag=<span class="hljs-literal">False</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(timestamps)):
            <span class="hljs-keyword">if</span> date <span class="hljs-keyword">in</span> timestamps[i]: 
                line = i
                flag=<span class="hljs-literal">True</span>
                <span class="hljs-keyword">break</span>
        
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> flag: <span class="hljs-keyword">return</span> np.array([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]) <span class="hljs-comment"># not found</span>
        
        stuff=info[line,:]
        x,y,z=float(stuff[<span class="hljs-number">2</span>]),float(stuff[<span class="hljs-number">3</span>]),float(stuff[<span class="hljs-number">4</span>])
        <span class="hljs-keyword">return</span> np.array([x,y,z])
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAllSunPos</span>(<span class="hljs-params">self, file:str</span>)-&gt;list:</span>
        <span class="hljs-string">""" Gets all sun positions and returns as a list
            Args:
                file (str): file name
            Returns:
                list: list of lists [time, date, sunPos (np.array)]
        """</span>
        info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        results=[]
        
        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> info[<span class="hljs-number">1</span>:]:
            time,date=float(line[<span class="hljs-number">0</span>]),line[<span class="hljs-number">1</span>].strip()
            R=np.array([float(line[<span class="hljs-number">2</span>]),float(line[<span class="hljs-number">3</span>]),float(line[<span class="hljs-number">4</span>])])
            results.append([time,date,R])
  
        <span class="hljs-keyword">return</span> results

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportEphemeris</span>(<span class="hljs-params">self, fileName:str, results:list</span>):</span>
        <span class="hljs-string">""" Exports ephemeris to a file
            Args:
                fileName (str): file name for exported ephemeris
                results (list): all results
            Returns:
                None
        """</span>
        <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
            file.write((<span class="hljs-string">"Date\tTime\tRA\tDec\n"</span>).expandtabs(<span class="hljs-number">40</span>))
            <span class="hljs-keyword">for</span> date, time, ra, dec <span class="hljs-keyword">in</span> results:
                file.write((date+<span class="hljs-string">"\t"</span>+time+<span class="hljs-string">"\t"</span>+ra+<span class="hljs-string">"\t"</span>+dec+<span class="hljs-string">"\n"</span>).expandtabs(<span class="hljs-number">40</span>))
                
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportMonteCarlo</span>(<span class="hljs-params">self, fileName:str, vals:list, results</span>):</span>
        <span class="hljs-string">""" Exports Monte Carlo to a file
            Args:
                fileName (str): file name for exported ephemeris
                vals (list): all vals [num,a,e,i,o,w,T]
                results (list): real values to compare vals [a,e,i,o,w,t]
            Returns:
                None
        """</span>
        labels=[<span class="hljs-string">"a"</span>,<span class="hljs-string">"e"</span>,<span class="hljs-string">"i"</span>,<span class="hljs-string">"o"</span>,<span class="hljs-string">"w"</span>,<span class="hljs-string">"T"</span>]
        <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(vals)):
                file.write(<span class="hljs-string">"----"</span>+str(vals[j][<span class="hljs-number">0</span>])+<span class="hljs-string">"----\n"</span>)
                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">6</span>):
                    file.write(labels[i]+<span class="hljs-string">": "</span>+str(vals[j][i+<span class="hljs-number">1</span>])+<span class="hljs-string">" \t error: "</span> + str(error(results[i],vals[j][i+<span class="hljs-number">1</span>])) + <span class="hljs-string">"\n"</span>)

    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printResults</span>(<span class="hljs-params">self, fileName:str, pos:list, vel:list, rho:list, a:float, e:float, i:float, o:float, T:float, w:float, date:str, M:float</span>):</span>
        <span class="hljs-string">""" Gets the vector from the Earth to the Sun given the date
            Args:
                fileName (str): exported file name
                pos (list): position from sun
                vel (list): the velocity of the asteroid
                rho (list): the position from Earth
                a (float): semi major axis
                e (float): eccentricity
                i (float): inclination
                o (float): longitude of ascending node (Degrees)
                T (float): time of perihelion passage
                w (float): argument of perihelion (Degrees)
                date (str): date for calculated mean anomaly
                M (float): mean anomaly
            Returns:
                None
        """</span>
        <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
            file.write(<span class="hljs-string">"1999 GJ2 Orbit Determination"</span>)
            file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
            file.write(<span class="hljs-string">"Position From Sun (r, AU):\n\t"</span> + str(pos))
            file.write(<span class="hljs-string">"\nVelocity (AU/day):\n\t"</span>+str(vel))
            file.write(<span class="hljs-string">"\nPosition From Earth (rho, AU):\n\t"</span>+str(rho))
            file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
            file.write(<span class="hljs-string">"Orbital Elements:"</span>)
            file.write(<span class="hljs-string">"\n\tSemi-Major Axis (AU): "</span> + str(a))
            file.write(<span class="hljs-string">"\n\tEccentricity: "</span> + str(e))
            file.write(<span class="hljs-string">"\n\tInclination (deg): "</span> + str(i))
            file.write(<span class="hljs-string">"\n\tLongitude of Ascending Node (deg): "</span> + str(o))
            file.write(<span class="hljs-string">"\n\tTime of Perihelion Passage (Julian days): "</span> + str(T))
            file.write(<span class="hljs-string">"\n\tArgument of Perihelion (deg): "</span> + str(w))
            file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
            file.write(<span class="hljs-string">"Mean Anomaly (deg) for "</span>+date+<span class="hljs-string">":"</span>)
            file.write(<span class="hljs-string">"\n\t"</span>+str(M))
            
        

    
<span class="hljs-comment"># Final OD Class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OD</span>:</span>
    <span class="hljs-string">'''Class that performs all orbital determination calculations'''</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, inputFile:str</span>):</span>
        <span class="hljs-string">""" Initializes OD class
            Args:
                inputFile (str): input file name
            Returns:
                None
        """</span>
        <span class="hljs-comment"># constants</span>
        self.k = <span class="hljs-number">0.0172020989484</span> <span class="hljs-comment">#Gaussian gravitational constant  </span>
        self.cAU = <span class="hljs-number">173.144643267</span> <span class="hljs-comment">#speed of light in au/(mean solar)day  </span>
        self.mu = <span class="hljs-number">1</span>
        self.eps = np.radians(<span class="hljs-number">23.4374</span>) <span class="hljs-comment">#Earth's obliquity</span>
        self.toGaussian=<span class="hljs-number">365.2568983</span>
        self.mu = <span class="hljs-number">1</span>
        
        self.data=Data() <span class="hljs-comment"># Data object</span>
        self.inputFile=inputFile
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genElements</span>(<span class="hljs-params">self, pos:list, vel:list, time:float, update:bool=True</span>):</span>
        <span class="hljs-string">""" Calculates and returns the orbital elements given position, velocity, time
            Args:
                pos (list): the position vector
                vel (list): the velocity vector
                time (float): the time in Julian days
                update (bool): if True keeps the newly calculated orbital elements
            Returns:
                floats: the orbital elements; a,e,i,o,v,w,T,M
        """</span>
        <span class="hljs-keyword">if</span> update:
            self.pos,self.vel,self.time=pos,vel,time
            self.od=ODElements(self.pos,self.vel,self.time)
            self.a,self.e,self.i,self.o,self.v,self.w,self.T,self.M = self.od.getElements()
            <span class="hljs-keyword">return</span> self.getElements()
        <span class="hljs-keyword">else</span>:
            od=ODElements(pos,vel,time)
            <span class="hljs-keyword">return</span> od.getElements()
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getElements</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">""" Returns the orbital elements (already calculated)
            Args:
                rad (bool): True if return in radians
            Returns:
                floats: a,e,i,o,v,w,T,M
        """</span>
        <span class="hljs-keyword">return</span> self.a, self.e, self.i, self.o, self.v, self.w, self.T, self.M
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">SEL</span>(<span class="hljs-params">self, taus:list, sunR2:list, rhohat2:list, coefD:list</span>):</span>
        <span class="hljs-string">""" Scalar Equation of Lagrange to calculate the roots (r) and rhos corresponding to each r
            Args:
                taus (list): a list of floats of taus [T1,T3,T]
                sunR2 (list): a list representing the sun vector R2
                rhohat2 (list): a list representing the rhohat2 vector
                coefD (list): a list of D coefficients [D0,D21,D22,D23]
            Returns:
                lists: roots (r's), rhos
        """</span>
        T1,T3,T=taus[<span class="hljs-number">0</span>],taus[<span class="hljs-number">1</span>],taus[<span class="hljs-number">2</span>]
        D0,D21,D22,D23=coefD[<span class="hljs-number">0</span>],coefD[<span class="hljs-number">1</span>],coefD[<span class="hljs-number">2</span>],coefD[<span class="hljs-number">3</span>]
        A1=T3/T
        B1=A1/<span class="hljs-number">6</span>*(T**<span class="hljs-number">2</span>-T3**<span class="hljs-number">2</span>)
        A3=-T1/T
        B3=A3/<span class="hljs-number">6</span>*(T**<span class="hljs-number">2</span>-T1**<span class="hljs-number">2</span>)
        A=(A1*D21-D22+A3*D23)/(-D0)
        B=(B1*D21+B3*D23)/(-D0)
        
        E=<span class="hljs-number">-2</span>*(dot(rhohat2, sunR2))
        F=dot(sunR2,sunR2)
        
        a=-(A**<span class="hljs-number">2</span>+A*E+F)
        b=-self.mu*(<span class="hljs-number">2</span>*A*B+B*E)
        c=-self.mu**<span class="hljs-number">2</span>*B**<span class="hljs-number">2</span>
        
        coef=[c,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,b,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]
        res=poly.polyroots(coef)

        temproots=[]
        <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> res: 
            <span class="hljs-keyword">if</span> np.isreal(val) <span class="hljs-keyword">and</span> np.real(val)&gt;<span class="hljs-number">0</span>: temproots.append(np.real(val))

        temprhos=[A+B/temproots[i]**<span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(temproots))]
        
        <span class="hljs-comment"># ignore pairs where rho magnitude is negative</span>
        roots=[]
        rhos=[]
        <span class="hljs-comment">#print(temproots, temprhos)</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(temproots)):
            <span class="hljs-keyword">if</span> temprhos[i]&gt;<span class="hljs-number">0.0</span>:
                roots.append(temproots[i])
                rhos.append(temprhos[i])
                
        
        
        <span class="hljs-keyword">return</span> roots,rhos
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ephemeris</span>(<span class="hljs-params">self, time:float, date:str, file:str=<span class="hljs-string">""</span>, sunPos:list=np.array(<span class="hljs-params">[]</span>)</span>):</span>
        <span class="hljs-string">""" Calculates RA and Dec given time and date, using previously calculated orbital elements
            Args:
                time (float): time to determine ephemeris for in Julian Days
                date (str): date for which to determine ephemeris
                file (str): file name for sun positions; optional
            Returns:
                floats: ra, dec
        """</span>
        n=self.k*math.sqrt(self.mu/(self.a**<span class="hljs-number">3</span>))
        M=n*(time-self.T)
        E=newton(<span class="hljs-keyword">lambda</span> E:M - E + self.e*np.sin(E), <span class="hljs-keyword">lambda</span> E: <span class="hljs-number">-1</span>+self.e*np.cos(E), M, <span class="hljs-number">1e-17</span>)
        
        pos=np.array([self.a*math.cos(E)-self.a*self.e, self.a*math.sqrt(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)*math.sin(E), <span class="hljs-number">0</span>])
        
        <span class="hljs-comment"># the four rotations</span>
        pos=rotZX(pos,np.deg2rad(self.w),np.deg2rad(self.i))
        pos=rotZX(pos,np.deg2rad(self.o),self.eps)
        
        <span class="hljs-keyword">if</span> file==<span class="hljs-string">""</span>: <span class="hljs-comment"># no file given, use sunPos</span>
            R=sunPos
        <span class="hljs-keyword">else</span>: R=self.data.getSunPos(date, file)
        <span class="hljs-keyword">if</span> np.array_equal(R, np.array([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>])): <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"Sun Position Not Found in SunPos.txt"</span>)
        rho=pos+R
        rhohat=rho/getMag(rho)
        
        dec=math.asin(rhohat[<span class="hljs-number">2</span>])
        cra=rhohat[<span class="hljs-number">0</span>]/math.cos(dec)
        sra=rhohat[<span class="hljs-number">1</span>]/math.cos(dec)

        ra=getAngle(sra,cra)
        
        dec=np.rad2deg(dec)
        ra=np.rad2deg(ra)
        
        dec=DECdecimalToDMS(dec)
        ra=RAdecimalToHMS(ra)
        
        <span class="hljs-keyword">return</span> ra,dec
        
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fg</span>(<span class="hljs-params">self, tau:float, r2mag:float, r2dot:list, order:int, r2:list=[]</span>):</span>
        <span class="hljs-string">""" Gets the f and g values given one time
            Args:
                tau (float): the time in Julian Days
                r2mag (float): the magnitude of r2
                r2dot (list): the velocity vector 2
                order (int): order of f and g taylor series approximations
                r2 (list): optional parameter, the position vector 2
            Returns:
                floats: f, g
        """</span>
        <span class="hljs-keyword">if</span> len(r2)==<span class="hljs-number">0</span>: u=self.mu/r2mag**<span class="hljs-number">3</span>
        <span class="hljs-keyword">else</span>: u=self.mu/getMag(r2)**<span class="hljs-number">3</span>
        
        f=<span class="hljs-number">1</span><span class="hljs-number">-1</span>/<span class="hljs-number">2</span>*u*tau**<span class="hljs-number">2</span>
        g=tau
        
        <span class="hljs-keyword">if</span> order&gt;=<span class="hljs-number">3</span>:
            z=dot(r2,r2dot)/(dot(r2,r2))
            q=dot(r2dot,r2dot)/(dot(r2,r2))-u
            f+=<span class="hljs-number">1</span>/<span class="hljs-number">2</span>*u*z*tau**<span class="hljs-number">3</span>
            g+=<span class="hljs-number">-1</span>/<span class="hljs-number">6</span>*u*tau**<span class="hljs-number">3</span>
        
        <span class="hljs-keyword">if</span> order&gt;=<span class="hljs-number">4</span>:
            f+=<span class="hljs-number">1</span>/<span class="hljs-number">24</span>*(<span class="hljs-number">3</span>*u*q<span class="hljs-number">-15</span>*u*z**<span class="hljs-number">2</span>+u**<span class="hljs-number">2</span>)*tau**<span class="hljs-number">4</span>
            g+=<span class="hljs-number">1</span>/<span class="hljs-number">4</span>*u*z*tau**<span class="hljs-number">4</span>
        
        <span class="hljs-keyword">return</span> f, g
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getFGVals</span>(<span class="hljs-params">self, tau1:float, tau3:float, r2mag:float, r2dot:list, order1:int, order2:int, r2:list=[]</span>):</span>
        <span class="hljs-string">""" Gets all f and g values
            Args:
                tau1 (float): the time in Julian Days for observation 1 from obs 2(T1-T2)
                tau3 (float): the time in Julian days for observation 3 from obs 2(T3-T2)
                r2mag (float): the magnitude of r2
                r2dot (list): the velocity vector 2
                order1 (int): Order of Taylor Series expansion for f and g values for observation 1
                order2 (int): Order of Taylor Series expansion for f and g values for observation 3
                r2 (list): optional parameter, the position vector 2
            Returns:
                lists: [f1,f3], [g1,g3]
        """</span>
        f1,g1=self.fg(tau1,r2mag,r2dot,order1,r2)
        f3,g3=self.fg(tau3,r2mag,r2dot,order2,r2)
        <span class="hljs-keyword">return</span> [f1,f3], [g1,g3]
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDCoef</span>(<span class="hljs-params">self, ra:list, dec:list, R1:list, R2:list, R3:list</span>):</span>
        <span class="hljs-string">""" Gets the D coefficients given the ra and dec for three observations (in radians)
            Args:
                ra (list): the right ascensions for three observations (radians)
                dec (list): the declinations for three observations (radians)
                R1 (list): the sun vector for observation 1
                R2 (list): the sun vector for observation 2
                R3 (list): the sun vector for observation 3
            Returns:
                list: [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], [rhohat1, rhohat2, rhohat3]
        """</span>
        ra1,ra2,ra3=ra[<span class="hljs-number">0</span>],ra[<span class="hljs-number">1</span>],ra[<span class="hljs-number">2</span>]
        dec1,dec2,dec3=dec[<span class="hljs-number">0</span>],dec[<span class="hljs-number">1</span>],dec[<span class="hljs-number">2</span>]
        
        rhohat1=np.array([np.cos(ra1)*np.cos(dec1), np.sin(ra1)*np.cos(dec1), np.sin(dec1)])
        rhohat2=np.array([np.cos(ra2)*np.cos(dec2), np.sin(ra2)*np.cos(dec2), np.sin(dec2)])
        rhohat3=np.array([np.cos(ra3)*np.cos(dec3), np.sin(ra3)*np.cos(dec3), np.sin(dec3)])
        
        D0=dot(rhohat1, cross(rhohat2,rhohat3))
        D11=dot(cross(R1, rhohat2),rhohat3)
        D12=dot(cross(R2, rhohat2),rhohat3)
        D13=dot(cross(R3, rhohat2),rhohat3)
        
        D21=dot(cross(rhohat1,R1), rhohat3)
        D22=dot(cross(rhohat1,R2), rhohat3)
        D23=dot(cross(rhohat1,R3), rhohat3)
        
        D31=dot(rhohat1, cross(rhohat2,R1))
        D32=dot(rhohat1, cross(rhohat2,R2))
        D33=dot(rhohat1, cross(rhohat2,R3))
     
        <span class="hljs-keyword">return</span> [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], np.array([rhohat1, rhohat2, rhohat3])
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGenData</span>(<span class="hljs-params">self,loaded:bool,selTime:list=[],selDate:list=[],ra:list=[],dec:list=[]</span>):</span>
        <span class="hljs-string">""" Generates the data for Method of Gauss calculations
            Args:
                loaded (bool): True if data is already loaded
                selTime (list): list of chosen times (in Julian days) for observations 1,2,3
                selDate (list): list of chosen datesfor observations 1,2,3
                ra (list): list of right ascensions
                dec (list): list of declinations
            Returns:
                lists: ra, dec, R1, R2, R3, taus, ts (original times in Julian days)
        """</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> loaded:
            self.data.getInput(self.inputFile) <span class="hljs-comment"># formats and generates info</span>
            <span class="hljs-comment"># generate data</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(selTime==[]): <span class="hljs-comment"># using Julian day times</span>
                <span class="hljs-keyword">if</span> ra==[] <span class="hljs-keyword">and</span> dec==[]:
                    ra,dec=[],[]
                    <span class="hljs-keyword">for</span> time <span class="hljs-keyword">in</span> selTime:
                        r,d=self.data.getRADECInput(time=time)
                        ra.append(np.deg2rad(r))
                        dec.append(np.deg2rad(d))
                R1=self.data.getSunInput(time=selTime[<span class="hljs-number">0</span>])
                R2=self.data.getSunInput(time=selTime[<span class="hljs-number">1</span>])
                R3=self.data.getSunInput(time=selTime[<span class="hljs-number">2</span>])
                <span class="hljs-comment"># calculate the taus</span>
                t1,t2,t3=selTime[<span class="hljs-number">0</span>],selTime[<span class="hljs-number">1</span>],selTime[<span class="hljs-number">2</span>]
                ts=[t1,t2,t3]
                T1=t1-t2
                T3=t3-t2
                T=t3-t1
                taus = [T1,T3,T] <span class="hljs-comment"># in Gaussian days</span>

            <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(selDate==[]):
                <span class="hljs-keyword">if</span> ra==[] <span class="hljs-keyword">and</span> dec==[]:
                    ra,dec=[],[]
                    <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> selDate:
                        r,d=self.data.getRADECInput(date=date)
                        ra.append(np.deg2rad(r))
                        dec.append(np.deg2rad(d))
                R1=self.data.getSunInput(date=selDate[<span class="hljs-number">0</span>])
                R2=self.data.getSunInput(date=selDate[<span class="hljs-number">1</span>])
                R3=self.data.getSunInput(date=selDate[<span class="hljs-number">2</span>])
                <span class="hljs-comment"># calculate the taus given the dates</span>
                t1,t2,t3=self.data.getJDTime(selDate[<span class="hljs-number">0</span>]),self.data.getJDTime(selDate[<span class="hljs-number">1</span>]),self.data.getJDTime(selDate[<span class="hljs-number">2</span>])
                ts=[t1,t2,t3]
                T1=t1-t2
                T3=t3-t2
                T=t3-t1
                taus = [T1*self.k,T3*self.k,T*self.k]

            <span class="hljs-keyword">else</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No data given"</span>)
            self.loadedValues=[ra,dec,np.array(R1),np.array(R2),np.array(R3),taus,np.array(ts)]
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(ra==[] <span class="hljs-keyword">and</span> dec==[]):
                self.loadedValues[<span class="hljs-number">0</span>] = ra
                self.loadedValues[<span class="hljs-number">1</span>] = dec
        <span class="hljs-keyword">return</span> self.loadedValues
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGCalcRhos</span>(<span class="hljs-params">self, rhohats:list, coefD:list, fvals:list, gvals:list</span>):</span>
        <span class="hljs-string">""" Generates the rhos (and their magnitudes) for Method of Gauss calculations
            Args:
                rhohats (list): the direction vectors for rhos
                coefD (list): the D coefficients
                fvals (list): the f values
                gvals (list): the g values
            Returns:
                lists: rhos, rhomags
        """</span>
        f1,f3=fvals
        g1,g3=gvals
        D0,D11,D12,D13,D21,D22,D23,D31,D32,D33=coefD
        C1=g3/(f1*g3-g1*f3)
        C2=<span class="hljs-number">-1</span>
        C3=-g1/(f1*g3-g1*f3)
        rho1=(C1*D11+C2*D12+C3*D13)/(C1*D0)
        rho2=(C1*D21+C2*D22+C3*D23)/(C2*D0)
        rho3=(C1*D31+C2*D32+C3*D33)/(C3*D0)
        rhomags=np.array([rho1,rho2,rho3])
        rhos=np.array([rhohats[<span class="hljs-number">0</span>]*rho1, rhohats[<span class="hljs-number">1</span>]*rho2, rhohats[<span class="hljs-number">2</span>]*rho3])
        <span class="hljs-keyword">return</span> rhos, rhomags
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGCalcPos</span>(<span class="hljs-params">self, rhos:list, Rs:list</span>)-&gt;list:</span>    
        <span class="hljs-string">""" Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations
            Args:
                rhos (list): the position from Earth vectors
                Rs (list): the position from Sun vectors
            Returns:
                lists: rs
        """</span>
        <span class="hljs-keyword">return</span> rhos-Rs
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGetErr</span>(<span class="hljs-params">self, prev:list, cur:list, tolerance:float</span>)-&gt;bool:</span>
        <span class="hljs-string">""" Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations
            Args:
                prev (list): previous r vector
                cur (list): the newly calculated r vector
                tolerance (float): the tolerance
            Returns:
                bool: True if error is good, False if no within tolerance
        """</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(prev)):
            <span class="hljs-keyword">if</span> abs(prev[i]-cur[i])&gt;tolerance: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGetAdjustedTaus</span>(<span class="hljs-params">self, origt:list, rhomags:float</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns adjusted taus for Method of Gauss calculations
            Args:
                origt (list): original observation times in Julian days
                rhomags (list): the magnitude of the rho vectors
            Returns:
                list: the adjusted taus
        """</span>
        ts=np.copy(origt)-rhomags/self.cAU
        t1,t2,t3=ts
        <span class="hljs-keyword">return</span> [(t1-t2)*self.k,(t3-t2)*self.k,(t3-t1)*self.k]
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoG</span>(<span class="hljs-params">self,selTime:list=[],selDate:list=[],override:bool=True,ra:list=[],dec:list=[],loaded:bool=False</span>):</span>
        <span class="hljs-string">""" Performs Method of Gauss calculations to determine orbital elements
            Args:
                selTime (list): list of chosen times (in Julian days) for observations 1,2,3
                selDate (list): list of chosen datesfor observations 1,2,3
                override (bool): boolean, True if override info
                ra (list): optional list of right ascensions
                dec (list): optional list of declinations
                loaded (bool): optional, True if all data is already loaded (speeds up run time)
            Returns:
                None
        """</span>
        <span class="hljs-comment"># generate data</span>
        ra,dec,R1,R2,R3,taus,ts=self.MoGGenData(<span class="hljs-literal">False</span>,selTime,selDate,ra,dec)
        
        <span class="hljs-comment"># calculate the initial estimate for r2 DONE</span>
        coefD,rhohats=self.getDCoef(ra, dec, R1, R2, R3)

        SELcoefD=[coefD[<span class="hljs-number">0</span>],coefD[<span class="hljs-number">4</span>],coefD[<span class="hljs-number">5</span>],coefD[<span class="hljs-number">6</span>]] <span class="hljs-comment"># [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33] -&gt; [D0,D21,D22,D23]</span>
        r2MagGuesses,rhoMagGuesses=self.SEL(taus, R2, rhohats[<span class="hljs-number">1</span>], SELcoefD)
        
        results=[]
        
        <span class="hljs-comment"># calculate the f and g values to second order</span>
        <span class="hljs-keyword">for</span> r2mag <span class="hljs-keyword">in</span> r2MagGuesses:
            <span class="hljs-comment"># initial guesses</span>
            fvals,gvals=self.getFGVals(taus[<span class="hljs-number">0</span>], taus[<span class="hljs-number">1</span>], r2mag, [], <span class="hljs-number">2</span>, <span class="hljs-number">2</span>) <span class="hljs-comment"># using r2mag</span>
            rhos,rhomags=self.MoGCalcRhos(rhohats, coefD, fvals, gvals)
            rs=self.MoGCalcPos(rhos, np.array([R1,R2,R3]))
   
            <span class="hljs-comment"># calculate the central velocity vector</span>
            f1,f3=fvals
            g1,g3=gvals
            r2dot = (-f3/(-f3*g1+g3*f1))*rs[<span class="hljs-number">0</span>] + (f1/(f1*g3-f3*g1))*rs[<span class="hljs-number">2</span>]
            counter=<span class="hljs-number">0</span>
            timedOut=<span class="hljs-literal">True</span>
            timeout=time.time() + <span class="hljs-number">60</span>*<span class="hljs-number">3</span> <span class="hljs-comment"># timeout after 3 minutes</span>
            
            <span class="hljs-keyword">while</span> counter&lt;<span class="hljs-number">5000</span> <span class="hljs-keyword">and</span> time.time()&lt;timeout: <span class="hljs-comment"># timeout</span>
                prev=rs[<span class="hljs-number">1</span>]
                
                <span class="hljs-comment"># time adjustment</span>
                newtaus=self.MoGGetAdjustedTaus(ts, rhomags)
                
                fvals,gvals=self.getFGVals(newtaus[<span class="hljs-number">0</span>], newtaus[<span class="hljs-number">1</span>], r2mag, r2dot, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, rs[<span class="hljs-number">1</span>]) <span class="hljs-comment"># using r2mag</span>
                rhos,rhomags=self.MoGCalcRhos(rhohats, coefD, fvals, gvals)
                rs=self.MoGCalcPos(rhos, np.array([R1,R2,R3]))
                
                f1,f3=fvals
                g1,g3=gvals
                r2dot = (-f3/(-f3*g1+g3*f1))*rs[<span class="hljs-number">0</span>] + (f1/(f1*g3-f3*g1))*rs[<span class="hljs-number">2</span>]
                
                counter+=<span class="hljs-number">1</span>
                
                <span class="hljs-keyword">if</span> (self.MoGGetErr(prev, rs[<span class="hljs-number">1</span>], <span class="hljs-number">1e-23</span>)): 
                    timedOut=<span class="hljs-literal">False</span>
                    <span class="hljs-keyword">break</span>
            
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> timedOut:
                <span class="hljs-comment"># rotate around x axis to get to ecliptic</span>
                r2=rotX(np.array(rs[<span class="hljs-number">1</span>]),-self.eps)
                r2dot=rotX(r2dot,-self.eps)
                rho2=rotX(rhos[<span class="hljs-number">1</span>],-self.eps)
                results.append([r2, r2dot, rho2]) <span class="hljs-comment"># position and velocity</span>
        
        resIndex=<span class="hljs-number">0</span>
        <span class="hljs-keyword">if</span> len(results)&gt;<span class="hljs-number">1</span>: <span class="hljs-comment"># get user input to choose which result to use </span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(results)):
                print(<span class="hljs-string">"Result"</span>,str(i)+<span class="hljs-string">":"</span>)
                print(<span class="hljs-string">"\tPos from Sun:"</span>,r2,<span class="hljs-string">"\n\tVel:"</span>,r2dot,<span class="hljs-string">"\n\tPos from Earth:"</span>,rho2,<span class="hljs-string">"\n"</span>)

            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                <span class="hljs-keyword">try</span>: 
                    resIndex=int(input(<span class="hljs-string">"Choose which result to use (int): "</span>))
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(<span class="hljs-number">0</span>&lt;=resIndex&lt;len(results)): resIndex/=<span class="hljs-number">0</span> <span class="hljs-comment"># throw an error</span>
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">except</span>:
                    print(<span class="hljs-string">"Enter a valid integer"</span>)
        
        <span class="hljs-keyword">if</span> len(results)==<span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
            
        <span class="hljs-comment"># get final answers</span>
        pos,vel,rho=results[resIndex]
        
        <span class="hljs-keyword">if</span> override:
            self.genElements(pos,np.array(vel)*(<span class="hljs-number">2</span>*math.pi)/<span class="hljs-number">365.2568983</span>,ts[<span class="hljs-number">1</span>])
            self.vel = vel
            self.pos = pos
            self.rho = rho
        <span class="hljs-keyword">else</span>:
            a,e,i,o,v,w,T,M=self.genElements(pos,np.array(vel)*(<span class="hljs-number">2</span>*math.pi)/<span class="hljs-number">365.2568983</span>,ts[<span class="hljs-number">1</span>], update=<span class="hljs-literal">False</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>, a,e,i,o,w,T
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getError</span>(<span class="hljs-params">self, results:list</span>):</span>
        <span class="hljs-string">""" Prints error and results from orbital elements determination after Method of Gauss calculations
            Args:
                results (list): [e,0,i,o,w,T,0,0,0,a]
            Returns:
                None
        """</span>
        <span class="hljs-comment"># adjust time of perihelion from results to match period of calculated time of perihelion</span>
        period=results[<span class="hljs-number">9</span>]**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>)*self.toGaussian
        results[<span class="hljs-number">5</span>]=self.time-((self.time-results[<span class="hljs-number">5</span>])%period) <span class="hljs-comment"># subtract the change in time since the last perihelion from the obs 2 time </span>
        self.od.printError(results)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportResults</span>(<span class="hljs-params">self, time:float, date:str, fileName:str</span>):</span>
        <span class="hljs-string">""" Exports results to a file
            Args:
                time (float): time in Julian days for the Mean Anomaly
                date (str): date for Mean Anomaly
                fileName (str): the exported file name
            Returns:
                None
        """</span>
        M=self.od.getTimeMeanAnomaly(time, date)
        self.data.printResults(fileName, self.pos, self.vel/self.toGaussian*(<span class="hljs-number">2</span>*math.pi), self.rho, self.a, self.e, self.i, self.o, self.T, self.w, date, M)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genEphemeris</span>(<span class="hljs-params">self, inputFile:str, outputFile:str</span>):</span>
        <span class="hljs-string">""" Generates ephemeris for all times in a given sun position file. Exports to an output file
            Args:
                inputFile (str): input file name
                outputFile (str): output file name
            Returns:
                None
        """</span>
        results=[]
        <span class="hljs-keyword">for</span> time,date,R <span class="hljs-keyword">in</span> self.data.getAllSunPos(inputFile):
            ra,dec=self.ephemeris(time, date, sunPos=R)
            ra=str(ra[<span class="hljs-number">0</span>]) + <span class="hljs-string">" "</span> + str(ra[<span class="hljs-number">1</span>]) + <span class="hljs-string">" "</span> + str(ra[<span class="hljs-number">2</span>])
            <span class="hljs-keyword">if</span> dec[<span class="hljs-number">0</span>]&lt;<span class="hljs-number">0</span>: sign=<span class="hljs-string">"-"</span>
            <span class="hljs-keyword">else</span>: sign=<span class="hljs-string">"+"</span>
            dec=sign+str(dec[<span class="hljs-number">0</span>]) + <span class="hljs-string">" "</span> + str(dec[<span class="hljs-number">1</span>]) + <span class="hljs-string">" "</span> + str(dec[<span class="hljs-number">2</span>])
            results.append([date,str(time),ra,dec])
        
        self.data.exportEphemeris(outputFile, results)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">monteCarlo</span>(<span class="hljs-params">self, n:int, files:str, outputFile:str, results:list, selTime:list=[], selDate:list=[]</span>):</span>
        <span class="hljs-string">""" Using uncertainty, runs through Method of Gauss n-times to generate orbital elements. 
            Outputs to file.
            Args:
                n (int): number of times to run monteCarlo
                files (list): list of fits file names
                outputFile (str): the output file name
                results (list): the actual values for error analysis [a, e, i, o, w, T]
                selTime (list): optional; the selected times for which to run Method of Gauss
                selDate (list): optional; the selected dates for which to run Method of Gauss
            Returns:
                None
        """</span>
        rmsDec,rmsRA=[],[]
        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:
            data = fits.open(file)[<span class="hljs-number">1</span>].data
            
            fieldDec, indexDec = data.field_dec[:], data.index_dec[:]
            fieldRA, indexRA = data.field_ra[:], data.index_ra[:]
            
            dec = np.sqrt(<span class="hljs-number">1</span>/int(fieldDec.shape[<span class="hljs-number">0</span>]) * sum([(indexDec[i]-fieldDec[i])**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(fieldDec.shape[<span class="hljs-number">0</span>]))]))
            ra = np.sqrt(<span class="hljs-number">1</span>/int(fieldRA.shape[<span class="hljs-number">0</span>]) * sum([(indexRA[i]-fieldRA[i])**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(fieldDec.shape[<span class="hljs-number">0</span>]))]))
            
            rmsDec.append(dec)
            rmsRA.append(ra)
            
            
        ora, odec, R1, R2, R3, taus, ts = self.MoGGenData(<span class="hljs-literal">False</span>,selTime=selTime,selDate=selDate)
        
        vals=[]
        num=<span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> trial <span class="hljs-keyword">in</span> range(n):
            newdec = [np.deg2rad(np.random.normal()*rmsDec[i] + np.rad2deg(odec[i])) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]
            newra = [np.deg2rad(np.random.normal()*rmsRA[i] + np.rad2deg(ora[i])) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]
            works, a, e, i, o, w, T=self.MoG(selTime=selTime,selDate=selDate,override=<span class="hljs-literal">False</span>,ra=newra,dec=newdec,loaded=<span class="hljs-literal">True</span>)
            <span class="hljs-keyword">if</span> works:
                num+=<span class="hljs-number">1</span>
                calcVals=[num,a,e,i,o,w,T] <span class="hljs-comment"># sus</span>
                vals.append(calcVals)
                vals.append(calcVals)
                
        <span class="hljs-comment"># adjust time of perihelion for results</span>
        <span class="hljs-comment"># for time of perihelion, need to adjust to be close to the given observation time</span>
        <span class="hljs-comment"># because our calculated time of perihelion is closest to the given observation time</span>
        period=results[<span class="hljs-number">0</span>]**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>)*self.toGaussian
        results[<span class="hljs-number">5</span>]=ts[<span class="hljs-number">1</span>]-((ts[<span class="hljs-number">1</span>]-results[<span class="hljs-number">5</span>])%period) <span class="hljs-comment"># subtract the change in time since the last perihelion from the obs 2 time </span>
                
            
        <span class="hljs-comment"># write to output file</span>
        self.data.exportMonteCarlo(outputFile, vals.copy(), results)
        
        <span class="hljs-comment"># histograms</span>
        labels=[<span class="hljs-string">""</span>,<span class="hljs-string">"Semi-Major Axis"</span>,<span class="hljs-string">"Eccentricity"</span>, <span class="hljs-string">"Inclination"</span>, <span class="hljs-string">"Longitude of Ascending Node"</span>, <span class="hljs-string">"Argument of Perihelion"</span>, <span class="hljs-string">"Time of Perihelion Passage"</span>]
        xlabels=[<span class="hljs-string">"AU"</span>,<span class="hljs-string">"Value"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Julian Day Number"</span>]
        custom_lines = [Line2D([<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>], color=<span class="hljs-string">'black'</span>, linestyle=<span class="hljs-string">'dashed'</span>,lw=<span class="hljs-number">1</span>), Line2D([<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>], color=<span class="hljs-string">'blue'</span>, lw=<span class="hljs-number">1</span>)]
  
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">5</span>):
            mean=sum([vals[i][<span class="hljs-number">1</span>+j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals)
            sdom=np.sqrt(sum([(vals[i][j+<span class="hljs-number">1</span>]-mean)**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals))
            
            plt.hist([vals[i][<span class="hljs-number">1</span>+j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))],bins=<span class="hljs-number">20</span>)
            plt.axvline(results[j], color=<span class="hljs-string">'k'</span>, linestyle=<span class="hljs-string">'dashed'</span>, linewidth=<span class="hljs-number">1</span>)
            plt.axvline(mean, color=<span class="hljs-string">'b'</span>, linewidth=<span class="hljs-number">1</span>)
            plt.title(labels[<span class="hljs-number">1</span>+j])
            plt.legend(custom_lines, [<span class="hljs-string">'True Value'</span>, <span class="hljs-string">'Mean'</span>])
            plt.xlabel(xlabels[j])
            plt.ylabel(<span class="hljs-string">"Frequency"</span>)
            plt.show()

            print(labels[j+<span class="hljs-number">1</span>]+<span class="hljs-string">": \n\tmean: "</span>+str(mean)+<span class="hljs-string">"\n\terror: "</span> + str(error(results[j],mean)) + <span class="hljs-string">"\n\tstandard deviation of mean: "</span> + str(sdom) + <span class="hljs-string">"\n"</span>)

        <span class="hljs-comment"># special case for time of perihelion</span>
        mean=sum([vals[i][<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals)
        sdom=np.sqrt(sum([(vals[i][<span class="hljs-number">6</span>]-mean)**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals))
            
        plt.hist([vals[i][<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))],bins=<span class="hljs-number">20</span>)
        plt.axvline(results[<span class="hljs-number">5</span>], color=<span class="hljs-string">'k'</span>, linestyle=<span class="hljs-string">'dashed'</span>, linewidth=<span class="hljs-number">1</span>)
        plt.axvline(mean, color=<span class="hljs-string">'b'</span>, linewidth=<span class="hljs-number">1</span>)
        plt.title(labels[<span class="hljs-number">6</span>])
        plt.legend(custom_lines, [<span class="hljs-string">'True Value'</span>, <span class="hljs-string">'Mean'</span>])
        plt.xlabel(xlabels[<span class="hljs-number">5</span>])
        plt.ylabel(<span class="hljs-string">"Frequency"</span>)
        plt.show()

        print(labels[<span class="hljs-number">6</span>]+<span class="hljs-string">": \n\tmean: "</span>+str(mean)+ <span class="hljs-string">"\n\terror: "</span> + str(error(results[<span class="hljs-number">5</span>],mean)) + <span class="hljs-string">"\n\tstandard deviation of mean: "</span> + str(sdom) + <span class="hljs-string">"\n"</span>)

 
<span class="hljs-comment"># final functions</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RunCompleteOD</span>(<span class="hljs-params">iterations:int, inputFile:str, fitsFiles:list, sunFile:str, dates:list, results:list</span>):</span>
    <span class="hljs-string">""" Runs complete orbit determination code. Generates three files:
            SoongODResults.txt (the results of orbital determination),
            SoongMonteCarloOutput.txt (the results from the Monte Carlo simulation),
            SoongGeneratedEphemeris.txt (the results from the ephemeris generation)
        Args:
            iterations (int): the number of iteration for which to run the Monte Carlo simulation
            inputFile (str): path for file containing observations to determine orbital elements
            fitsFiles (list): list of strings describing paths for the three fits files for Monte Carlo sim
            sunFile (str): path for file containing times and sun positions for ephemeris generation
            dates (list): list of dates for orbital elements determination
            results (list): the actual values for orbital elements in the format [a,e,i,o,w,m,T] 
        Returns:
            None
    """</span>
 
    <span class="hljs-comment"># generate orbital elements</span>
    data=Data()
    od=OD(inputFile)
    od.MoG(selDate=dates)
    
    <span class="hljs-comment"># determine error</span>
    a,e,i,o,w,m,T = results
    print(<span class="hljs-string">"--- Results from orbital elements determination ---"</span>)
    od.getError([e,<span class="hljs-number">0</span>,i,o,w,T,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a])
    od.exportResults(<span class="hljs-number">2459784.7916667</span>, <span class="hljs-string">"July 24, 2022 7:00 UT"</span>, <span class="hljs-string">"SoongODResults.txt"</span>) 
    
    <span class="hljs-comment"># Monte Carlo</span>
    results = [a,e,i,o,w,T] 
    print(<span class="hljs-string">"\n--- Monte Carlo Simulation ---"</span>)
    od.monteCarlo(iterations, fitsFiles, <span class="hljs-string">"SoongMonteCarloOutput.txt"</span>, results, selDate=dates)
    
    <span class="hljs-comment"># generate the ephemeris</span>
    od.genEphemeris(sunFile, <span class="hljs-string">"SoongGeneratedEphemeris.txt"</span>)
    print(<span class="hljs-string">"--- Ephemeris generation completed ---"</span>)

    
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">GenerateEphemeris</span>(<span class="hljs-params">inputFile:str, ODdates:list, sunFile:str</span>):</span>
    <span class="hljs-string">""" Outputs ephemeris to file. Generates one file:
            GeneratedEphemeris.txt (the results of ephemeris generation)
        Args:
            inputFile (str): path for file containing observations to determine orbital elements
            ODdates (list): list of dates for orbital elements determination
            sunFile (str): path for file containing times and sun positions for ephemeris generation
        Returns:
            None
    """</span>
 
    <span class="hljs-comment"># calculating orbital elements</span>
    data=Data()
    od=OD(inputFile)
    od.MoG(selDate=ODdates)
    
    <span class="hljs-comment"># generate ephemeris</span>
    od.genEphemeris(sunFile, <span class="hljs-string">"GeneratedEphemeris.txt"</span>)
    
    print(<span class="hljs-string">"Finished generating ephemeris"</span>)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="odlib.DECdecimalToDMS"><code class="name flex">
<span>def <span class="ident">DECdecimalToDMS</span></span>(<span>dec:&nbsp;float) ‑&gt;&nbsp;tuple</span>
</code></dt>
<dd>
<div class="desc"><p>Converts from decimal to DMS (declination)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dec</code></strong> : <code>float</code></dt>
<dd>decimal value</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>(degrees, minutes, seconds)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">DECdecimalToDMS</span>(<span class="hljs-params">dec:float</span>)-&gt;tuple:</span>
    <span class="hljs-string">""" Converts from decimal to DMS (declination)
        Args:
            dec (float): decimal value
        Returns:
            tuple: (degrees, minutes, seconds)
    """</span>
    d=math.trunc(dec)
    dec=abs(dec)-abs(d)
    m=math.trunc(dec*<span class="hljs-number">60</span>)
    dec-=m/<span class="hljs-number">60</span>
    s=dec*<span class="hljs-number">3600</span>
    <span class="hljs-keyword">return</span> (d,m,s)</code></pre>
</details>
</dd>
<dt id="odlib.DMStoDeg"><code class="name flex">
<span>def <span class="ident">DMStoDeg</span></span>(<span>d:&nbsp;float, arcm:&nbsp;float, arcs:&nbsp;float, convert=False) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Given DMS, return in degrees or radians</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>d</code></strong> : <code>float</code></dt>
<dd>degrees</dd>
<dt><strong><code>m</code></strong> : <code>float</code></dt>
<dd>minutes</dd>
<dt><strong><code>s</code></strong> : <code>float</code></dt>
<dd>seconds</dd>
<dt><strong><code>convert</code></strong> : <code>bool</code></dt>
<dd>True to convert to radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>value in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">DMStoDeg</span>(<span class="hljs-params">d:float,arcm:float,arcs:float,convert=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Given DMS, return in degrees or radians
        Args:
            d (float): degrees
            m (float): minutes
            s (float): seconds
            convert (bool): True to convert to radians
        Returns:
            float: value in degrees or radians
    """</span>
    <span class="hljs-keyword">return</span> np.deg2rad(math.copysign(abs(d)+arcm/<span class="hljs-number">60</span>+arcs/<span class="hljs-number">3600</span>,d)) <span class="hljs-keyword">if</span> convert <span class="hljs-keyword">else</span> math.copysign(abs(d)+arcm/<span class="hljs-number">60</span>+arcs/<span class="hljs-number">3600</span>,d)</code></pre>
</details>
</dd>
<dt id="odlib.GenerateEphemeris"><code class="name flex">
<span>def <span class="ident">GenerateEphemeris</span></span>(<span>inputFile:&nbsp;str, ODdates:&nbsp;list, sunFile:&nbsp;str)</span>
</code></dt>
<dd>
<div class="desc"><p>Outputs ephemeris to file. Generates one file:
GeneratedEphemeris.txt (the results of ephemeris generation)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>inputFile</code></strong> : <code>str</code></dt>
<dd>path for file containing observations to determine orbital elements</dd>
<dt><strong><code>ODdates</code></strong> : <code>list</code></dt>
<dd>list of dates for orbital elements determination</dd>
<dt><strong><code>sunFile</code></strong> : <code>str</code></dt>
<dd>path for file containing times and sun positions for ephemeris generation</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">GenerateEphemeris</span>(<span class="hljs-params">inputFile:str, ODdates:list, sunFile:str</span>):</span>
    <span class="hljs-string">""" Outputs ephemeris to file. Generates one file:
            GeneratedEphemeris.txt (the results of ephemeris generation)
        Args:
            inputFile (str): path for file containing observations to determine orbital elements
            ODdates (list): list of dates for orbital elements determination
            sunFile (str): path for file containing times and sun positions for ephemeris generation
        Returns:
            None
    """</span>
 
    <span class="hljs-comment"># calculating orbital elements</span>
    data=Data()
    od=OD(inputFile)
    od.MoG(selDate=ODdates)
    
    <span class="hljs-comment"># generate ephemeris</span>
    od.genEphemeris(sunFile, <span class="hljs-string">"GeneratedEphemeris.txt"</span>)
    
    print(<span class="hljs-string">"Finished generating ephemeris"</span>)</code></pre>
</details>
</dd>
<dt id="odlib.HMStoDeg"><code class="name flex">
<span>def <span class="ident">HMStoDeg</span></span>(<span>h:&nbsp;float, m:&nbsp;float, s:&nbsp;float, convert=False) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Given HMS, return in degrees or radians</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>h</code></strong> : <code>float</code></dt>
<dd>hours</dd>
<dt><strong><code>m</code></strong> : <code>float</code></dt>
<dd>minutes</dd>
<dt><strong><code>s</code></strong> : <code>float</code></dt>
<dd>seconds</dd>
<dt><strong><code>convert</code></strong> : <code>bool</code></dt>
<dd>True to convert to radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>value in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">HMStoDeg</span>(<span class="hljs-params">h:float,m:float,s:float,convert=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Given HMS, return in degrees or radians
        Args:
            h (float): hours
            m (float): minutes
            s (float): seconds
            convert (bool): True to convert to radians
        Returns:
            float: value in degrees or radians
    """</span>
    <span class="hljs-keyword">try</span>: h,m,s=float(h),float(m),float(s)
    <span class="hljs-keyword">except</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"Values must be floats"</span>)
    res = h*<span class="hljs-number">15</span> + m/<span class="hljs-number">60</span>*<span class="hljs-number">15</span> + s/<span class="hljs-number">3600</span>*<span class="hljs-number">15</span>
    res%=<span class="hljs-number">360</span>
    <span class="hljs-keyword">return</span> np.deg2rad(res) <span class="hljs-keyword">if</span> convert <span class="hljs-keyword">else</span> res</code></pre>
</details>
</dd>
<dt id="odlib.RAdecimalToHMS"><code class="name flex">
<span>def <span class="ident">RAdecimalToHMS</span></span>(<span>dec:&nbsp;float) ‑&gt;&nbsp;tuple</span>
</code></dt>
<dd>
<div class="desc"><p>Converts from decimal to HMS (right ascension)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dec</code></strong> : <code>float</code></dt>
<dd>decimal value</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>(hours, minutes, seconds)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RAdecimalToHMS</span>(<span class="hljs-params">dec:float</span>)-&gt;tuple:</span>
    <span class="hljs-string">""" Converts from decimal to HMS (right ascension)
        Args:
            dec (float): decimal value
        Returns:
            tuple: (hours, minutes, seconds)
    """</span>
    dec%=<span class="hljs-number">360</span>
    h=dec/<span class="hljs-number">15</span>
    m=(dec%<span class="hljs-number">15</span>)/<span class="hljs-number">15</span>*<span class="hljs-number">60</span>
    s=m%<span class="hljs-number">1</span>*<span class="hljs-number">60</span>
    h//=<span class="hljs-number">1</span>
    m//=<span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> (h,m,s)</code></pre>
</details>
</dd>
<dt id="odlib.RunCompleteOD"><code class="name flex">
<span>def <span class="ident">RunCompleteOD</span></span>(<span>iterations:&nbsp;int, inputFile:&nbsp;str, fitsFiles:&nbsp;list, sunFile:&nbsp;str, dates:&nbsp;list, results:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Runs complete orbit determination code. Generates three files:
SoongODResults.txt (the results of orbital determination),
SoongMonteCarloOutput.txt (the results from the Monte Carlo simulation),
SoongGeneratedEphemeris.txt (the results from the ephemeris generation)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>iterations</code></strong> : <code>int</code></dt>
<dd>the number of iteration for which to run the Monte Carlo simulation</dd>
<dt><strong><code>inputFile</code></strong> : <code>str</code></dt>
<dd>path for file containing observations to determine orbital elements</dd>
<dt><strong><code>fitsFiles</code></strong> : <code>list</code></dt>
<dd>list of strings describing paths for the three fits files for Monte Carlo sim</dd>
<dt><strong><code>sunFile</code></strong> : <code>str</code></dt>
<dd>path for file containing times and sun positions for ephemeris generation</dd>
<dt><strong><code>dates</code></strong> : <code>list</code></dt>
<dd>list of dates for orbital elements determination</dd>
<dt><strong><code>results</code></strong> : <code>list</code></dt>
<dd>the actual values for orbital elements in the format [a,e,i,o,w,m,T] </dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RunCompleteOD</span>(<span class="hljs-params">iterations:int, inputFile:str, fitsFiles:list, sunFile:str, dates:list, results:list</span>):</span>
    <span class="hljs-string">""" Runs complete orbit determination code. Generates three files:
            SoongODResults.txt (the results of orbital determination),
            SoongMonteCarloOutput.txt (the results from the Monte Carlo simulation),
            SoongGeneratedEphemeris.txt (the results from the ephemeris generation)
        Args:
            iterations (int): the number of iteration for which to run the Monte Carlo simulation
            inputFile (str): path for file containing observations to determine orbital elements
            fitsFiles (list): list of strings describing paths for the three fits files for Monte Carlo sim
            sunFile (str): path for file containing times and sun positions for ephemeris generation
            dates (list): list of dates for orbital elements determination
            results (list): the actual values for orbital elements in the format [a,e,i,o,w,m,T] 
        Returns:
            None
    """</span>
 
    <span class="hljs-comment"># generate orbital elements</span>
    data=Data()
    od=OD(inputFile)
    od.MoG(selDate=dates)
    
    <span class="hljs-comment"># determine error</span>
    a,e,i,o,w,m,T = results
    print(<span class="hljs-string">"--- Results from orbital elements determination ---"</span>)
    od.getError([e,<span class="hljs-number">0</span>,i,o,w,T,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a])
    od.exportResults(<span class="hljs-number">2459784.7916667</span>, <span class="hljs-string">"July 24, 2022 7:00 UT"</span>, <span class="hljs-string">"SoongODResults.txt"</span>) 
    
    <span class="hljs-comment"># Monte Carlo</span>
    results = [a,e,i,o,w,T] 
    print(<span class="hljs-string">"\n--- Monte Carlo Simulation ---"</span>)
    od.monteCarlo(iterations, fitsFiles, <span class="hljs-string">"SoongMonteCarloOutput.txt"</span>, results, selDate=dates)
    
    <span class="hljs-comment"># generate the ephemeris</span>
    od.genEphemeris(sunFile, <span class="hljs-string">"SoongGeneratedEphemeris.txt"</span>)
    print(<span class="hljs-string">"--- Ephemeris generation completed ---"</span>)</code></pre>
</details>
</dd>
<dt id="odlib.cross"><code class="name flex">
<span>def <span class="ident">cross</span></span>(<span>v1:&nbsp;list, v2:&nbsp;list) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the cross product of two 3D vectors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>v1</code></strong> : <code>list</code></dt>
<dd>vector1</dd>
<dt><strong><code>v2</code></strong> : <code>list</code></dt>
<dd>vector2</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>resulting cross product</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cross</span>(<span class="hljs-params">v1:list, v2:list</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns the cross product of two 3D vectors
        Args:
            v1 (list): vector1
            v2 (list): vector2
        Returns:
            list: resulting cross product
    """</span>
    <span class="hljs-keyword">return</span> [(v1[<span class="hljs-number">1</span>]*v2[<span class="hljs-number">2</span>] - v1[<span class="hljs-number">2</span>]*v2[<span class="hljs-number">1</span>]),-(v1[<span class="hljs-number">0</span>]*v2[<span class="hljs-number">2</span>] - v1[<span class="hljs-number">2</span>]*v2[<span class="hljs-number">0</span>]),(v1[<span class="hljs-number">0</span>]*v2[<span class="hljs-number">1</span>] - v1[<span class="hljs-number">1</span>]*v2[<span class="hljs-number">0</span>])]</code></pre>
</details>
</dd>
<dt id="odlib.decToRad"><code class="name flex">
<span>def <span class="ident">decToRad</span></span>(<span>dec:&nbsp;float) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Given decimal value return in radians</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dec</code></strong> : <code>float</code></dt>
<dd>decimal value</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>value in radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decToRad</span>(<span class="hljs-params">dec:float</span>)-&gt;float:</span>
    <span class="hljs-string">""" Given decimal value return in radians
        Args:
            dec (float): decimal value
        Returns:
            float: value in radians
    """</span>
    <span class="hljs-keyword">return</span> float(dec)/<span class="hljs-number">180</span>*math.pi</code></pre>
</details>
</dd>
<dt id="odlib.det2x2"><code class="name flex">
<span>def <span class="ident">det2x2</span></span>(<span>m) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the determinant of a 2x2 matrix</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>m</code></strong> : <code>list</code></dt>
<dd>matrix</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>resulting determinant</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">det2x2</span>(<span class="hljs-params">m</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the determinant of a 2x2 matrix
        Args:
            m (list): matrix
        Returns:
            float: resulting determinant
    """</span>
    <span class="hljs-keyword">return</span> m[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]*m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]-m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]*m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]</code></pre>
</details>
</dd>
<dt id="odlib.dot"><code class="name flex">
<span>def <span class="ident">dot</span></span>(<span>v1:&nbsp;list, v2:&nbsp;list) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the dot product of two vectors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>v1</code></strong> : <code>list</code></dt>
<dd>vector1</dd>
<dt><strong><code>v2</code></strong> : <code>list</code></dt>
<dd>vector2</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>resulting dot product</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dot</span>(<span class="hljs-params">v1:list,v2:list</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the dot product of two vectors
        Args:
            v1 (list): vector1
            v2 (list): vector2
        Returns:
            float: resulting dot product
    """</span>
    <span class="hljs-keyword">return</span> sum([v1[i]*v2[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(v1))])</code></pre>
</details>
</dd>
<dt id="odlib.error"><code class="name flex">
<span>def <span class="ident">error</span></span>(<span>acc:&nbsp;float, exp:&nbsp;float) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the error given accepted and experimental values</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>acc</code></strong> : <code>float</code></dt>
<dd>accepted value</dd>
<dt><strong><code>exp</code></strong> : <code>float</code></dt>
<dd>experimental value</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the error in percent</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">error</span>(<span class="hljs-params">acc:float,exp:float</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the error given accepted and experimental values
        Args:
            acc (float): accepted value
            exp (float): experimental value
        Returns:
            float: the error in percent
    """</span>
    <span class="hljs-keyword">return</span> math.copysign(abs(acc-exp)/acc*<span class="hljs-number">100</span>,<span class="hljs-number">1</span>)</code></pre>
</details>
</dd>
<dt id="odlib.getAngle"><code class="name flex">
<span>def <span class="ident">getAngle</span></span>(<span>sin:&nbsp;float, cos:&nbsp;float) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the angle (in radians) in the correct quadrant given sin and cos</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>sin</code></strong> : <code>float</code></dt>
<dd>sin value</dd>
<dt><strong><code>cos</code></strong> : <code>float</code></dt>
<dd>cos value</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>resulting angle in radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngle</span>(<span class="hljs-params">sin:float,cos:float</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the angle (in radians) in the correct quadrant given sin and cos
        Args:
            sin (float): sin value
            cos (float): cos value
        Returns:
            float: resulting angle in radians
    """</span>
    <span class="hljs-keyword">return</span> math.atan2(sin,cos) % (math.pi*<span class="hljs-number">2</span>)</code></pre>
</details>
</dd>
<dt id="odlib.getMag"><code class="name flex">
<span>def <span class="ident">getMag</span></span>(<span>vec:&nbsp;list) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the magnitude given a vector</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vec</code></strong> : <code>list</code></dt>
<dd>vector</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the magnitude of the vector</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getMag</span>(<span class="hljs-params">vec:list</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the magnitude given a vector
        Args:
            vec (list): vector
        Returns:
            float: the magnitude of the vector
    """</span>
    <span class="hljs-keyword">return</span> math.sqrt(sum([vec[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vec))]))</code></pre>
</details>
</dd>
<dt id="odlib.newton"><code class="name flex">
<span>def <span class="ident">newton</span></span>(<span>func, der, init:&nbsp;float, err:&nbsp;float) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Performs the Newton-Rhapson method</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>func</code></strong> : <code>function</code></dt>
<dd>function</dd>
<dt><strong><code>der</code></strong> : <code>function</code></dt>
<dd>derivative of function</dd>
<dt><strong><code>init</code></strong> : <code>float</code></dt>
<dd>initial guess</dd>
<dt><strong><code>err</code></strong> : <code>float</code></dt>
<dd>tolerance</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the answer</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">newton</span>(<span class="hljs-params">func,der,init:float,err:float</span>)-&gt;float:</span> <span class="hljs-comment">#function, derivative, inital_guess, error_tolerance</span>
    <span class="hljs-string">""" Performs the Newton-Rhapson method
        Args:
            func (function): function
            der (function): derivative of function
            init (float): initial guess
            err (float): tolerance
        Returns:
            float: the answer
    """</span>
    prev=<span class="hljs-number">-1e10</span>
    <span class="hljs-keyword">while</span> abs(init-prev)&gt;=err:
        prev,init=init,init-func(init)/der(init)
    <span class="hljs-keyword">return</span> init</code></pre>
</details>
</dd>
<dt id="odlib.rotX"><code class="name flex">
<span>def <span class="ident">rotX</span></span>(<span>v:&nbsp;list, omega:&nbsp;float) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Rotates a vector around x axis with omega (in radians)'''</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>v</code></strong> : <code>list</code></dt>
<dd>original vector</dd>
<dt><strong><code>omega</code></strong> : <code>float</code></dt>
<dd>angle to rotate around x axis (in radians)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>rotated vector</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rotX</span>(<span class="hljs-params">v:list,omega:float</span>)-&gt;list:</span>
    <span class="hljs-string">""" Rotates a vector around x axis with omega (in radians)'''
        Args:
            v (list): original vector
            omega (float): angle to rotate around x axis (in radians)
        Returns:
            list: rotated vector
    """</span>
    x=np.array([[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],
                [<span class="hljs-number">0</span>,np.cos(omega),-np.sin(omega)],
                [<span class="hljs-number">0</span>,np.sin(omega),np.cos(omega)]])
    <span class="hljs-keyword">return</span> np.matmul(x,v)</code></pre>
</details>
</dd>
<dt id="odlib.rotZX"><code class="name flex">
<span>def <span class="ident">rotZX</span></span>(<span>v:&nbsp;list, alpha:&nbsp;float, beta:&nbsp;float) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Rotates a vector around z axis with alpha, then rotates around x axis with beta'''</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>v</code></strong> : <code>list</code></dt>
<dd>original vector</dd>
<dt><strong><code>alpha</code></strong> : <code>float</code></dt>
<dd>angle to rotate around z axis (in radians)</dd>
<dt><strong><code>beta</code></strong> : <code>float</code></dt>
<dd>angle to rotate around x axis (in radians)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>rotated vector</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rotZX</span>(<span class="hljs-params">v:list,alpha:float,beta:float</span>)-&gt;list:</span>
    <span class="hljs-string">""" Rotates a vector around z axis with alpha, then rotates around x axis with beta'''
        Args:
            v (list): original vector
            alpha (float): angle to rotate around z axis (in radians)
            beta (float): angle to rotate around x axis (in radians)
        Returns:
            list: rotated vector
    """</span>
    z=np.array([[np.cos(alpha),-np.sin(alpha),<span class="hljs-number">0</span>],
                [np.sin(alpha),np.cos(alpha),<span class="hljs-number">0</span>],
                [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]])
    x=np.array([[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],
                [<span class="hljs-number">0</span>,np.cos(beta),-np.sin(beta)],
                [<span class="hljs-number">0</span>,np.sin(beta),np.cos(beta)]])
    <span class="hljs-keyword">return</span> np.dot(np.matmul(x,z),v)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="odlib.Data"><code class="flex name class">
<span>class <span class="ident">Data</span></span>
</code></dt>
<dd>
<div class="desc"><p>Class that reads and interprets data from input file</p>
<p>Initializes the class</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Data</span>:</span>
    <span class="hljs-string">'''Class that reads and interprets data from input file'''</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">""" Initializes the class
            Args:
                None
            Returns:
                None
        """</span> 
        self.info=np.array([]) <span class="hljs-comment"># non formatted data from input file</span>
        self.inputData=<span class="hljs-literal">None</span> <span class="hljs-comment"># formatted data from input file (list)]</span>
        
        self.infoByTime={}
        self.infoByDate={} <span class="hljs-comment"># dictionary of values. date is key. format for key: 2018-Jul-14 00:00:00.0000</span>
        self.sunFileName=<span class="hljs-string">""</span>
        self.inputFileName=<span class="hljs-string">""</span>
        
        <span class="hljs-comment"># constants</span>
        self.JDTIME=<span class="hljs-number">0</span>
        self.DATE=<span class="hljs-number">1</span>
        self.RA=<span class="hljs-number">2</span>
        self.DEC=<span class="hljs-number">3</span>
        self.R=<span class="hljs-number">4</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInput</span>(<span class="hljs-params">self, file:str</span>)-&gt;list:</span>
        <span class="hljs-string">""" Formats and returns formatted input. Stores into dictionaries, and converts all RA and Dec 
            into decimals. 
            Args:
                file (str): the input file name
            Returns:
                list: the formatted input [jdtime (float), date (str), ra (float), dec (float), [RX,RY,RZ] (np.array)]
        """</span> 
        self.inputFileName=file
        self.info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        <span class="hljs-comment"># store in dictionary for fast retrieval; also, formats all the dec and ra, converting to decimals</span>
        <span class="hljs-comment"># [jdtime, date(str), ra, dec, [RX,RY,RZ] (np.array)]</span>
        self.inputData=[]

        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(self.info)):
            data=self.info[line]
            jdtime = float(data[<span class="hljs-number">0</span>])
            date = data[<span class="hljs-number">1</span>].strip()
            
            strRA,strDec = data[<span class="hljs-number">2</span>].split(<span class="hljs-string">':'</span>), data[<span class="hljs-number">3</span>].split(<span class="hljs-string">':'</span>)
            h,m,s=float(strRA[<span class="hljs-number">0</span>]),float(strRA[<span class="hljs-number">1</span>]),float(strRA[<span class="hljs-number">2</span>])
            ra=HMStoDeg(h,m,s)
            d,m,s=float(strDec[<span class="hljs-number">0</span>]),float(strDec[<span class="hljs-number">1</span>]),float(strDec[<span class="hljs-number">2</span>])
            dec=DMStoDeg(d,m,s)
            
            R=[float(data[<span class="hljs-number">4</span>]),float(data[<span class="hljs-number">5</span>]),float(data[<span class="hljs-number">6</span>])]
            
            self.inputData.append([jdtime, date, ra, dec, R])
            self.infoByDate[date] = [jdtime, date, ra, dec, R]
            self.infoByTime[jdtime] = [jdtime, date, ra, dec, R]
            
        <span class="hljs-keyword">return</span> self.inputData <span class="hljs-comment"># nothing is formatted, just all information</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSunInput</span>(<span class="hljs-params">self,date:str=None,time:float=None</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns the sun input for a given time
            Args:
                date (str): optional; the date for sun vector
                time (float): optional; the time in Julian days for sun vector
            Returns:
                list: the sun vector
        """</span> 
        <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(date==<span class="hljs-literal">None</span>):
            <span class="hljs-keyword">return</span> self.infoByDate[date][self.R]
            
        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(time==<span class="hljs-literal">None</span>):
            <span class="hljs-keyword">return</span> self.infoByTime[time][self.R]
        
        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># nothing has been inputted, throw an exception</span>
            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No time has been given to find sun input"</span>)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getRADECInput</span>(<span class="hljs-params">self,date:str=None,time:float=None</span>):</span>
        <span class="hljs-string">""" Returns the right ascension and declination for a given time
            Args:
                date (str): optional; the date for right ascension and declination
                time (float): optional; the time in Julian days for right ascension and declination
            Returns:
                floats: ra, dec
        """</span> 
        <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(date==<span class="hljs-literal">None</span>):
            d=self.infoByDate[date]
            <span class="hljs-keyword">return</span> d[self.RA], d[self.DEC]
            
        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(time==<span class="hljs-literal">None</span>):
            d=self.infoByTime[time]
            <span class="hljs-keyword">return</span> d[self.RA], d[self.DEC]
            
        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># nothing has been inputted, throw an exception</span>
            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No time has been given to find ra"</span>)
            
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getJDTime</span>(<span class="hljs-params">self,date:str</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns Julian Days time given date
            Args:
                date (str): optional; the date for right ascension and declination
                time (float): optional; the time in Julian days for right ascension and declination
            Returns:
                floats: ra, dec
        """</span> 
        <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
        
        d=self.infoByDate[date]
        <span class="hljs-keyword">return</span> d[self.JDTIME]

    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">formatTestInputInfo</span>(<span class="hljs-params">self, file:str</span>):</span>
        <span class="hljs-string">""" Returns re-formatted data from test input file (for testing purposes, specifically OD elements generation)
            Args:
                file (str): file name
            Returns:
                lists: time (in julian days), data [[x,y,z],[dx,dy,dz]], timestamps (strings)
        """</span>
        info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        time=np.array([float(info[i,<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(info))])
        timestamps=np.copy(info[<span class="hljs-number">1</span>:,<span class="hljs-number">1</span>])
        
        <span class="hljs-keyword">return</span> time,np.array([([float(info[i][<span class="hljs-number">2</span>]),float(info[i][<span class="hljs-number">3</span>]),float(info[i][<span class="hljs-number">4</span>])], 
                        [float(info[i][<span class="hljs-number">5</span>]),float(info[i][<span class="hljs-number">6</span>]),float(info[i][<span class="hljs-number">7</span>])]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(info))]), timestamps
   
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTestInput</span>(<span class="hljs-params">self, file:str, date:str</span>):</span>
        <span class="hljs-string">""" Returns pos, vel, and times for testing asteroid (for testing purposes, specifically OD elements generation)
            Args:
                file (str): file name
                date (str): date for testing
            Returns:
                lists: pos, vel, time
        """</span>
        times,data,timestamps=self.formatTestInputInfo(file)           
        line = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(timestamps)):
            <span class="hljs-keyword">if</span> date <span class="hljs-keyword">in</span> timestamps[i]: 
                line = i
                <span class="hljs-keyword">break</span>
                
        time,info=times[line],data[line]
        pos,vel=info[<span class="hljs-number">0</span>],info[<span class="hljs-number">1</span>]
        <span class="hljs-keyword">return</span> pos, vel, time
                               
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSunPos</span>(<span class="hljs-params">self, date:str, file:str</span>)-&gt;list:</span>
        <span class="hljs-string">""" Gets the vector from the Earth to the Sun given the date
            Args:
                date (str): the date to use
                file (str): file name
            Returns:
                list: sun vector R
        """</span>
        info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        
        timestamps=info[:,<span class="hljs-number">1</span>]
        flag=<span class="hljs-literal">False</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(timestamps)):
            <span class="hljs-keyword">if</span> date <span class="hljs-keyword">in</span> timestamps[i]: 
                line = i
                flag=<span class="hljs-literal">True</span>
                <span class="hljs-keyword">break</span>
        
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> flag: <span class="hljs-keyword">return</span> np.array([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]) <span class="hljs-comment"># not found</span>
        
        stuff=info[line,:]
        x,y,z=float(stuff[<span class="hljs-number">2</span>]),float(stuff[<span class="hljs-number">3</span>]),float(stuff[<span class="hljs-number">4</span>])
        <span class="hljs-keyword">return</span> np.array([x,y,z])
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAllSunPos</span>(<span class="hljs-params">self, file:str</span>)-&gt;list:</span>
        <span class="hljs-string">""" Gets all sun positions and returns as a list
            Args:
                file (str): file name
            Returns:
                list: list of lists [time, date, sunPos (np.array)]
        """</span>
        info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
        results=[]
        
        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> info[<span class="hljs-number">1</span>:]:
            time,date=float(line[<span class="hljs-number">0</span>]),line[<span class="hljs-number">1</span>].strip()
            R=np.array([float(line[<span class="hljs-number">2</span>]),float(line[<span class="hljs-number">3</span>]),float(line[<span class="hljs-number">4</span>])])
            results.append([time,date,R])
  
        <span class="hljs-keyword">return</span> results

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportEphemeris</span>(<span class="hljs-params">self, fileName:str, results:list</span>):</span>
        <span class="hljs-string">""" Exports ephemeris to a file
            Args:
                fileName (str): file name for exported ephemeris
                results (list): all results
            Returns:
                None
        """</span>
        <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
            file.write((<span class="hljs-string">"Date\tTime\tRA\tDec\n"</span>).expandtabs(<span class="hljs-number">40</span>))
            <span class="hljs-keyword">for</span> date, time, ra, dec <span class="hljs-keyword">in</span> results:
                file.write((date+<span class="hljs-string">"\t"</span>+time+<span class="hljs-string">"\t"</span>+ra+<span class="hljs-string">"\t"</span>+dec+<span class="hljs-string">"\n"</span>).expandtabs(<span class="hljs-number">40</span>))
                
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportMonteCarlo</span>(<span class="hljs-params">self, fileName:str, vals:list, results</span>):</span>
        <span class="hljs-string">""" Exports Monte Carlo to a file
            Args:
                fileName (str): file name for exported ephemeris
                vals (list): all vals [num,a,e,i,o,w,T]
                results (list): real values to compare vals [a,e,i,o,w,t]
            Returns:
                None
        """</span>
        labels=[<span class="hljs-string">"a"</span>,<span class="hljs-string">"e"</span>,<span class="hljs-string">"i"</span>,<span class="hljs-string">"o"</span>,<span class="hljs-string">"w"</span>,<span class="hljs-string">"T"</span>]
        <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(vals)):
                file.write(<span class="hljs-string">"----"</span>+str(vals[j][<span class="hljs-number">0</span>])+<span class="hljs-string">"----\n"</span>)
                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">6</span>):
                    file.write(labels[i]+<span class="hljs-string">": "</span>+str(vals[j][i+<span class="hljs-number">1</span>])+<span class="hljs-string">" \t error: "</span> + str(error(results[i],vals[j][i+<span class="hljs-number">1</span>])) + <span class="hljs-string">"\n"</span>)

    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printResults</span>(<span class="hljs-params">self, fileName:str, pos:list, vel:list, rho:list, a:float, e:float, i:float, o:float, T:float, w:float, date:str, M:float</span>):</span>
        <span class="hljs-string">""" Gets the vector from the Earth to the Sun given the date
            Args:
                fileName (str): exported file name
                pos (list): position from sun
                vel (list): the velocity of the asteroid
                rho (list): the position from Earth
                a (float): semi major axis
                e (float): eccentricity
                i (float): inclination
                o (float): longitude of ascending node (Degrees)
                T (float): time of perihelion passage
                w (float): argument of perihelion (Degrees)
                date (str): date for calculated mean anomaly
                M (float): mean anomaly
            Returns:
                None
        """</span>
        <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
            file.write(<span class="hljs-string">"1999 GJ2 Orbit Determination"</span>)
            file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
            file.write(<span class="hljs-string">"Position From Sun (r, AU):\n\t"</span> + str(pos))
            file.write(<span class="hljs-string">"\nVelocity (AU/day):\n\t"</span>+str(vel))
            file.write(<span class="hljs-string">"\nPosition From Earth (rho, AU):\n\t"</span>+str(rho))
            file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
            file.write(<span class="hljs-string">"Orbital Elements:"</span>)
            file.write(<span class="hljs-string">"\n\tSemi-Major Axis (AU): "</span> + str(a))
            file.write(<span class="hljs-string">"\n\tEccentricity: "</span> + str(e))
            file.write(<span class="hljs-string">"\n\tInclination (deg): "</span> + str(i))
            file.write(<span class="hljs-string">"\n\tLongitude of Ascending Node (deg): "</span> + str(o))
            file.write(<span class="hljs-string">"\n\tTime of Perihelion Passage (Julian days): "</span> + str(T))
            file.write(<span class="hljs-string">"\n\tArgument of Perihelion (deg): "</span> + str(w))
            file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
            file.write(<span class="hljs-string">"Mean Anomaly (deg) for "</span>+date+<span class="hljs-string">":"</span>)
            file.write(<span class="hljs-string">"\n\t"</span>+str(M))</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="odlib.Data.exportEphemeris"><code class="name flex">
<span>def <span class="ident">exportEphemeris</span></span>(<span>self, fileName:&nbsp;str, results:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Exports ephemeris to a file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>fileName</code></strong> : <code>str</code></dt>
<dd>file name for exported ephemeris</dd>
<dt><strong><code>results</code></strong> : <code>list</code></dt>
<dd>all results</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportEphemeris</span>(<span class="hljs-params">self, fileName:str, results:list</span>):</span>
    <span class="hljs-string">""" Exports ephemeris to a file
        Args:
            fileName (str): file name for exported ephemeris
            results (list): all results
        Returns:
            None
    """</span>
    <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
        file.write((<span class="hljs-string">"Date\tTime\tRA\tDec\n"</span>).expandtabs(<span class="hljs-number">40</span>))
        <span class="hljs-keyword">for</span> date, time, ra, dec <span class="hljs-keyword">in</span> results:
            file.write((date+<span class="hljs-string">"\t"</span>+time+<span class="hljs-string">"\t"</span>+ra+<span class="hljs-string">"\t"</span>+dec+<span class="hljs-string">"\n"</span>).expandtabs(<span class="hljs-number">40</span>))</code></pre>
</details>
</dd>
<dt id="odlib.Data.exportMonteCarlo"><code class="name flex">
<span>def <span class="ident">exportMonteCarlo</span></span>(<span>self, fileName:&nbsp;str, vals:&nbsp;list, results)</span>
</code></dt>
<dd>
<div class="desc"><p>Exports Monte Carlo to a file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>fileName</code></strong> : <code>str</code></dt>
<dd>file name for exported ephemeris</dd>
<dt><strong><code>vals</code></strong> : <code>list</code></dt>
<dd>all vals [num,a,e,i,o,w,T]</dd>
<dt><strong><code>results</code></strong> : <code>list</code></dt>
<dd>real values to compare vals [a,e,i,o,w,t]</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportMonteCarlo</span>(<span class="hljs-params">self, fileName:str, vals:list, results</span>):</span>
    <span class="hljs-string">""" Exports Monte Carlo to a file
        Args:
            fileName (str): file name for exported ephemeris
            vals (list): all vals [num,a,e,i,o,w,T]
            results (list): real values to compare vals [a,e,i,o,w,t]
        Returns:
            None
    """</span>
    labels=[<span class="hljs-string">"a"</span>,<span class="hljs-string">"e"</span>,<span class="hljs-string">"i"</span>,<span class="hljs-string">"o"</span>,<span class="hljs-string">"w"</span>,<span class="hljs-string">"T"</span>]
    <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(vals)):
            file.write(<span class="hljs-string">"----"</span>+str(vals[j][<span class="hljs-number">0</span>])+<span class="hljs-string">"----\n"</span>)
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">6</span>):
                file.write(labels[i]+<span class="hljs-string">": "</span>+str(vals[j][i+<span class="hljs-number">1</span>])+<span class="hljs-string">" \t error: "</span> + str(error(results[i],vals[j][i+<span class="hljs-number">1</span>])) + <span class="hljs-string">"\n"</span>)</code></pre>
</details>
</dd>
<dt id="odlib.Data.formatTestInputInfo"><code class="name flex">
<span>def <span class="ident">formatTestInputInfo</span></span>(<span>self, file:&nbsp;str)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns re-formatted data from test input file (for testing purposes, specifically OD elements generation)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file</code></strong> : <code>str</code></dt>
<dd>file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>time (in julian days), data [[x,y,z],[dx,dy,dz]], timestamps (strings)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">formatTestInputInfo</span>(<span class="hljs-params">self, file:str</span>):</span>
    <span class="hljs-string">""" Returns re-formatted data from test input file (for testing purposes, specifically OD elements generation)
        Args:
            file (str): file name
        Returns:
            lists: time (in julian days), data [[x,y,z],[dx,dy,dz]], timestamps (strings)
    """</span>
    info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
    time=np.array([float(info[i,<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(info))])
    timestamps=np.copy(info[<span class="hljs-number">1</span>:,<span class="hljs-number">1</span>])
    
    <span class="hljs-keyword">return</span> time,np.array([([float(info[i][<span class="hljs-number">2</span>]),float(info[i][<span class="hljs-number">3</span>]),float(info[i][<span class="hljs-number">4</span>])], 
                    [float(info[i][<span class="hljs-number">5</span>]),float(info[i][<span class="hljs-number">6</span>]),float(info[i][<span class="hljs-number">7</span>])]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(info))]), timestamps</code></pre>
</details>
</dd>
<dt id="odlib.Data.getAllSunPos"><code class="name flex">
<span>def <span class="ident">getAllSunPos</span></span>(<span>self, file:&nbsp;str) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Gets all sun positions and returns as a list</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file</code></strong> : <code>str</code></dt>
<dd>file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of lists [time, date, sunPos (np.array)]</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAllSunPos</span>(<span class="hljs-params">self, file:str</span>)-&gt;list:</span>
    <span class="hljs-string">""" Gets all sun positions and returns as a list
        Args:
            file (str): file name
        Returns:
            list: list of lists [time, date, sunPos (np.array)]
    """</span>
    info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
    results=[]
    
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> info[<span class="hljs-number">1</span>:]:
        time,date=float(line[<span class="hljs-number">0</span>]),line[<span class="hljs-number">1</span>].strip()
        R=np.array([float(line[<span class="hljs-number">2</span>]),float(line[<span class="hljs-number">3</span>]),float(line[<span class="hljs-number">4</span>])])
        results.append([time,date,R])

    <span class="hljs-keyword">return</span> results</code></pre>
</details>
</dd>
<dt id="odlib.Data.getInput"><code class="name flex">
<span>def <span class="ident">getInput</span></span>(<span>self, file:&nbsp;str) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Formats and returns formatted input. Stores into dictionaries, and converts all RA and Dec
into decimals. </p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file</code></strong> : <code>str</code></dt>
<dd>the input file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>the formatted input [jdtime (float), date (str), ra (float), dec (float), [RX,RY,RZ] (np.array)]</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInput</span>(<span class="hljs-params">self, file:str</span>)-&gt;list:</span>
    <span class="hljs-string">""" Formats and returns formatted input. Stores into dictionaries, and converts all RA and Dec 
        into decimals. 
        Args:
            file (str): the input file name
        Returns:
            list: the formatted input [jdtime (float), date (str), ra (float), dec (float), [RX,RY,RZ] (np.array)]
    """</span> 
    self.inputFileName=file
    self.info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
    <span class="hljs-comment"># store in dictionary for fast retrieval; also, formats all the dec and ra, converting to decimals</span>
    <span class="hljs-comment"># [jdtime, date(str), ra, dec, [RX,RY,RZ] (np.array)]</span>
    self.inputData=[]

    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,len(self.info)):
        data=self.info[line]
        jdtime = float(data[<span class="hljs-number">0</span>])
        date = data[<span class="hljs-number">1</span>].strip()
        
        strRA,strDec = data[<span class="hljs-number">2</span>].split(<span class="hljs-string">':'</span>), data[<span class="hljs-number">3</span>].split(<span class="hljs-string">':'</span>)
        h,m,s=float(strRA[<span class="hljs-number">0</span>]),float(strRA[<span class="hljs-number">1</span>]),float(strRA[<span class="hljs-number">2</span>])
        ra=HMStoDeg(h,m,s)
        d,m,s=float(strDec[<span class="hljs-number">0</span>]),float(strDec[<span class="hljs-number">1</span>]),float(strDec[<span class="hljs-number">2</span>])
        dec=DMStoDeg(d,m,s)
        
        R=[float(data[<span class="hljs-number">4</span>]),float(data[<span class="hljs-number">5</span>]),float(data[<span class="hljs-number">6</span>])]
        
        self.inputData.append([jdtime, date, ra, dec, R])
        self.infoByDate[date] = [jdtime, date, ra, dec, R]
        self.infoByTime[jdtime] = [jdtime, date, ra, dec, R]
        
    <span class="hljs-keyword">return</span> self.inputData <span class="hljs-comment"># nothing is formatted, just all information</span></code></pre>
</details>
</dd>
<dt id="odlib.Data.getJDTime"><code class="name flex">
<span>def <span class="ident">getJDTime</span></span>(<span>self, date:&nbsp;str) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns Julian Days time given date</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>optional; the date for right ascension and declination</dd>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>optional; the time in Julian days for right ascension and declination</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>ra, dec</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getJDTime</span>(<span class="hljs-params">self,date:str</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns Julian Days time given date
        Args:
            date (str): optional; the date for right ascension and declination
            time (float): optional; the time in Julian days for right ascension and declination
        Returns:
            floats: ra, dec
    """</span> 
    <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
    
    d=self.infoByDate[date]
    <span class="hljs-keyword">return</span> d[self.JDTIME]</code></pre>
</details>
</dd>
<dt id="odlib.Data.getRADECInput"><code class="name flex">
<span>def <span class="ident">getRADECInput</span></span>(<span>self, date:&nbsp;str&nbsp;=&nbsp;None, time:&nbsp;float&nbsp;=&nbsp;None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the right ascension and declination for a given time</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>optional; the date for right ascension and declination</dd>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>optional; the time in Julian days for right ascension and declination</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>ra, dec</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getRADECInput</span>(<span class="hljs-params">self,date:str=None,time:float=None</span>):</span>
    <span class="hljs-string">""" Returns the right ascension and declination for a given time
        Args:
            date (str): optional; the date for right ascension and declination
            time (float): optional; the time in Julian days for right ascension and declination
        Returns:
            floats: ra, dec
    """</span> 
    <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(date==<span class="hljs-literal">None</span>):
        d=self.infoByDate[date]
        <span class="hljs-keyword">return</span> d[self.RA], d[self.DEC]
        
    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(time==<span class="hljs-literal">None</span>):
        d=self.infoByTime[time]
        <span class="hljs-keyword">return</span> d[self.RA], d[self.DEC]
        
    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># nothing has been inputted, throw an exception</span>
        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No time has been given to find ra"</span>)</code></pre>
</details>
</dd>
<dt id="odlib.Data.getSunInput"><code class="name flex">
<span>def <span class="ident">getSunInput</span></span>(<span>self, date:&nbsp;str&nbsp;=&nbsp;None, time:&nbsp;float&nbsp;=&nbsp;None) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the sun input for a given time</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>optional; the date for sun vector</dd>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>optional; the time in Julian days for sun vector</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>the sun vector</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSunInput</span>(<span class="hljs-params">self,date:str=None,time:float=None</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns the sun input for a given time
        Args:
            date (str): optional; the date for sun vector
            time (float): optional; the time in Julian days for sun vector
        Returns:
            list: the sun vector
    """</span> 
    <span class="hljs-keyword">if</span> np.shape(self.info)==<span class="hljs-number">0</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No input has been loaded up"</span>)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(date==<span class="hljs-literal">None</span>):
        <span class="hljs-keyword">return</span> self.infoByDate[date][self.R]
        
    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(time==<span class="hljs-literal">None</span>):
        <span class="hljs-keyword">return</span> self.infoByTime[time][self.R]
    
    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># nothing has been inputted, throw an exception</span>
        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No time has been given to find sun input"</span>)</code></pre>
</details>
</dd>
<dt id="odlib.Data.getSunPos"><code class="name flex">
<span>def <span class="ident">getSunPos</span></span>(<span>self, date:&nbsp;str, file:&nbsp;str) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Gets the vector from the Earth to the Sun given the date</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>the date to use</dd>
<dt><strong><code>file</code></strong> : <code>str</code></dt>
<dd>file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>sun vector R</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSunPos</span>(<span class="hljs-params">self, date:str, file:str</span>)-&gt;list:</span>
    <span class="hljs-string">""" Gets the vector from the Earth to the Sun given the date
        Args:
            date (str): the date to use
            file (str): file name
        Returns:
            list: sun vector R
    """</span>
    info=np.loadtxt(file,dtype=str,delimiter=<span class="hljs-string">","</span>)
    
    timestamps=info[:,<span class="hljs-number">1</span>]
    flag=<span class="hljs-literal">False</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(timestamps)):
        <span class="hljs-keyword">if</span> date <span class="hljs-keyword">in</span> timestamps[i]: 
            line = i
            flag=<span class="hljs-literal">True</span>
            <span class="hljs-keyword">break</span>
    
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> flag: <span class="hljs-keyword">return</span> np.array([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]) <span class="hljs-comment"># not found</span>
    
    stuff=info[line,:]
    x,y,z=float(stuff[<span class="hljs-number">2</span>]),float(stuff[<span class="hljs-number">3</span>]),float(stuff[<span class="hljs-number">4</span>])
    <span class="hljs-keyword">return</span> np.array([x,y,z])</code></pre>
</details>
</dd>
<dt id="odlib.Data.getTestInput"><code class="name flex">
<span>def <span class="ident">getTestInput</span></span>(<span>self, file:&nbsp;str, date:&nbsp;str)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns pos, vel, and times for testing asteroid (for testing purposes, specifically OD elements generation)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file</code></strong> : <code>str</code></dt>
<dd>file name</dd>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>date for testing</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>pos, vel, time</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTestInput</span>(<span class="hljs-params">self, file:str, date:str</span>):</span>
    <span class="hljs-string">""" Returns pos, vel, and times for testing asteroid (for testing purposes, specifically OD elements generation)
        Args:
            file (str): file name
            date (str): date for testing
        Returns:
            lists: pos, vel, time
    """</span>
    times,data,timestamps=self.formatTestInputInfo(file)           
    line = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(timestamps)):
        <span class="hljs-keyword">if</span> date <span class="hljs-keyword">in</span> timestamps[i]: 
            line = i
            <span class="hljs-keyword">break</span>
            
    time,info=times[line],data[line]
    pos,vel=info[<span class="hljs-number">0</span>],info[<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> pos, vel, time</code></pre>
</details>
</dd>
<dt id="odlib.Data.printResults"><code class="name flex">
<span>def <span class="ident">printResults</span></span>(<span>self, 
fileName:&nbsp;str, pos:&nbsp;list, vel:&nbsp;list, rho:&nbsp;list, 
a:&nbsp;float, e:&nbsp;float, i:&nbsp;float, o:&nbsp;float, 
T:&nbsp;float, w:&nbsp;float, date:&nbsp;str, M:&nbsp;float)</span>
</code></dt>
<dd>
<div class="desc"><p>Gets the vector from the Earth to the Sun given the date</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>fileName</code></strong> : <code>str</code></dt>
<dd>exported file name</dd>
<dt><strong><code>pos</code></strong> : <code>list</code></dt>
<dd>position from sun</dd>
<dt><strong><code>vel</code></strong> : <code>list</code></dt>
<dd>the velocity of the asteroid</dd>
<dt><strong><code>rho</code></strong> : <code>list</code></dt>
<dd>the position from Earth</dd>
<dt><strong><code>a</code></strong> : <code>float</code></dt>
<dd>semi major axis</dd>
<dt><strong><code>e</code></strong> : <code>float</code></dt>
<dd>eccentricity</dd>
<dt><strong><code>i</code></strong> : <code>float</code></dt>
<dd>inclination</dd>
<dt><strong><code>o</code></strong> : <code>float</code></dt>
<dd>longitude of ascending node (Degrees)</dd>
<dt><strong><code>T</code></strong> : <code>float</code></dt>
<dd>time of perihelion passage</dd>
<dt><strong><code>w</code></strong> : <code>float</code></dt>
<dd>argument of perihelion (Degrees)</dd>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>date for calculated mean anomaly</dd>
<dt><strong><code>M</code></strong> : <code>float</code></dt>
<dd>mean anomaly</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printResults</span>(<span class="hljs-params">self, fileName:str, pos:list, vel:list, rho:list, a:float, e:float, i:float, o:float, T:float, w:float, date:str, M:float</span>):</span>
    <span class="hljs-string">""" Gets the vector from the Earth to the Sun given the date
        Args:
            fileName (str): exported file name
            pos (list): position from sun
            vel (list): the velocity of the asteroid
            rho (list): the position from Earth
            a (float): semi major axis
            e (float): eccentricity
            i (float): inclination
            o (float): longitude of ascending node (Degrees)
            T (float): time of perihelion passage
            w (float): argument of perihelion (Degrees)
            date (str): date for calculated mean anomaly
            M (float): mean anomaly
        Returns:
            None
    """</span>
    <span class="hljs-keyword">with</span> open(fileName, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
        file.write(<span class="hljs-string">"1999 GJ2 Orbit Determination"</span>)
        file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
        file.write(<span class="hljs-string">"Position From Sun (r, AU):\n\t"</span> + str(pos))
        file.write(<span class="hljs-string">"\nVelocity (AU/day):\n\t"</span>+str(vel))
        file.write(<span class="hljs-string">"\nPosition From Earth (rho, AU):\n\t"</span>+str(rho))
        file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
        file.write(<span class="hljs-string">"Orbital Elements:"</span>)
        file.write(<span class="hljs-string">"\n\tSemi-Major Axis (AU): "</span> + str(a))
        file.write(<span class="hljs-string">"\n\tEccentricity: "</span> + str(e))
        file.write(<span class="hljs-string">"\n\tInclination (deg): "</span> + str(i))
        file.write(<span class="hljs-string">"\n\tLongitude of Ascending Node (deg): "</span> + str(o))
        file.write(<span class="hljs-string">"\n\tTime of Perihelion Passage (Julian days): "</span> + str(T))
        file.write(<span class="hljs-string">"\n\tArgument of Perihelion (deg): "</span> + str(w))
        file.write(<span class="hljs-string">"\n----------------------------------------------\n"</span>)
        file.write(<span class="hljs-string">"Mean Anomaly (deg) for "</span>+date+<span class="hljs-string">":"</span>)
        file.write(<span class="hljs-string">"\n\t"</span>+str(M))</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="odlib.OD"><code class="flex name class">
<span>class <span class="ident">OD</span></span>
<span>(</span><span>inputFile:&nbsp;str)</span>
</code></dt>
<dd>
<div class="desc"><p>Class that performs all orbital determination calculations</p>
<p>Initializes OD class</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>inputFile</code></strong> : <code>str</code></dt>
<dd>input file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OD</span>:</span>
    <span class="hljs-string">'''Class that performs all orbital determination calculations'''</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, inputFile:str</span>):</span>
        <span class="hljs-string">""" Initializes OD class
            Args:
                inputFile (str): input file name
            Returns:
                None
        """</span>
        <span class="hljs-comment"># constants</span>
        self.k = <span class="hljs-number">0.0172020989484</span> <span class="hljs-comment">#Gaussian gravitational constant  </span>
        self.cAU = <span class="hljs-number">173.144643267</span> <span class="hljs-comment">#speed of light in au/(mean solar)day  </span>
        self.mu = <span class="hljs-number">1</span>
        self.eps = np.radians(<span class="hljs-number">23.4374</span>) <span class="hljs-comment">#Earth's obliquity</span>
        self.toGaussian=<span class="hljs-number">365.2568983</span>
        self.mu = <span class="hljs-number">1</span>
        
        self.data=Data() <span class="hljs-comment"># Data object</span>
        self.inputFile=inputFile
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genElements</span>(<span class="hljs-params">self, pos:list, vel:list, time:float, update:bool=True</span>):</span>
        <span class="hljs-string">""" Calculates and returns the orbital elements given position, velocity, time
            Args:
                pos (list): the position vector
                vel (list): the velocity vector
                time (float): the time in Julian days
                update (bool): if True keeps the newly calculated orbital elements
            Returns:
                floats: the orbital elements; a,e,i,o,v,w,T,M
        """</span>
        <span class="hljs-keyword">if</span> update:
            self.pos,self.vel,self.time=pos,vel,time
            self.od=ODElements(self.pos,self.vel,self.time)
            self.a,self.e,self.i,self.o,self.v,self.w,self.T,self.M = self.od.getElements()
            <span class="hljs-keyword">return</span> self.getElements()
        <span class="hljs-keyword">else</span>:
            od=ODElements(pos,vel,time)
            <span class="hljs-keyword">return</span> od.getElements()
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getElements</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">""" Returns the orbital elements (already calculated)
            Args:
                rad (bool): True if return in radians
            Returns:
                floats: a,e,i,o,v,w,T,M
        """</span>
        <span class="hljs-keyword">return</span> self.a, self.e, self.i, self.o, self.v, self.w, self.T, self.M
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">SEL</span>(<span class="hljs-params">self, taus:list, sunR2:list, rhohat2:list, coefD:list</span>):</span>
        <span class="hljs-string">""" Scalar Equation of Lagrange to calculate the roots (r) and rhos corresponding to each r
            Args:
                taus (list): a list of floats of taus [T1,T3,T]
                sunR2 (list): a list representing the sun vector R2
                rhohat2 (list): a list representing the rhohat2 vector
                coefD (list): a list of D coefficients [D0,D21,D22,D23]
            Returns:
                lists: roots (r's), rhos
        """</span>
        T1,T3,T=taus[<span class="hljs-number">0</span>],taus[<span class="hljs-number">1</span>],taus[<span class="hljs-number">2</span>]
        D0,D21,D22,D23=coefD[<span class="hljs-number">0</span>],coefD[<span class="hljs-number">1</span>],coefD[<span class="hljs-number">2</span>],coefD[<span class="hljs-number">3</span>]
        A1=T3/T
        B1=A1/<span class="hljs-number">6</span>*(T**<span class="hljs-number">2</span>-T3**<span class="hljs-number">2</span>)
        A3=-T1/T
        B3=A3/<span class="hljs-number">6</span>*(T**<span class="hljs-number">2</span>-T1**<span class="hljs-number">2</span>)
        A=(A1*D21-D22+A3*D23)/(-D0)
        B=(B1*D21+B3*D23)/(-D0)
        
        E=<span class="hljs-number">-2</span>*(dot(rhohat2, sunR2))
        F=dot(sunR2,sunR2)
        
        a=-(A**<span class="hljs-number">2</span>+A*E+F)
        b=-self.mu*(<span class="hljs-number">2</span>*A*B+B*E)
        c=-self.mu**<span class="hljs-number">2</span>*B**<span class="hljs-number">2</span>
        
        coef=[c,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,b,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]
        res=poly.polyroots(coef)

        temproots=[]
        <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> res: 
            <span class="hljs-keyword">if</span> np.isreal(val) <span class="hljs-keyword">and</span> np.real(val)&gt;<span class="hljs-number">0</span>: temproots.append(np.real(val))

        temprhos=[A+B/temproots[i]**<span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(temproots))]
        
        <span class="hljs-comment"># ignore pairs where rho magnitude is negative</span>
        roots=[]
        rhos=[]
        <span class="hljs-comment">#print(temproots, temprhos)</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(temproots)):
            <span class="hljs-keyword">if</span> temprhos[i]&gt;<span class="hljs-number">0.0</span>:
                roots.append(temproots[i])
                rhos.append(temprhos[i])
                
        
        
        <span class="hljs-keyword">return</span> roots,rhos
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ephemeris</span>(<span class="hljs-params">self, time:float, date:str, file:str=<span class="hljs-string">""</span>, sunPos:list=np.array(<span class="hljs-params">[]</span>)</span>):</span>
        <span class="hljs-string">""" Calculates RA and Dec given time and date, using previously calculated orbital elements
            Args:
                time (float): time to determine ephemeris for in Julian Days
                date (str): date for which to determine ephemeris
                file (str): file name for sun positions; optional
            Returns:
                floats: ra, dec
        """</span>
        n=self.k*math.sqrt(self.mu/(self.a**<span class="hljs-number">3</span>))
        M=n*(time-self.T)
        E=newton(<span class="hljs-keyword">lambda</span> E:M - E + self.e*np.sin(E), <span class="hljs-keyword">lambda</span> E: <span class="hljs-number">-1</span>+self.e*np.cos(E), M, <span class="hljs-number">1e-17</span>)
        
        pos=np.array([self.a*math.cos(E)-self.a*self.e, self.a*math.sqrt(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)*math.sin(E), <span class="hljs-number">0</span>])
        
        <span class="hljs-comment"># the four rotations</span>
        pos=rotZX(pos,np.deg2rad(self.w),np.deg2rad(self.i))
        pos=rotZX(pos,np.deg2rad(self.o),self.eps)
        
        <span class="hljs-keyword">if</span> file==<span class="hljs-string">""</span>: <span class="hljs-comment"># no file given, use sunPos</span>
            R=sunPos
        <span class="hljs-keyword">else</span>: R=self.data.getSunPos(date, file)
        <span class="hljs-keyword">if</span> np.array_equal(R, np.array([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>])): <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"Sun Position Not Found in SunPos.txt"</span>)
        rho=pos+R
        rhohat=rho/getMag(rho)
        
        dec=math.asin(rhohat[<span class="hljs-number">2</span>])
        cra=rhohat[<span class="hljs-number">0</span>]/math.cos(dec)
        sra=rhohat[<span class="hljs-number">1</span>]/math.cos(dec)

        ra=getAngle(sra,cra)
        
        dec=np.rad2deg(dec)
        ra=np.rad2deg(ra)
        
        dec=DECdecimalToDMS(dec)
        ra=RAdecimalToHMS(ra)
        
        <span class="hljs-keyword">return</span> ra,dec
        
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fg</span>(<span class="hljs-params">self, tau:float, r2mag:float, r2dot:list, order:int, r2:list=[]</span>):</span>
        <span class="hljs-string">""" Gets the f and g values given one time
            Args:
                tau (float): the time in Julian Days
                r2mag (float): the magnitude of r2
                r2dot (list): the velocity vector 2
                order (int): order of f and g taylor series approximations
                r2 (list): optional parameter, the position vector 2
            Returns:
                floats: f, g
        """</span>
        <span class="hljs-keyword">if</span> len(r2)==<span class="hljs-number">0</span>: u=self.mu/r2mag**<span class="hljs-number">3</span>
        <span class="hljs-keyword">else</span>: u=self.mu/getMag(r2)**<span class="hljs-number">3</span>
        
        f=<span class="hljs-number">1</span><span class="hljs-number">-1</span>/<span class="hljs-number">2</span>*u*tau**<span class="hljs-number">2</span>
        g=tau
        
        <span class="hljs-keyword">if</span> order&gt;=<span class="hljs-number">3</span>:
            z=dot(r2,r2dot)/(dot(r2,r2))
            q=dot(r2dot,r2dot)/(dot(r2,r2))-u
            f+=<span class="hljs-number">1</span>/<span class="hljs-number">2</span>*u*z*tau**<span class="hljs-number">3</span>
            g+=<span class="hljs-number">-1</span>/<span class="hljs-number">6</span>*u*tau**<span class="hljs-number">3</span>
        
        <span class="hljs-keyword">if</span> order&gt;=<span class="hljs-number">4</span>:
            f+=<span class="hljs-number">1</span>/<span class="hljs-number">24</span>*(<span class="hljs-number">3</span>*u*q<span class="hljs-number">-15</span>*u*z**<span class="hljs-number">2</span>+u**<span class="hljs-number">2</span>)*tau**<span class="hljs-number">4</span>
            g+=<span class="hljs-number">1</span>/<span class="hljs-number">4</span>*u*z*tau**<span class="hljs-number">4</span>
        
        <span class="hljs-keyword">return</span> f, g
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getFGVals</span>(<span class="hljs-params">self, tau1:float, tau3:float, r2mag:float, r2dot:list, order1:int, order2:int, r2:list=[]</span>):</span>
        <span class="hljs-string">""" Gets all f and g values
            Args:
                tau1 (float): the time in Julian Days for observation 1 from obs 2(T1-T2)
                tau3 (float): the time in Julian days for observation 3 from obs 2(T3-T2)
                r2mag (float): the magnitude of r2
                r2dot (list): the velocity vector 2
                order1 (int): Order of Taylor Series expansion for f and g values for observation 1
                order2 (int): Order of Taylor Series expansion for f and g values for observation 3
                r2 (list): optional parameter, the position vector 2
            Returns:
                lists: [f1,f3], [g1,g3]
        """</span>
        f1,g1=self.fg(tau1,r2mag,r2dot,order1,r2)
        f3,g3=self.fg(tau3,r2mag,r2dot,order2,r2)
        <span class="hljs-keyword">return</span> [f1,f3], [g1,g3]
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDCoef</span>(<span class="hljs-params">self, ra:list, dec:list, R1:list, R2:list, R3:list</span>):</span>
        <span class="hljs-string">""" Gets the D coefficients given the ra and dec for three observations (in radians)
            Args:
                ra (list): the right ascensions for three observations (radians)
                dec (list): the declinations for three observations (radians)
                R1 (list): the sun vector for observation 1
                R2 (list): the sun vector for observation 2
                R3 (list): the sun vector for observation 3
            Returns:
                list: [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], [rhohat1, rhohat2, rhohat3]
        """</span>
        ra1,ra2,ra3=ra[<span class="hljs-number">0</span>],ra[<span class="hljs-number">1</span>],ra[<span class="hljs-number">2</span>]
        dec1,dec2,dec3=dec[<span class="hljs-number">0</span>],dec[<span class="hljs-number">1</span>],dec[<span class="hljs-number">2</span>]
        
        rhohat1=np.array([np.cos(ra1)*np.cos(dec1), np.sin(ra1)*np.cos(dec1), np.sin(dec1)])
        rhohat2=np.array([np.cos(ra2)*np.cos(dec2), np.sin(ra2)*np.cos(dec2), np.sin(dec2)])
        rhohat3=np.array([np.cos(ra3)*np.cos(dec3), np.sin(ra3)*np.cos(dec3), np.sin(dec3)])
        
        D0=dot(rhohat1, cross(rhohat2,rhohat3))
        D11=dot(cross(R1, rhohat2),rhohat3)
        D12=dot(cross(R2, rhohat2),rhohat3)
        D13=dot(cross(R3, rhohat2),rhohat3)
        
        D21=dot(cross(rhohat1,R1), rhohat3)
        D22=dot(cross(rhohat1,R2), rhohat3)
        D23=dot(cross(rhohat1,R3), rhohat3)
        
        D31=dot(rhohat1, cross(rhohat2,R1))
        D32=dot(rhohat1, cross(rhohat2,R2))
        D33=dot(rhohat1, cross(rhohat2,R3))
     
        <span class="hljs-keyword">return</span> [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], np.array([rhohat1, rhohat2, rhohat3])
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGenData</span>(<span class="hljs-params">self,loaded:bool,selTime:list=[],selDate:list=[],ra:list=[],dec:list=[]</span>):</span>
        <span class="hljs-string">""" Generates the data for Method of Gauss calculations
            Args:
                loaded (bool): True if data is already loaded
                selTime (list): list of chosen times (in Julian days) for observations 1,2,3
                selDate (list): list of chosen datesfor observations 1,2,3
                ra (list): list of right ascensions
                dec (list): list of declinations
            Returns:
                lists: ra, dec, R1, R2, R3, taus, ts (original times in Julian days)
        """</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> loaded:
            self.data.getInput(self.inputFile) <span class="hljs-comment"># formats and generates info</span>
            <span class="hljs-comment"># generate data</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(selTime==[]): <span class="hljs-comment"># using Julian day times</span>
                <span class="hljs-keyword">if</span> ra==[] <span class="hljs-keyword">and</span> dec==[]:
                    ra,dec=[],[]
                    <span class="hljs-keyword">for</span> time <span class="hljs-keyword">in</span> selTime:
                        r,d=self.data.getRADECInput(time=time)
                        ra.append(np.deg2rad(r))
                        dec.append(np.deg2rad(d))
                R1=self.data.getSunInput(time=selTime[<span class="hljs-number">0</span>])
                R2=self.data.getSunInput(time=selTime[<span class="hljs-number">1</span>])
                R3=self.data.getSunInput(time=selTime[<span class="hljs-number">2</span>])
                <span class="hljs-comment"># calculate the taus</span>
                t1,t2,t3=selTime[<span class="hljs-number">0</span>],selTime[<span class="hljs-number">1</span>],selTime[<span class="hljs-number">2</span>]
                ts=[t1,t2,t3]
                T1=t1-t2
                T3=t3-t2
                T=t3-t1
                taus = [T1,T3,T] <span class="hljs-comment"># in Gaussian days</span>

            <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(selDate==[]):
                <span class="hljs-keyword">if</span> ra==[] <span class="hljs-keyword">and</span> dec==[]:
                    ra,dec=[],[]
                    <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> selDate:
                        r,d=self.data.getRADECInput(date=date)
                        ra.append(np.deg2rad(r))
                        dec.append(np.deg2rad(d))
                R1=self.data.getSunInput(date=selDate[<span class="hljs-number">0</span>])
                R2=self.data.getSunInput(date=selDate[<span class="hljs-number">1</span>])
                R3=self.data.getSunInput(date=selDate[<span class="hljs-number">2</span>])
                <span class="hljs-comment"># calculate the taus given the dates</span>
                t1,t2,t3=self.data.getJDTime(selDate[<span class="hljs-number">0</span>]),self.data.getJDTime(selDate[<span class="hljs-number">1</span>]),self.data.getJDTime(selDate[<span class="hljs-number">2</span>])
                ts=[t1,t2,t3]
                T1=t1-t2
                T3=t3-t2
                T=t3-t1
                taus = [T1*self.k,T3*self.k,T*self.k]

            <span class="hljs-keyword">else</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No data given"</span>)
            self.loadedValues=[ra,dec,np.array(R1),np.array(R2),np.array(R3),taus,np.array(ts)]
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(ra==[] <span class="hljs-keyword">and</span> dec==[]):
                self.loadedValues[<span class="hljs-number">0</span>] = ra
                self.loadedValues[<span class="hljs-number">1</span>] = dec
        <span class="hljs-keyword">return</span> self.loadedValues
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGCalcRhos</span>(<span class="hljs-params">self, rhohats:list, coefD:list, fvals:list, gvals:list</span>):</span>
        <span class="hljs-string">""" Generates the rhos (and their magnitudes) for Method of Gauss calculations
            Args:
                rhohats (list): the direction vectors for rhos
                coefD (list): the D coefficients
                fvals (list): the f values
                gvals (list): the g values
            Returns:
                lists: rhos, rhomags
        """</span>
        f1,f3=fvals
        g1,g3=gvals
        D0,D11,D12,D13,D21,D22,D23,D31,D32,D33=coefD
        C1=g3/(f1*g3-g1*f3)
        C2=<span class="hljs-number">-1</span>
        C3=-g1/(f1*g3-g1*f3)
        rho1=(C1*D11+C2*D12+C3*D13)/(C1*D0)
        rho2=(C1*D21+C2*D22+C3*D23)/(C2*D0)
        rho3=(C1*D31+C2*D32+C3*D33)/(C3*D0)
        rhomags=np.array([rho1,rho2,rho3])
        rhos=np.array([rhohats[<span class="hljs-number">0</span>]*rho1, rhohats[<span class="hljs-number">1</span>]*rho2, rhohats[<span class="hljs-number">2</span>]*rho3])
        <span class="hljs-keyword">return</span> rhos, rhomags
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGCalcPos</span>(<span class="hljs-params">self, rhos:list, Rs:list</span>)-&gt;list:</span>    
        <span class="hljs-string">""" Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations
            Args:
                rhos (list): the position from Earth vectors
                Rs (list): the position from Sun vectors
            Returns:
                lists: rs
        """</span>
        <span class="hljs-keyword">return</span> rhos-Rs
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGetErr</span>(<span class="hljs-params">self, prev:list, cur:list, tolerance:float</span>)-&gt;bool:</span>
        <span class="hljs-string">""" Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations
            Args:
                prev (list): previous r vector
                cur (list): the newly calculated r vector
                tolerance (float): the tolerance
            Returns:
                bool: True if error is good, False if no within tolerance
        """</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(prev)):
            <span class="hljs-keyword">if</span> abs(prev[i]-cur[i])&gt;tolerance: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGetAdjustedTaus</span>(<span class="hljs-params">self, origt:list, rhomags:float</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns adjusted taus for Method of Gauss calculations
            Args:
                origt (list): original observation times in Julian days
                rhomags (list): the magnitude of the rho vectors
            Returns:
                list: the adjusted taus
        """</span>
        ts=np.copy(origt)-rhomags/self.cAU
        t1,t2,t3=ts
        <span class="hljs-keyword">return</span> [(t1-t2)*self.k,(t3-t2)*self.k,(t3-t1)*self.k]
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoG</span>(<span class="hljs-params">self,selTime:list=[],selDate:list=[],override:bool=True,ra:list=[],dec:list=[],loaded:bool=False</span>):</span>
        <span class="hljs-string">""" Performs Method of Gauss calculations to determine orbital elements
            Args:
                selTime (list): list of chosen times (in Julian days) for observations 1,2,3
                selDate (list): list of chosen datesfor observations 1,2,3
                override (bool): boolean, True if override info
                ra (list): optional list of right ascensions
                dec (list): optional list of declinations
                loaded (bool): optional, True if all data is already loaded (speeds up run time)
            Returns:
                None
        """</span>
        <span class="hljs-comment"># generate data</span>
        ra,dec,R1,R2,R3,taus,ts=self.MoGGenData(<span class="hljs-literal">False</span>,selTime,selDate,ra,dec)
        
        <span class="hljs-comment"># calculate the initial estimate for r2 DONE</span>
        coefD,rhohats=self.getDCoef(ra, dec, R1, R2, R3)

        SELcoefD=[coefD[<span class="hljs-number">0</span>],coefD[<span class="hljs-number">4</span>],coefD[<span class="hljs-number">5</span>],coefD[<span class="hljs-number">6</span>]] <span class="hljs-comment"># [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33] -&gt; [D0,D21,D22,D23]</span>
        r2MagGuesses,rhoMagGuesses=self.SEL(taus, R2, rhohats[<span class="hljs-number">1</span>], SELcoefD)
        
        results=[]
        
        <span class="hljs-comment"># calculate the f and g values to second order</span>
        <span class="hljs-keyword">for</span> r2mag <span class="hljs-keyword">in</span> r2MagGuesses:
            <span class="hljs-comment"># initial guesses</span>
            fvals,gvals=self.getFGVals(taus[<span class="hljs-number">0</span>], taus[<span class="hljs-number">1</span>], r2mag, [], <span class="hljs-number">2</span>, <span class="hljs-number">2</span>) <span class="hljs-comment"># using r2mag</span>
            rhos,rhomags=self.MoGCalcRhos(rhohats, coefD, fvals, gvals)
            rs=self.MoGCalcPos(rhos, np.array([R1,R2,R3]))
   
            <span class="hljs-comment"># calculate the central velocity vector</span>
            f1,f3=fvals
            g1,g3=gvals
            r2dot = (-f3/(-f3*g1+g3*f1))*rs[<span class="hljs-number">0</span>] + (f1/(f1*g3-f3*g1))*rs[<span class="hljs-number">2</span>]
            counter=<span class="hljs-number">0</span>
            timedOut=<span class="hljs-literal">True</span>
            timeout=time.time() + <span class="hljs-number">60</span>*<span class="hljs-number">3</span> <span class="hljs-comment"># timeout after 3 minutes</span>
            
            <span class="hljs-keyword">while</span> counter&lt;<span class="hljs-number">5000</span> <span class="hljs-keyword">and</span> time.time()&lt;timeout: <span class="hljs-comment"># timeout</span>
                prev=rs[<span class="hljs-number">1</span>]
                
                <span class="hljs-comment"># time adjustment</span>
                newtaus=self.MoGGetAdjustedTaus(ts, rhomags)
                
                fvals,gvals=self.getFGVals(newtaus[<span class="hljs-number">0</span>], newtaus[<span class="hljs-number">1</span>], r2mag, r2dot, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, rs[<span class="hljs-number">1</span>]) <span class="hljs-comment"># using r2mag</span>
                rhos,rhomags=self.MoGCalcRhos(rhohats, coefD, fvals, gvals)
                rs=self.MoGCalcPos(rhos, np.array([R1,R2,R3]))
                
                f1,f3=fvals
                g1,g3=gvals
                r2dot = (-f3/(-f3*g1+g3*f1))*rs[<span class="hljs-number">0</span>] + (f1/(f1*g3-f3*g1))*rs[<span class="hljs-number">2</span>]
                
                counter+=<span class="hljs-number">1</span>
                
                <span class="hljs-keyword">if</span> (self.MoGGetErr(prev, rs[<span class="hljs-number">1</span>], <span class="hljs-number">1e-23</span>)): 
                    timedOut=<span class="hljs-literal">False</span>
                    <span class="hljs-keyword">break</span>
            
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> timedOut:
                <span class="hljs-comment"># rotate around x axis to get to ecliptic</span>
                r2=rotX(np.array(rs[<span class="hljs-number">1</span>]),-self.eps)
                r2dot=rotX(r2dot,-self.eps)
                rho2=rotX(rhos[<span class="hljs-number">1</span>],-self.eps)
                results.append([r2, r2dot, rho2]) <span class="hljs-comment"># position and velocity</span>
        
        resIndex=<span class="hljs-number">0</span>
        <span class="hljs-keyword">if</span> len(results)&gt;<span class="hljs-number">1</span>: <span class="hljs-comment"># get user input to choose which result to use </span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(results)):
                print(<span class="hljs-string">"Result"</span>,str(i)+<span class="hljs-string">":"</span>)
                print(<span class="hljs-string">"\tPos from Sun:"</span>,r2,<span class="hljs-string">"\n\tVel:"</span>,r2dot,<span class="hljs-string">"\n\tPos from Earth:"</span>,rho2,<span class="hljs-string">"\n"</span>)

            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                <span class="hljs-keyword">try</span>: 
                    resIndex=int(input(<span class="hljs-string">"Choose which result to use (int): "</span>))
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(<span class="hljs-number">0</span>&lt;=resIndex&lt;len(results)): resIndex/=<span class="hljs-number">0</span> <span class="hljs-comment"># throw an error</span>
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">except</span>:
                    print(<span class="hljs-string">"Enter a valid integer"</span>)
        
        <span class="hljs-keyword">if</span> len(results)==<span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
            
        <span class="hljs-comment"># get final answers</span>
        pos,vel,rho=results[resIndex]
        
        <span class="hljs-keyword">if</span> override:
            self.genElements(pos,np.array(vel)*(<span class="hljs-number">2</span>*math.pi)/<span class="hljs-number">365.2568983</span>,ts[<span class="hljs-number">1</span>])
            self.vel = vel
            self.pos = pos
            self.rho = rho
        <span class="hljs-keyword">else</span>:
            a,e,i,o,v,w,T,M=self.genElements(pos,np.array(vel)*(<span class="hljs-number">2</span>*math.pi)/<span class="hljs-number">365.2568983</span>,ts[<span class="hljs-number">1</span>], update=<span class="hljs-literal">False</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>, a,e,i,o,w,T
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getError</span>(<span class="hljs-params">self, results:list</span>):</span>
        <span class="hljs-string">""" Prints error and results from orbital elements determination after Method of Gauss calculations
            Args:
                results (list): [e,0,i,o,w,T,0,0,0,a]
            Returns:
                None
        """</span>
        <span class="hljs-comment"># adjust time of perihelion from results to match period of calculated time of perihelion</span>
        period=results[<span class="hljs-number">9</span>]**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>)*self.toGaussian
        results[<span class="hljs-number">5</span>]=self.time-((self.time-results[<span class="hljs-number">5</span>])%period) <span class="hljs-comment"># subtract the change in time since the last perihelion from the obs 2 time </span>
        self.od.printError(results)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportResults</span>(<span class="hljs-params">self, time:float, date:str, fileName:str</span>):</span>
        <span class="hljs-string">""" Exports results to a file
            Args:
                time (float): time in Julian days for the Mean Anomaly
                date (str): date for Mean Anomaly
                fileName (str): the exported file name
            Returns:
                None
        """</span>
        M=self.od.getTimeMeanAnomaly(time, date)
        self.data.printResults(fileName, self.pos, self.vel/self.toGaussian*(<span class="hljs-number">2</span>*math.pi), self.rho, self.a, self.e, self.i, self.o, self.T, self.w, date, M)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genEphemeris</span>(<span class="hljs-params">self, inputFile:str, outputFile:str</span>):</span>
        <span class="hljs-string">""" Generates ephemeris for all times in a given sun position file. Exports to an output file
            Args:
                inputFile (str): input file name
                outputFile (str): output file name
            Returns:
                None
        """</span>
        results=[]
        <span class="hljs-keyword">for</span> time,date,R <span class="hljs-keyword">in</span> self.data.getAllSunPos(inputFile):
            ra,dec=self.ephemeris(time, date, sunPos=R)
            ra=str(ra[<span class="hljs-number">0</span>]) + <span class="hljs-string">" "</span> + str(ra[<span class="hljs-number">1</span>]) + <span class="hljs-string">" "</span> + str(ra[<span class="hljs-number">2</span>])
            <span class="hljs-keyword">if</span> dec[<span class="hljs-number">0</span>]&lt;<span class="hljs-number">0</span>: sign=<span class="hljs-string">"-"</span>
            <span class="hljs-keyword">else</span>: sign=<span class="hljs-string">"+"</span>
            dec=sign+str(dec[<span class="hljs-number">0</span>]) + <span class="hljs-string">" "</span> + str(dec[<span class="hljs-number">1</span>]) + <span class="hljs-string">" "</span> + str(dec[<span class="hljs-number">2</span>])
            results.append([date,str(time),ra,dec])
        
        self.data.exportEphemeris(outputFile, results)
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">monteCarlo</span>(<span class="hljs-params">self, n:int, files:str, outputFile:str, results:list, selTime:list=[], selDate:list=[]</span>):</span>
        <span class="hljs-string">""" Using uncertainty, runs through Method of Gauss n-times to generate orbital elements. 
            Outputs to file.
            Args:
                n (int): number of times to run monteCarlo
                files (list): list of fits file names
                outputFile (str): the output file name
                results (list): the actual values for error analysis [a, e, i, o, w, T]
                selTime (list): optional; the selected times for which to run Method of Gauss
                selDate (list): optional; the selected dates for which to run Method of Gauss
            Returns:
                None
        """</span>
        rmsDec,rmsRA=[],[]
        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:
            data = fits.open(file)[<span class="hljs-number">1</span>].data
            
            fieldDec, indexDec = data.field_dec[:], data.index_dec[:]
            fieldRA, indexRA = data.field_ra[:], data.index_ra[:]
            
            dec = np.sqrt(<span class="hljs-number">1</span>/int(fieldDec.shape[<span class="hljs-number">0</span>]) * sum([(indexDec[i]-fieldDec[i])**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(fieldDec.shape[<span class="hljs-number">0</span>]))]))
            ra = np.sqrt(<span class="hljs-number">1</span>/int(fieldRA.shape[<span class="hljs-number">0</span>]) * sum([(indexRA[i]-fieldRA[i])**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(fieldDec.shape[<span class="hljs-number">0</span>]))]))
            
            rmsDec.append(dec)
            rmsRA.append(ra)
            
            
        ora, odec, R1, R2, R3, taus, ts = self.MoGGenData(<span class="hljs-literal">False</span>,selTime=selTime,selDate=selDate)
        
        vals=[]
        num=<span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> trial <span class="hljs-keyword">in</span> range(n):
            newdec = [np.deg2rad(np.random.normal()*rmsDec[i] + np.rad2deg(odec[i])) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]
            newra = [np.deg2rad(np.random.normal()*rmsRA[i] + np.rad2deg(ora[i])) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]
            works, a, e, i, o, w, T=self.MoG(selTime=selTime,selDate=selDate,override=<span class="hljs-literal">False</span>,ra=newra,dec=newdec,loaded=<span class="hljs-literal">True</span>)
            <span class="hljs-keyword">if</span> works:
                num+=<span class="hljs-number">1</span>
                calcVals=[num,a,e,i,o,w,T] <span class="hljs-comment"># sus</span>
                vals.append(calcVals)
                vals.append(calcVals)
                
        <span class="hljs-comment"># adjust time of perihelion for results</span>
        <span class="hljs-comment"># for time of perihelion, need to adjust to be close to the given observation time</span>
        <span class="hljs-comment"># because our calculated time of perihelion is closest to the given observation time</span>
        period=results[<span class="hljs-number">0</span>]**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>)*self.toGaussian
        results[<span class="hljs-number">5</span>]=ts[<span class="hljs-number">1</span>]-((ts[<span class="hljs-number">1</span>]-results[<span class="hljs-number">5</span>])%period) <span class="hljs-comment"># subtract the change in time since the last perihelion from the obs 2 time </span>
                
            
        <span class="hljs-comment"># write to output file</span>
        self.data.exportMonteCarlo(outputFile, vals.copy(), results)
        
        <span class="hljs-comment"># histograms</span>
        labels=[<span class="hljs-string">""</span>,<span class="hljs-string">"Semi-Major Axis"</span>,<span class="hljs-string">"Eccentricity"</span>, <span class="hljs-string">"Inclination"</span>, <span class="hljs-string">"Longitude of Ascending Node"</span>, <span class="hljs-string">"Argument of Perihelion"</span>, <span class="hljs-string">"Time of Perihelion Passage"</span>]
        xlabels=[<span class="hljs-string">"AU"</span>,<span class="hljs-string">"Value"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Julian Day Number"</span>]
        custom_lines = [Line2D([<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>], color=<span class="hljs-string">'black'</span>, linestyle=<span class="hljs-string">'dashed'</span>,lw=<span class="hljs-number">1</span>), Line2D([<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>], color=<span class="hljs-string">'blue'</span>, lw=<span class="hljs-number">1</span>)]
  
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">5</span>):
            mean=sum([vals[i][<span class="hljs-number">1</span>+j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals)
            sdom=np.sqrt(sum([(vals[i][j+<span class="hljs-number">1</span>]-mean)**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals))
            
            plt.hist([vals[i][<span class="hljs-number">1</span>+j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))],bins=<span class="hljs-number">20</span>)
            plt.axvline(results[j], color=<span class="hljs-string">'k'</span>, linestyle=<span class="hljs-string">'dashed'</span>, linewidth=<span class="hljs-number">1</span>)
            plt.axvline(mean, color=<span class="hljs-string">'b'</span>, linewidth=<span class="hljs-number">1</span>)
            plt.title(labels[<span class="hljs-number">1</span>+j])
            plt.legend(custom_lines, [<span class="hljs-string">'True Value'</span>, <span class="hljs-string">'Mean'</span>])
            plt.xlabel(xlabels[j])
            plt.ylabel(<span class="hljs-string">"Frequency"</span>)
            plt.show()

            print(labels[j+<span class="hljs-number">1</span>]+<span class="hljs-string">": \n\tmean: "</span>+str(mean)+<span class="hljs-string">"\n\terror: "</span> + str(error(results[j],mean)) + <span class="hljs-string">"\n\tstandard deviation of mean: "</span> + str(sdom) + <span class="hljs-string">"\n"</span>)

        <span class="hljs-comment"># special case for time of perihelion</span>
        mean=sum([vals[i][<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals)
        sdom=np.sqrt(sum([(vals[i][<span class="hljs-number">6</span>]-mean)**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals))
            
        plt.hist([vals[i][<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))],bins=<span class="hljs-number">20</span>)
        plt.axvline(results[<span class="hljs-number">5</span>], color=<span class="hljs-string">'k'</span>, linestyle=<span class="hljs-string">'dashed'</span>, linewidth=<span class="hljs-number">1</span>)
        plt.axvline(mean, color=<span class="hljs-string">'b'</span>, linewidth=<span class="hljs-number">1</span>)
        plt.title(labels[<span class="hljs-number">6</span>])
        plt.legend(custom_lines, [<span class="hljs-string">'True Value'</span>, <span class="hljs-string">'Mean'</span>])
        plt.xlabel(xlabels[<span class="hljs-number">5</span>])
        plt.ylabel(<span class="hljs-string">"Frequency"</span>)
        plt.show()

        print(labels[<span class="hljs-number">6</span>]+<span class="hljs-string">": \n\tmean: "</span>+str(mean)+ <span class="hljs-string">"\n\terror: "</span> + str(error(results[<span class="hljs-number">5</span>],mean)) + <span class="hljs-string">"\n\tstandard deviation of mean: "</span> + str(sdom) + <span class="hljs-string">"\n"</span>)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="odlib.OD.MoG"><code class="name flex">
<span>def <span class="ident">MoG</span></span>(<span>self, 
selTime:&nbsp;list&nbsp;=&nbsp;[], selDate:&nbsp;list&nbsp;=&nbsp;[], 
override:&nbsp;bool&nbsp;=&nbsp;True, ra:&nbsp;list&nbsp;=&nbsp;[], 
dec:&nbsp;list&nbsp;=&nbsp;[], loaded:&nbsp;bool&nbsp;=&nbsp;False)</span>
</code></dt>
<dd>
<div class="desc"><p>Performs Method of Gauss calculations to determine orbital elements</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>selTime</code></strong> : <code>list</code></dt>
<dd>list of chosen times (in Julian days) for observations 1,2,3</dd>
<dt><strong><code>selDate</code></strong> : <code>list</code></dt>
<dd>list of chosen datesfor observations 1,2,3</dd>
<dt><strong><code>override</code></strong> : <code>bool</code></dt>
<dd>boolean, True if override info</dd>
<dt><strong><code>ra</code></strong> : <code>list</code></dt>
<dd>optional list of right ascensions</dd>
<dt><strong><code>dec</code></strong> : <code>list</code></dt>
<dd>optional list of declinations</dd>
<dt><strong><code>loaded</code></strong> : <code>bool</code></dt>
<dd>optional, True if all data is already loaded (speeds up run time)</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoG</span>(<span class="hljs-params">self,selTime:list=[],selDate:list=[],override:bool=True,ra:list=[],dec:list=[],loaded:bool=False</span>):</span>
    <span class="hljs-string">""" Performs Method of Gauss calculations to determine orbital elements
        Args:
            selTime (list): list of chosen times (in Julian days) for observations 1,2,3
            selDate (list): list of chosen datesfor observations 1,2,3
            override (bool): boolean, True if override info
            ra (list): optional list of right ascensions
            dec (list): optional list of declinations
            loaded (bool): optional, True if all data is already loaded (speeds up run time)
        Returns:
            None
    """</span>
    <span class="hljs-comment"># generate data</span>
    ra,dec,R1,R2,R3,taus,ts=self.MoGGenData(<span class="hljs-literal">False</span>,selTime,selDate,ra,dec)
    
    <span class="hljs-comment"># calculate the initial estimate for r2 DONE</span>
    coefD,rhohats=self.getDCoef(ra, dec, R1, R2, R3)

    SELcoefD=[coefD[<span class="hljs-number">0</span>],coefD[<span class="hljs-number">4</span>],coefD[<span class="hljs-number">5</span>],coefD[<span class="hljs-number">6</span>]] <span class="hljs-comment"># [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33] -&gt; [D0,D21,D22,D23]</span>
    r2MagGuesses,rhoMagGuesses=self.SEL(taus, R2, rhohats[<span class="hljs-number">1</span>], SELcoefD)
    
    results=[]
    
    <span class="hljs-comment"># calculate the f and g values to second order</span>
    <span class="hljs-keyword">for</span> r2mag <span class="hljs-keyword">in</span> r2MagGuesses:
        <span class="hljs-comment"># initial guesses</span>
        fvals,gvals=self.getFGVals(taus[<span class="hljs-number">0</span>], taus[<span class="hljs-number">1</span>], r2mag, [], <span class="hljs-number">2</span>, <span class="hljs-number">2</span>) <span class="hljs-comment"># using r2mag</span>
        rhos,rhomags=self.MoGCalcRhos(rhohats, coefD, fvals, gvals)
        rs=self.MoGCalcPos(rhos, np.array([R1,R2,R3]))

        <span class="hljs-comment"># calculate the central velocity vector</span>
        f1,f3=fvals
        g1,g3=gvals
        r2dot = (-f3/(-f3*g1+g3*f1))*rs[<span class="hljs-number">0</span>] + (f1/(f1*g3-f3*g1))*rs[<span class="hljs-number">2</span>]
        counter=<span class="hljs-number">0</span>
        timedOut=<span class="hljs-literal">True</span>
        timeout=time.time() + <span class="hljs-number">60</span>*<span class="hljs-number">3</span> <span class="hljs-comment"># timeout after 3 minutes</span>
        
        <span class="hljs-keyword">while</span> counter&lt;<span class="hljs-number">5000</span> <span class="hljs-keyword">and</span> time.time()&lt;timeout: <span class="hljs-comment"># timeout</span>
            prev=rs[<span class="hljs-number">1</span>]
            
            <span class="hljs-comment"># time adjustment</span>
            newtaus=self.MoGGetAdjustedTaus(ts, rhomags)
            
            fvals,gvals=self.getFGVals(newtaus[<span class="hljs-number">0</span>], newtaus[<span class="hljs-number">1</span>], r2mag, r2dot, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, rs[<span class="hljs-number">1</span>]) <span class="hljs-comment"># using r2mag</span>
            rhos,rhomags=self.MoGCalcRhos(rhohats, coefD, fvals, gvals)
            rs=self.MoGCalcPos(rhos, np.array([R1,R2,R3]))
            
            f1,f3=fvals
            g1,g3=gvals
            r2dot = (-f3/(-f3*g1+g3*f1))*rs[<span class="hljs-number">0</span>] + (f1/(f1*g3-f3*g1))*rs[<span class="hljs-number">2</span>]
            
            counter+=<span class="hljs-number">1</span>
            
            <span class="hljs-keyword">if</span> (self.MoGGetErr(prev, rs[<span class="hljs-number">1</span>], <span class="hljs-number">1e-23</span>)): 
                timedOut=<span class="hljs-literal">False</span>
                <span class="hljs-keyword">break</span>
        
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> timedOut:
            <span class="hljs-comment"># rotate around x axis to get to ecliptic</span>
            r2=rotX(np.array(rs[<span class="hljs-number">1</span>]),-self.eps)
            r2dot=rotX(r2dot,-self.eps)
            rho2=rotX(rhos[<span class="hljs-number">1</span>],-self.eps)
            results.append([r2, r2dot, rho2]) <span class="hljs-comment"># position and velocity</span>
    
    resIndex=<span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> len(results)&gt;<span class="hljs-number">1</span>: <span class="hljs-comment"># get user input to choose which result to use </span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(results)):
            print(<span class="hljs-string">"Result"</span>,str(i)+<span class="hljs-string">":"</span>)
            print(<span class="hljs-string">"\tPos from Sun:"</span>,r2,<span class="hljs-string">"\n\tVel:"</span>,r2dot,<span class="hljs-string">"\n\tPos from Earth:"</span>,rho2,<span class="hljs-string">"\n"</span>)

        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            <span class="hljs-keyword">try</span>: 
                resIndex=int(input(<span class="hljs-string">"Choose which result to use (int): "</span>))
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(<span class="hljs-number">0</span>&lt;=resIndex&lt;len(results)): resIndex/=<span class="hljs-number">0</span> <span class="hljs-comment"># throw an error</span>
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">except</span>:
                print(<span class="hljs-string">"Enter a valid integer"</span>)
    
    <span class="hljs-keyword">if</span> len(results)==<span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
        
    <span class="hljs-comment"># get final answers</span>
    pos,vel,rho=results[resIndex]
    
    <span class="hljs-keyword">if</span> override:
        self.genElements(pos,np.array(vel)*(<span class="hljs-number">2</span>*math.pi)/<span class="hljs-number">365.2568983</span>,ts[<span class="hljs-number">1</span>])
        self.vel = vel
        self.pos = pos
        self.rho = rho
    <span class="hljs-keyword">else</span>:
        a,e,i,o,v,w,T,M=self.genElements(pos,np.array(vel)*(<span class="hljs-number">2</span>*math.pi)/<span class="hljs-number">365.2568983</span>,ts[<span class="hljs-number">1</span>], update=<span class="hljs-literal">False</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>, a,e,i,o,w,T</code></pre>
</details>
</dd>
<dt id="odlib.OD.MoGCalcPos"><code class="name flex">
<span>def <span class="ident">MoGCalcPos</span></span>(<span>self, rhos:&nbsp;list, Rs:&nbsp;list) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rhos</code></strong> : <code>list</code></dt>
<dd>the position from Earth vectors</dd>
<dt><strong><code>Rs</code></strong> : <code>list</code></dt>
<dd>the position from Sun vectors</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>rs</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGCalcPos</span>(<span class="hljs-params">self, rhos:list, Rs:list</span>)-&gt;list:</span>    
    <span class="hljs-string">""" Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations
        Args:
            rhos (list): the position from Earth vectors
            Rs (list): the position from Sun vectors
        Returns:
            lists: rs
    """</span>
    <span class="hljs-keyword">return</span> rhos-Rs</code></pre>
</details>
</dd>
<dt id="odlib.OD.MoGCalcRhos"><code class="name flex">
<span>def <span class="ident">MoGCalcRhos</span></span>(<span>self, rhohats:&nbsp;list, coefD:&nbsp;list, fvals:&nbsp;list, gvals:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Generates the rhos (and their magnitudes) for Method of Gauss calculations</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rhohats</code></strong> : <code>list</code></dt>
<dd>the direction vectors for rhos</dd>
<dt><strong><code>coefD</code></strong> : <code>list</code></dt>
<dd>the D coefficients</dd>
<dt><strong><code>fvals</code></strong> : <code>list</code></dt>
<dd>the f values</dd>
<dt><strong><code>gvals</code></strong> : <code>list</code></dt>
<dd>the g values</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>rhos, rhomags</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGCalcRhos</span>(<span class="hljs-params">self, rhohats:list, coefD:list, fvals:list, gvals:list</span>):</span>
    <span class="hljs-string">""" Generates the rhos (and their magnitudes) for Method of Gauss calculations
        Args:
            rhohats (list): the direction vectors for rhos
            coefD (list): the D coefficients
            fvals (list): the f values
            gvals (list): the g values
        Returns:
            lists: rhos, rhomags
    """</span>
    f1,f3=fvals
    g1,g3=gvals
    D0,D11,D12,D13,D21,D22,D23,D31,D32,D33=coefD
    C1=g3/(f1*g3-g1*f3)
    C2=<span class="hljs-number">-1</span>
    C3=-g1/(f1*g3-g1*f3)
    rho1=(C1*D11+C2*D12+C3*D13)/(C1*D0)
    rho2=(C1*D21+C2*D22+C3*D23)/(C2*D0)
    rho3=(C1*D31+C2*D32+C3*D33)/(C3*D0)
    rhomags=np.array([rho1,rho2,rho3])
    rhos=np.array([rhohats[<span class="hljs-number">0</span>]*rho1, rhohats[<span class="hljs-number">1</span>]*rho2, rhohats[<span class="hljs-number">2</span>]*rho3])
    <span class="hljs-keyword">return</span> rhos, rhomags</code></pre>
</details>
</dd>
<dt id="odlib.OD.MoGGenData"><code class="name flex">
<span>def <span class="ident">MoGGenData</span></span>(<span>self, 
loaded:&nbsp;bool, selTime:&nbsp;list&nbsp;=&nbsp;[], 
selDate:&nbsp;list&nbsp;=&nbsp;[], ra:&nbsp;list&nbsp;=&nbsp;[], 
dec:&nbsp;list&nbsp;=&nbsp;[])</span>
</code></dt>
<dd>
<div class="desc"><p>Generates the data for Method of Gauss calculations</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>loaded</code></strong> : <code>bool</code></dt>
<dd>True if data is already loaded</dd>
<dt><strong><code>selTime</code></strong> : <code>list</code></dt>
<dd>list of chosen times (in Julian days) for observations 1,2,3</dd>
<dt><strong><code>selDate</code></strong> : <code>list</code></dt>
<dd>list of chosen datesfor observations 1,2,3</dd>
<dt><strong><code>ra</code></strong> : <code>list</code></dt>
<dd>list of right ascensions</dd>
<dt><strong><code>dec</code></strong> : <code>list</code></dt>
<dd>list of declinations</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>ra, dec, R1, R2, R3, taus, ts (original times in Julian days)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGenData</span>(<span class="hljs-params">self,loaded:bool,selTime:list=[],selDate:list=[],ra:list=[],dec:list=[]</span>):</span>
    <span class="hljs-string">""" Generates the data for Method of Gauss calculations
        Args:
            loaded (bool): True if data is already loaded
            selTime (list): list of chosen times (in Julian days) for observations 1,2,3
            selDate (list): list of chosen datesfor observations 1,2,3
            ra (list): list of right ascensions
            dec (list): list of declinations
        Returns:
            lists: ra, dec, R1, R2, R3, taus, ts (original times in Julian days)
    """</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> loaded:
        self.data.getInput(self.inputFile) <span class="hljs-comment"># formats and generates info</span>
        <span class="hljs-comment"># generate data</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(selTime==[]): <span class="hljs-comment"># using Julian day times</span>
            <span class="hljs-keyword">if</span> ra==[] <span class="hljs-keyword">and</span> dec==[]:
                ra,dec=[],[]
                <span class="hljs-keyword">for</span> time <span class="hljs-keyword">in</span> selTime:
                    r,d=self.data.getRADECInput(time=time)
                    ra.append(np.deg2rad(r))
                    dec.append(np.deg2rad(d))
            R1=self.data.getSunInput(time=selTime[<span class="hljs-number">0</span>])
            R2=self.data.getSunInput(time=selTime[<span class="hljs-number">1</span>])
            R3=self.data.getSunInput(time=selTime[<span class="hljs-number">2</span>])
            <span class="hljs-comment"># calculate the taus</span>
            t1,t2,t3=selTime[<span class="hljs-number">0</span>],selTime[<span class="hljs-number">1</span>],selTime[<span class="hljs-number">2</span>]
            ts=[t1,t2,t3]
            T1=t1-t2
            T3=t3-t2
            T=t3-t1
            taus = [T1,T3,T] <span class="hljs-comment"># in Gaussian days</span>

        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span>(selDate==[]):
            <span class="hljs-keyword">if</span> ra==[] <span class="hljs-keyword">and</span> dec==[]:
                ra,dec=[],[]
                <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> selDate:
                    r,d=self.data.getRADECInput(date=date)
                    ra.append(np.deg2rad(r))
                    dec.append(np.deg2rad(d))
            R1=self.data.getSunInput(date=selDate[<span class="hljs-number">0</span>])
            R2=self.data.getSunInput(date=selDate[<span class="hljs-number">1</span>])
            R3=self.data.getSunInput(date=selDate[<span class="hljs-number">2</span>])
            <span class="hljs-comment"># calculate the taus given the dates</span>
            t1,t2,t3=self.data.getJDTime(selDate[<span class="hljs-number">0</span>]),self.data.getJDTime(selDate[<span class="hljs-number">1</span>]),self.data.getJDTime(selDate[<span class="hljs-number">2</span>])
            ts=[t1,t2,t3]
            T1=t1-t2
            T3=t3-t2
            T=t3-t1
            taus = [T1*self.k,T3*self.k,T*self.k]

        <span class="hljs-keyword">else</span>: <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"No data given"</span>)
        self.loadedValues=[ra,dec,np.array(R1),np.array(R2),np.array(R3),taus,np.array(ts)]
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(ra==[] <span class="hljs-keyword">and</span> dec==[]):
            self.loadedValues[<span class="hljs-number">0</span>] = ra
            self.loadedValues[<span class="hljs-number">1</span>] = dec
    <span class="hljs-keyword">return</span> self.loadedValues</code></pre>
</details>
</dd>
<dt id="odlib.OD.MoGGetAdjustedTaus"><code class="name flex">
<span>def <span class="ident">MoGGetAdjustedTaus</span></span>(<span>self, origt:&nbsp;list, rhomags:&nbsp;float) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Returns adjusted taus for Method of Gauss calculations</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>origt</code></strong> : <code>list</code></dt>
<dd>original observation times in Julian days</dd>
<dt><strong><code>rhomags</code></strong> : <code>list</code></dt>
<dd>the magnitude of the rho vectors</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>the adjusted taus</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGetAdjustedTaus</span>(<span class="hljs-params">self, origt:list, rhomags:float</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns adjusted taus for Method of Gauss calculations
        Args:
            origt (list): original observation times in Julian days
            rhomags (list): the magnitude of the rho vectors
        Returns:
            list: the adjusted taus
    """</span>
    ts=np.copy(origt)-rhomags/self.cAU
    t1,t2,t3=ts
    <span class="hljs-keyword">return</span> [(t1-t2)*self.k,(t3-t2)*self.k,(t3-t1)*self.k]</code></pre>
</details>
</dd>
<dt id="odlib.OD.MoGGetErr"><code class="name flex">
<span>def <span class="ident">MoGGetErr</span></span>(<span>self, prev:&nbsp;list, cur:&nbsp;list, tolerance:&nbsp;float) ‑&gt;&nbsp;bool</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>prev</code></strong> : <code>list</code></dt>
<dd>previous r vector</dd>
<dt><strong><code>cur</code></strong> : <code>list</code></dt>
<dd>the newly calculated r vector</dd>
<dt><strong><code>tolerance</code></strong> : <code>float</code></dt>
<dd>the tolerance</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if error is good, False if no within tolerance</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MoGGetErr</span>(<span class="hljs-params">self, prev:list, cur:list, tolerance:float</span>)-&gt;bool:</span>
    <span class="hljs-string">""" Calculates the r vectors (position of asteroid from sun) for Method of Gauss calculations
        Args:
            prev (list): previous r vector
            cur (list): the newly calculated r vector
            tolerance (float): the tolerance
        Returns:
            bool: True if error is good, False if no within tolerance
    """</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(prev)):
        <span class="hljs-keyword">if</span> abs(prev[i]-cur[i])&gt;tolerance: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span></code></pre>
</details>
</dd>
<dt id="odlib.OD.SEL"><code class="name flex">
<span>def <span class="ident">SEL</span></span>(<span>self, taus:&nbsp;list, sunR2:&nbsp;list, rhohat2:&nbsp;list, coefD:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Scalar Equation of Lagrange to calculate the roots (r) and rhos corresponding to each r</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>taus</code></strong> : <code>list</code></dt>
<dd>a list of floats of taus [T1,T3,T]</dd>
<dt><strong><code>sunR2</code></strong> : <code>list</code></dt>
<dd>a list representing the sun vector R2</dd>
<dt><strong><code>rhohat2</code></strong> : <code>list</code></dt>
<dd>a list representing the rhohat2 vector</dd>
<dt><strong><code>coefD</code></strong> : <code>list</code></dt>
<dd>a list of D coefficients [D0,D21,D22,D23]</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>roots (r's), rhos</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">SEL</span>(<span class="hljs-params">self, taus:list, sunR2:list, rhohat2:list, coefD:list</span>):</span>
    <span class="hljs-string">""" Scalar Equation of Lagrange to calculate the roots (r) and rhos corresponding to each r
        Args:
            taus (list): a list of floats of taus [T1,T3,T]
            sunR2 (list): a list representing the sun vector R2
            rhohat2 (list): a list representing the rhohat2 vector
            coefD (list): a list of D coefficients [D0,D21,D22,D23]
        Returns:
            lists: roots (r's), rhos
    """</span>
    T1,T3,T=taus[<span class="hljs-number">0</span>],taus[<span class="hljs-number">1</span>],taus[<span class="hljs-number">2</span>]
    D0,D21,D22,D23=coefD[<span class="hljs-number">0</span>],coefD[<span class="hljs-number">1</span>],coefD[<span class="hljs-number">2</span>],coefD[<span class="hljs-number">3</span>]
    A1=T3/T
    B1=A1/<span class="hljs-number">6</span>*(T**<span class="hljs-number">2</span>-T3**<span class="hljs-number">2</span>)
    A3=-T1/T
    B3=A3/<span class="hljs-number">6</span>*(T**<span class="hljs-number">2</span>-T1**<span class="hljs-number">2</span>)
    A=(A1*D21-D22+A3*D23)/(-D0)
    B=(B1*D21+B3*D23)/(-D0)
    
    E=<span class="hljs-number">-2</span>*(dot(rhohat2, sunR2))
    F=dot(sunR2,sunR2)
    
    a=-(A**<span class="hljs-number">2</span>+A*E+F)
    b=-self.mu*(<span class="hljs-number">2</span>*A*B+B*E)
    c=-self.mu**<span class="hljs-number">2</span>*B**<span class="hljs-number">2</span>
    
    coef=[c,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,b,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]
    res=poly.polyroots(coef)

    temproots=[]
    <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> res: 
        <span class="hljs-keyword">if</span> np.isreal(val) <span class="hljs-keyword">and</span> np.real(val)&gt;<span class="hljs-number">0</span>: temproots.append(np.real(val))

    temprhos=[A+B/temproots[i]**<span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(temproots))]
    
    <span class="hljs-comment"># ignore pairs where rho magnitude is negative</span>
    roots=[]
    rhos=[]
    <span class="hljs-comment">#print(temproots, temprhos)</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(temproots)):
        <span class="hljs-keyword">if</span> temprhos[i]&gt;<span class="hljs-number">0.0</span>:
            roots.append(temproots[i])
            rhos.append(temprhos[i])
            
    
    
    <span class="hljs-keyword">return</span> roots,rhos</code></pre>
</details>
</dd>
<dt id="odlib.OD.ephemeris"><code class="name flex">
<span>def <span class="ident">ephemeris</span></span>(<span>self, time:&nbsp;float, date:&nbsp;str, file:&nbsp;str&nbsp;=&nbsp;'', sunPos:&nbsp;list&nbsp;=&nbsp;array([], dtype=float64))</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates RA and Dec given time and date, using previously calculated orbital elements</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>time to determine ephemeris for in Julian Days</dd>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>date for which to determine ephemeris</dd>
<dt><strong><code>file</code></strong> : <code>str</code></dt>
<dd>file name for sun positions; optional</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>ra, dec</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ephemeris</span>(<span class="hljs-params">self, time:float, date:str, file:str=<span class="hljs-string">""</span>, sunPos:list=np.array(<span class="hljs-params">[]</span>)</span>):</span>
    <span class="hljs-string">""" Calculates RA and Dec given time and date, using previously calculated orbital elements
        Args:
            time (float): time to determine ephemeris for in Julian Days
            date (str): date for which to determine ephemeris
            file (str): file name for sun positions; optional
        Returns:
            floats: ra, dec
    """</span>
    n=self.k*math.sqrt(self.mu/(self.a**<span class="hljs-number">3</span>))
    M=n*(time-self.T)
    E=newton(<span class="hljs-keyword">lambda</span> E:M - E + self.e*np.sin(E), <span class="hljs-keyword">lambda</span> E: <span class="hljs-number">-1</span>+self.e*np.cos(E), M, <span class="hljs-number">1e-17</span>)
    
    pos=np.array([self.a*math.cos(E)-self.a*self.e, self.a*math.sqrt(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)*math.sin(E), <span class="hljs-number">0</span>])
    
    <span class="hljs-comment"># the four rotations</span>
    pos=rotZX(pos,np.deg2rad(self.w),np.deg2rad(self.i))
    pos=rotZX(pos,np.deg2rad(self.o),self.eps)
    
    <span class="hljs-keyword">if</span> file==<span class="hljs-string">""</span>: <span class="hljs-comment"># no file given, use sunPos</span>
        R=sunPos
    <span class="hljs-keyword">else</span>: R=self.data.getSunPos(date, file)
    <span class="hljs-keyword">if</span> np.array_equal(R, np.array([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>])): <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"Sun Position Not Found in SunPos.txt"</span>)
    rho=pos+R
    rhohat=rho/getMag(rho)
    
    dec=math.asin(rhohat[<span class="hljs-number">2</span>])
    cra=rhohat[<span class="hljs-number">0</span>]/math.cos(dec)
    sra=rhohat[<span class="hljs-number">1</span>]/math.cos(dec)

    ra=getAngle(sra,cra)
    
    dec=np.rad2deg(dec)
    ra=np.rad2deg(ra)
    
    dec=DECdecimalToDMS(dec)
    ra=RAdecimalToHMS(ra)
    
    <span class="hljs-keyword">return</span> ra,dec</code></pre>
</details>
</dd>
<dt id="odlib.OD.exportResults"><code class="name flex">
<span>def <span class="ident">exportResults</span></span>(<span>self, time:&nbsp;float, date:&nbsp;str, fileName:&nbsp;str)</span>
</code></dt>
<dd>
<div class="desc"><p>Exports results to a file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>time in Julian days for the Mean Anomaly</dd>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>date for Mean Anomaly</dd>
<dt><strong><code>fileName</code></strong> : <code>str</code></dt>
<dd>the exported file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exportResults</span>(<span class="hljs-params">self, time:float, date:str, fileName:str</span>):</span>
    <span class="hljs-string">""" Exports results to a file
        Args:
            time (float): time in Julian days for the Mean Anomaly
            date (str): date for Mean Anomaly
            fileName (str): the exported file name
        Returns:
            None
    """</span>
    M=self.od.getTimeMeanAnomaly(time, date)
    self.data.printResults(fileName, self.pos, self.vel/self.toGaussian*(<span class="hljs-number">2</span>*math.pi), self.rho, self.a, self.e, self.i, self.o, self.T, self.w, date, M)</code></pre>
</details>
</dd>
<dt id="odlib.OD.fg"><code class="name flex">
<span>def <span class="ident">fg</span></span>(<span>self, tau:&nbsp;float, r2mag:&nbsp;float, r2dot:&nbsp;list, order:&nbsp;int, r2:&nbsp;list&nbsp;=&nbsp;[])</span>
</code></dt>
<dd>
<div class="desc"><p>Gets the f and g values given one time</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>tau</code></strong> : <code>float</code></dt>
<dd>the time in Julian Days</dd>
<dt><strong><code>r2mag</code></strong> : <code>float</code></dt>
<dd>the magnitude of r2</dd>
<dt><strong><code>r2dot</code></strong> : <code>list</code></dt>
<dd>the velocity vector 2</dd>
<dt><strong><code>order</code></strong> : <code>int</code></dt>
<dd>order of f and g taylor series approximations</dd>
<dt><strong><code>r2</code></strong> : <code>list</code></dt>
<dd>optional parameter, the position vector 2</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>f, g</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fg</span>(<span class="hljs-params">self, tau:float, r2mag:float, r2dot:list, order:int, r2:list=[]</span>):</span>
    <span class="hljs-string">""" Gets the f and g values given one time
        Args:
            tau (float): the time in Julian Days
            r2mag (float): the magnitude of r2
            r2dot (list): the velocity vector 2
            order (int): order of f and g taylor series approximations
            r2 (list): optional parameter, the position vector 2
        Returns:
            floats: f, g
    """</span>
    <span class="hljs-keyword">if</span> len(r2)==<span class="hljs-number">0</span>: u=self.mu/r2mag**<span class="hljs-number">3</span>
    <span class="hljs-keyword">else</span>: u=self.mu/getMag(r2)**<span class="hljs-number">3</span>
    
    f=<span class="hljs-number">1</span><span class="hljs-number">-1</span>/<span class="hljs-number">2</span>*u*tau**<span class="hljs-number">2</span>
    g=tau
    
    <span class="hljs-keyword">if</span> order&gt;=<span class="hljs-number">3</span>:
        z=dot(r2,r2dot)/(dot(r2,r2))
        q=dot(r2dot,r2dot)/(dot(r2,r2))-u
        f+=<span class="hljs-number">1</span>/<span class="hljs-number">2</span>*u*z*tau**<span class="hljs-number">3</span>
        g+=<span class="hljs-number">-1</span>/<span class="hljs-number">6</span>*u*tau**<span class="hljs-number">3</span>
    
    <span class="hljs-keyword">if</span> order&gt;=<span class="hljs-number">4</span>:
        f+=<span class="hljs-number">1</span>/<span class="hljs-number">24</span>*(<span class="hljs-number">3</span>*u*q<span class="hljs-number">-15</span>*u*z**<span class="hljs-number">2</span>+u**<span class="hljs-number">2</span>)*tau**<span class="hljs-number">4</span>
        g+=<span class="hljs-number">1</span>/<span class="hljs-number">4</span>*u*z*tau**<span class="hljs-number">4</span>
    
    <span class="hljs-keyword">return</span> f, g</code></pre>
</details>
</dd>
<dt id="odlib.OD.genElements"><code class="name flex">
<span>def <span class="ident">genElements</span></span>(<span>self, pos:&nbsp;list, vel:&nbsp;list, time:&nbsp;float, update:&nbsp;bool&nbsp;=&nbsp;True)</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the orbital elements given position, velocity, time</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pos</code></strong> : <code>list</code></dt>
<dd>the position vector</dd>
<dt><strong><code>vel</code></strong> : <code>list</code></dt>
<dd>the velocity vector</dd>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>the time in Julian days</dd>
<dt><strong><code>update</code></strong> : <code>bool</code></dt>
<dd>if True keeps the newly calculated orbital elements</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>the orbital elements; a,e,i,o,v,w,T,M</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genElements</span>(<span class="hljs-params">self, pos:list, vel:list, time:float, update:bool=True</span>):</span>
    <span class="hljs-string">""" Calculates and returns the orbital elements given position, velocity, time
        Args:
            pos (list): the position vector
            vel (list): the velocity vector
            time (float): the time in Julian days
            update (bool): if True keeps the newly calculated orbital elements
        Returns:
            floats: the orbital elements; a,e,i,o,v,w,T,M
    """</span>
    <span class="hljs-keyword">if</span> update:
        self.pos,self.vel,self.time=pos,vel,time
        self.od=ODElements(self.pos,self.vel,self.time)
        self.a,self.e,self.i,self.o,self.v,self.w,self.T,self.M = self.od.getElements()
        <span class="hljs-keyword">return</span> self.getElements()
    <span class="hljs-keyword">else</span>:
        od=ODElements(pos,vel,time)
        <span class="hljs-keyword">return</span> od.getElements()</code></pre>
</details>
</dd>
<dt id="odlib.OD.genEphemeris"><code class="name flex">
<span>def <span class="ident">genEphemeris</span></span>(<span>self, inputFile:&nbsp;str, outputFile:&nbsp;str)</span>
</code></dt>
<dd>
<div class="desc"><p>Generates ephemeris for all times in a given sun position file. Exports to an output file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>inputFile</code></strong> : <code>str</code></dt>
<dd>input file name</dd>
<dt><strong><code>outputFile</code></strong> : <code>str</code></dt>
<dd>output file name</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genEphemeris</span>(<span class="hljs-params">self, inputFile:str, outputFile:str</span>):</span>
    <span class="hljs-string">""" Generates ephemeris for all times in a given sun position file. Exports to an output file
        Args:
            inputFile (str): input file name
            outputFile (str): output file name
        Returns:
            None
    """</span>
    results=[]
    <span class="hljs-keyword">for</span> time,date,R <span class="hljs-keyword">in</span> self.data.getAllSunPos(inputFile):
        ra,dec=self.ephemeris(time, date, sunPos=R)
        ra=str(ra[<span class="hljs-number">0</span>]) + <span class="hljs-string">" "</span> + str(ra[<span class="hljs-number">1</span>]) + <span class="hljs-string">" "</span> + str(ra[<span class="hljs-number">2</span>])
        <span class="hljs-keyword">if</span> dec[<span class="hljs-number">0</span>]&lt;<span class="hljs-number">0</span>: sign=<span class="hljs-string">"-"</span>
        <span class="hljs-keyword">else</span>: sign=<span class="hljs-string">"+"</span>
        dec=sign+str(dec[<span class="hljs-number">0</span>]) + <span class="hljs-string">" "</span> + str(dec[<span class="hljs-number">1</span>]) + <span class="hljs-string">" "</span> + str(dec[<span class="hljs-number">2</span>])
        results.append([date,str(time),ra,dec])
    
    self.data.exportEphemeris(outputFile, results)</code></pre>
</details>
</dd>
<dt id="odlib.OD.getDCoef"><code class="name flex">
<span>def <span class="ident">getDCoef</span></span>(<span>self, ra:&nbsp;list, dec:&nbsp;list, R1:&nbsp;list, R2:&nbsp;list, R3:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Gets the D coefficients given the ra and dec for three observations (in radians)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>ra</code></strong> : <code>list</code></dt>
<dd>the right ascensions for three observations (radians)</dd>
<dt><strong><code>dec</code></strong> : <code>list</code></dt>
<dd>the declinations for three observations (radians)</dd>
<dt><strong><code>R1</code></strong> : <code>list</code></dt>
<dd>the sun vector for observation 1</dd>
<dt><strong><code>R2</code></strong> : <code>list</code></dt>
<dd>the sun vector for observation 2</dd>
<dt><strong><code>R3</code></strong> : <code>list</code></dt>
<dd>the sun vector for observation 3</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>[D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], [rhohat1, rhohat2, rhohat3]</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDCoef</span>(<span class="hljs-params">self, ra:list, dec:list, R1:list, R2:list, R3:list</span>):</span>
    <span class="hljs-string">""" Gets the D coefficients given the ra and dec for three observations (in radians)
        Args:
            ra (list): the right ascensions for three observations (radians)
            dec (list): the declinations for three observations (radians)
            R1 (list): the sun vector for observation 1
            R2 (list): the sun vector for observation 2
            R3 (list): the sun vector for observation 3
        Returns:
            list: [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], [rhohat1, rhohat2, rhohat3]
    """</span>
    ra1,ra2,ra3=ra[<span class="hljs-number">0</span>],ra[<span class="hljs-number">1</span>],ra[<span class="hljs-number">2</span>]
    dec1,dec2,dec3=dec[<span class="hljs-number">0</span>],dec[<span class="hljs-number">1</span>],dec[<span class="hljs-number">2</span>]
    
    rhohat1=np.array([np.cos(ra1)*np.cos(dec1), np.sin(ra1)*np.cos(dec1), np.sin(dec1)])
    rhohat2=np.array([np.cos(ra2)*np.cos(dec2), np.sin(ra2)*np.cos(dec2), np.sin(dec2)])
    rhohat3=np.array([np.cos(ra3)*np.cos(dec3), np.sin(ra3)*np.cos(dec3), np.sin(dec3)])
    
    D0=dot(rhohat1, cross(rhohat2,rhohat3))
    D11=dot(cross(R1, rhohat2),rhohat3)
    D12=dot(cross(R2, rhohat2),rhohat3)
    D13=dot(cross(R3, rhohat2),rhohat3)
    
    D21=dot(cross(rhohat1,R1), rhohat3)
    D22=dot(cross(rhohat1,R2), rhohat3)
    D23=dot(cross(rhohat1,R3), rhohat3)
    
    D31=dot(rhohat1, cross(rhohat2,R1))
    D32=dot(rhohat1, cross(rhohat2,R2))
    D33=dot(rhohat1, cross(rhohat2,R3))
 
    <span class="hljs-keyword">return</span> [D0,D11,D12,D13,D21,D22,D23,D31,D32,D33], np.array([rhohat1, rhohat2, rhohat3])</code></pre>
</details>
</dd>
<dt id="odlib.OD.getElements"><code class="name flex">
<span>def <span class="ident">getElements</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the orbital elements (already calculated)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>a,e,i,o,v,w,T,M</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getElements</span>(<span class="hljs-params">self</span>):</span>
    <span class="hljs-string">""" Returns the orbital elements (already calculated)
        Args:
            rad (bool): True if return in radians
        Returns:
            floats: a,e,i,o,v,w,T,M
    """</span>
    <span class="hljs-keyword">return</span> self.a, self.e, self.i, self.o, self.v, self.w, self.T, self.M</code></pre>
</details>
</dd>
<dt id="odlib.OD.getError"><code class="name flex">
<span>def <span class="ident">getError</span></span>(<span>self, results:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Prints error and results from orbital elements determination after Method of Gauss calculations</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>results</code></strong> : <code>list</code></dt>
<dd>[e,0,i,o,w,T,0,0,0,a]</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getError</span>(<span class="hljs-params">self, results:list</span>):</span>
    <span class="hljs-string">""" Prints error and results from orbital elements determination after Method of Gauss calculations
        Args:
            results (list): [e,0,i,o,w,T,0,0,0,a]
        Returns:
            None
    """</span>
    <span class="hljs-comment"># adjust time of perihelion from results to match period of calculated time of perihelion</span>
    period=results[<span class="hljs-number">9</span>]**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>)*self.toGaussian
    results[<span class="hljs-number">5</span>]=self.time-((self.time-results[<span class="hljs-number">5</span>])%period) <span class="hljs-comment"># subtract the change in time since the last perihelion from the obs 2 time </span>
    self.od.printError(results)</code></pre>
</details>
</dd>
<dt id="odlib.OD.getFGVals"><code class="name flex">
<span>def <span class="ident">getFGVals</span></span>(<span>self, 
tau1:&nbsp;float, tau3:&nbsp;float, r2mag:&nbsp;float, r2dot:&nbsp;list,
 order1:&nbsp;int, order2:&nbsp;int, r2:&nbsp;list&nbsp;=&nbsp;[])</span>
</code></dt>
<dd>
<div class="desc"><p>Gets all f and g values</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>tau1</code></strong> : <code>float</code></dt>
<dd>the time in Julian Days for observation 1 from obs 2(T1-T2)</dd>
<dt><strong><code>tau3</code></strong> : <code>float</code></dt>
<dd>the time in Julian days for observation 3 from obs 2(T3-T2)</dd>
<dt><strong><code>r2mag</code></strong> : <code>float</code></dt>
<dd>the magnitude of r2</dd>
<dt><strong><code>r2dot</code></strong> : <code>list</code></dt>
<dd>the velocity vector 2</dd>
<dt><strong><code>order1</code></strong> : <code>int</code></dt>
<dd>Order of Taylor Series expansion for f and g values for observation 1</dd>
<dt><strong><code>order2</code></strong> : <code>int</code></dt>
<dd>Order of Taylor Series expansion for f and g values for observation 3</dd>
<dt><strong><code>r2</code></strong> : <code>list</code></dt>
<dd>optional parameter, the position vector 2</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>lists</code></dt>
<dd>[f1,f3], [g1,g3]</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getFGVals</span>(<span class="hljs-params">self, tau1:float, tau3:float, r2mag:float, r2dot:list, order1:int, order2:int, r2:list=[]</span>):</span>
    <span class="hljs-string">""" Gets all f and g values
        Args:
            tau1 (float): the time in Julian Days for observation 1 from obs 2(T1-T2)
            tau3 (float): the time in Julian days for observation 3 from obs 2(T3-T2)
            r2mag (float): the magnitude of r2
            r2dot (list): the velocity vector 2
            order1 (int): Order of Taylor Series expansion for f and g values for observation 1
            order2 (int): Order of Taylor Series expansion for f and g values for observation 3
            r2 (list): optional parameter, the position vector 2
        Returns:
            lists: [f1,f3], [g1,g3]
    """</span>
    f1,g1=self.fg(tau1,r2mag,r2dot,order1,r2)
    f3,g3=self.fg(tau3,r2mag,r2dot,order2,r2)
    <span class="hljs-keyword">return</span> [f1,f3], [g1,g3]</code></pre>
</details>
</dd>
<dt id="odlib.OD.monteCarlo"><code class="name flex">
<span>def <span class="ident">monteCarlo</span></span>(<span>self, 
n:&nbsp;int, files:&nbsp;str, outputFile:&nbsp;str, results:&nbsp;list, 
selTime:&nbsp;list&nbsp;=&nbsp;[], selDate:&nbsp;list&nbsp;=&nbsp;[])</span>
</code></dt>
<dd>
<div class="desc"><p>Using uncertainty, runs through Method of Gauss n-times to generate orbital elements.
Outputs to file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>n</code></strong> : <code>int</code></dt>
<dd>number of times to run monteCarlo</dd>
<dt><strong><code>files</code></strong> : <code>list</code></dt>
<dd>list of fits file names</dd>
<dt><strong><code>outputFile</code></strong> : <code>str</code></dt>
<dd>the output file name</dd>
<dt><strong><code>results</code></strong> : <code>list</code></dt>
<dd>the actual values for error analysis [a, e, i, o, w, T]</dd>
<dt><strong><code>selTime</code></strong> : <code>list</code></dt>
<dd>optional; the selected times for which to run Method of Gauss</dd>
<dt><strong><code>selDate</code></strong> : <code>list</code></dt>
<dd>optional; the selected dates for which to run Method of Gauss</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">monteCarlo</span>(<span class="hljs-params">self, n:int, files:str, outputFile:str, results:list, selTime:list=[], selDate:list=[]</span>):</span>
    <span class="hljs-string">""" Using uncertainty, runs through Method of Gauss n-times to generate orbital elements. 
        Outputs to file.
        Args:
            n (int): number of times to run monteCarlo
            files (list): list of fits file names
            outputFile (str): the output file name
            results (list): the actual values for error analysis [a, e, i, o, w, T]
            selTime (list): optional; the selected times for which to run Method of Gauss
            selDate (list): optional; the selected dates for which to run Method of Gauss
        Returns:
            None
    """</span>
    rmsDec,rmsRA=[],[]
    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:
        data = fits.open(file)[<span class="hljs-number">1</span>].data
        
        fieldDec, indexDec = data.field_dec[:], data.index_dec[:]
        fieldRA, indexRA = data.field_ra[:], data.index_ra[:]
        
        dec = np.sqrt(<span class="hljs-number">1</span>/int(fieldDec.shape[<span class="hljs-number">0</span>]) * sum([(indexDec[i]-fieldDec[i])**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(fieldDec.shape[<span class="hljs-number">0</span>]))]))
        ra = np.sqrt(<span class="hljs-number">1</span>/int(fieldRA.shape[<span class="hljs-number">0</span>]) * sum([(indexRA[i]-fieldRA[i])**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(fieldDec.shape[<span class="hljs-number">0</span>]))]))
        
        rmsDec.append(dec)
        rmsRA.append(ra)
        
        
    ora, odec, R1, R2, R3, taus, ts = self.MoGGenData(<span class="hljs-literal">False</span>,selTime=selTime,selDate=selDate)
    
    vals=[]
    num=<span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> trial <span class="hljs-keyword">in</span> range(n):
        newdec = [np.deg2rad(np.random.normal()*rmsDec[i] + np.rad2deg(odec[i])) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]
        newra = [np.deg2rad(np.random.normal()*rmsRA[i] + np.rad2deg(ora[i])) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]
        works, a, e, i, o, w, T=self.MoG(selTime=selTime,selDate=selDate,override=<span class="hljs-literal">False</span>,ra=newra,dec=newdec,loaded=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">if</span> works:
            num+=<span class="hljs-number">1</span>
            calcVals=[num,a,e,i,o,w,T] <span class="hljs-comment"># sus</span>
            vals.append(calcVals)
            vals.append(calcVals)
            
    <span class="hljs-comment"># adjust time of perihelion for results</span>
    <span class="hljs-comment"># for time of perihelion, need to adjust to be close to the given observation time</span>
    <span class="hljs-comment"># because our calculated time of perihelion is closest to the given observation time</span>
    period=results[<span class="hljs-number">0</span>]**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>)*self.toGaussian
    results[<span class="hljs-number">5</span>]=ts[<span class="hljs-number">1</span>]-((ts[<span class="hljs-number">1</span>]-results[<span class="hljs-number">5</span>])%period) <span class="hljs-comment"># subtract the change in time since the last perihelion from the obs 2 time </span>
            
        
    <span class="hljs-comment"># write to output file</span>
    self.data.exportMonteCarlo(outputFile, vals.copy(), results)
    
    <span class="hljs-comment"># histograms</span>
    labels=[<span class="hljs-string">""</span>,<span class="hljs-string">"Semi-Major Axis"</span>,<span class="hljs-string">"Eccentricity"</span>, <span class="hljs-string">"Inclination"</span>, <span class="hljs-string">"Longitude of Ascending Node"</span>, <span class="hljs-string">"Argument of Perihelion"</span>, <span class="hljs-string">"Time of Perihelion Passage"</span>]
    xlabels=[<span class="hljs-string">"AU"</span>,<span class="hljs-string">"Value"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Degrees"</span>,<span class="hljs-string">"Julian Day Number"</span>]
    custom_lines = [Line2D([<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>], color=<span class="hljs-string">'black'</span>, linestyle=<span class="hljs-string">'dashed'</span>,lw=<span class="hljs-number">1</span>), Line2D([<span class="hljs-number">0</span>], [<span class="hljs-number">0</span>], color=<span class="hljs-string">'blue'</span>, lw=<span class="hljs-number">1</span>)]

    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">5</span>):
        mean=sum([vals[i][<span class="hljs-number">1</span>+j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals)
        sdom=np.sqrt(sum([(vals[i][j+<span class="hljs-number">1</span>]-mean)**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals))
        
        plt.hist([vals[i][<span class="hljs-number">1</span>+j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))],bins=<span class="hljs-number">20</span>)
        plt.axvline(results[j], color=<span class="hljs-string">'k'</span>, linestyle=<span class="hljs-string">'dashed'</span>, linewidth=<span class="hljs-number">1</span>)
        plt.axvline(mean, color=<span class="hljs-string">'b'</span>, linewidth=<span class="hljs-number">1</span>)
        plt.title(labels[<span class="hljs-number">1</span>+j])
        plt.legend(custom_lines, [<span class="hljs-string">'True Value'</span>, <span class="hljs-string">'Mean'</span>])
        plt.xlabel(xlabels[j])
        plt.ylabel(<span class="hljs-string">"Frequency"</span>)
        plt.show()

        print(labels[j+<span class="hljs-number">1</span>]+<span class="hljs-string">": \n\tmean: "</span>+str(mean)+<span class="hljs-string">"\n\terror: "</span> + str(error(results[j],mean)) + <span class="hljs-string">"\n\tstandard deviation of mean: "</span> + str(sdom) + <span class="hljs-string">"\n"</span>)

    <span class="hljs-comment"># special case for time of perihelion</span>
    mean=sum([vals[i][<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals)
    sdom=np.sqrt(sum([(vals[i][<span class="hljs-number">6</span>]-mean)**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))])/len(vals))
        
    plt.hist([vals[i][<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))],bins=<span class="hljs-number">20</span>)
    plt.axvline(results[<span class="hljs-number">5</span>], color=<span class="hljs-string">'k'</span>, linestyle=<span class="hljs-string">'dashed'</span>, linewidth=<span class="hljs-number">1</span>)
    plt.axvline(mean, color=<span class="hljs-string">'b'</span>, linewidth=<span class="hljs-number">1</span>)
    plt.title(labels[<span class="hljs-number">6</span>])
    plt.legend(custom_lines, [<span class="hljs-string">'True Value'</span>, <span class="hljs-string">'Mean'</span>])
    plt.xlabel(xlabels[<span class="hljs-number">5</span>])
    plt.ylabel(<span class="hljs-string">"Frequency"</span>)
    plt.show()

    print(labels[<span class="hljs-number">6</span>]+<span class="hljs-string">": \n\tmean: "</span>+str(mean)+ <span class="hljs-string">"\n\terror: "</span> + str(error(results[<span class="hljs-number">5</span>],mean)) + <span class="hljs-string">"\n\tstandard deviation of mean: "</span> + str(sdom) + <span class="hljs-string">"\n"</span>)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="odlib.ODElements"><code class="flex name class">
<span>class <span class="ident">ODElements</span></span>
<span>(</span><span>pos:&nbsp;list, vel:&nbsp;list, time:&nbsp;float)</span>
</code></dt>
<dd>
<div class="desc"><p>Class that represents and calculates orbital elements</p>
<p>Initializes ODElements class</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pos</code></strong> : <code>list</code></dt>
<dd>position of asteroid</dd>
<dt><strong><code>vel</code></strong> : <code>list</code></dt>
<dd>velocity of asteroid (non Gaussian)</dd>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>given time in julian days</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ODElements</span>:</span>
    <span class="hljs-string">'''Class that represents and calculates orbital elements'''</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, pos:list, vel:list, time:float</span>):</span>
        <span class="hljs-string">""" Initializes ODElements class
            Args:
                pos (list): position of asteroid
                vel (list): velocity of asteroid (non Gaussian)
                time (float): given time in julian days
            Returns:
                None
        """</span>
        <span class="hljs-comment"># constants</span>
        self.k = <span class="hljs-number">0.0172020989484</span> <span class="hljs-comment"># au^(3/2)/day</span>
        
        self.time=time
        self.vel=vel
        self.vel=np.array([self.vel[i]/(<span class="hljs-number">2</span>*math.pi)*<span class="hljs-number">365.2568983</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]) <span class="hljs-comment"># convert to Gaussian</span>
        self.pos=pos
        self.angMoment=self.getAngMoment()
        
        self.mu=<span class="hljs-number">1</span>
        self.a=self.getSemiMajor() <span class="hljs-comment"># semi-major axis</span>
        self.e= self.getEcc() <span class="hljs-comment"># eccentricity</span>
        self.i=self.getInc() <span class="hljs-comment"># inclination</span>
        self.o=self.getLongAsc() <span class="hljs-comment"># longitude of ascending node</span>
        self.v=self.getTrueAnom() <span class="hljs-comment"># true anomaly</span>
        self.w=self.getArgPer() <span class="hljs-comment"># argument of perihelion</span>
        self.M=self.getMeanAnomaly() <span class="hljs-comment"># mean anomaly</span>
        self.T=self.getPeriT() <span class="hljs-comment"># time of perihelion passage T</span>
      
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns info from given day from initialization
            Args:
                None
            Returns:
                list: all info
        """</span>
        <span class="hljs-keyword">return</span> self.info
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPos</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns the position of the asteroid
            Args:
                None
            Returns:
                list: the position
        """</span>
        <span class="hljs-keyword">return</span> self.pos
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getVel</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Returns the velocity of the asteroid
            Args:
                None
            Returns:
                list: the velocity
        """</span>
        <span class="hljs-keyword">return</span> self.vel
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPosMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns the magnitude of the position vector
            Args:
                None
            Returns:
                float: magnitude of position
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(sum([self.pos[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getVelMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns the magnitude of the velocity vector
            Args:
                None
            Returns:
                float: magnitude of velocity
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(sum([self.vel[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngMoment</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
        <span class="hljs-string">""" Calculates and returns the specific angular momentum
            Args:
                None
            Returns:
                list: specific angular momentum components
        """</span>
        pos,vel=self.getPos(),self.getVel()
        res=cross(pos,vel)
        <span class="hljs-keyword">return</span> np.array([res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>], res[<span class="hljs-number">2</span>]])
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngMomentMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Returns the magnitude of the specific angular momentum
            Args:
                None
            Returns:
                float: the magnitude of specific angular momentum
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(sum([self.angMoment[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSemiMajor</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the semi major axis using vis-viva
            Args:
                None
            Returns:
                float: the semi major axis
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/(<span class="hljs-number">2</span>/self.getPosMag() - dot(self.vel,self.vel)/self.mu)
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getEcc</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the eccentricity
            Args:
                None
            Returns:
                float: eccentricity
        """</span>
        <span class="hljs-keyword">return</span> math.sqrt(<span class="hljs-number">1</span>-dot(self.angMoment, self.angMoment)/(self.mu*self.a))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInc</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the inclination in degrees
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the inclination in degrees or radians
        """</span>
        <span class="hljs-keyword">return</span> math.acos(self.angMoment[<span class="hljs-number">2</span>]/self.getAngMomentMag()) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(math.acos(self.angMoment[<span class="hljs-number">2</span>]/self.getAngMomentMag()))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getLongAsc</span>(<span class="hljs-params">self, rad:bool=False</span>):</span>
        <span class="hljs-string">""" Calculates and returns the longitude of ascending node in degrees
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the longitude of ascending node in degrees or radians
        """</span>
        s=self.angMoment[<span class="hljs-number">0</span>]/(self.getAngMomentMag()*math.sin(np.deg2rad(self.i)))
        c=-self.angMoment[<span class="hljs-number">1</span>]/(self.getAngMomentMag()*math.sin(np.deg2rad(self.i)))
        <span class="hljs-keyword">return</span> getAngle(s,c) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(getAngle(s,c))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getArgPer</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the argument of perihelion in degrees
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the longitude of ascending node in degrees or radians
        """</span>
        x,y,z=self.pos[<span class="hljs-number">0</span>],self.pos[<span class="hljs-number">1</span>],self.pos[<span class="hljs-number">2</span>]
        s=z/(self.getPosMag()*math.sin(np.deg2rad(self.i)))
        c=(x*math.cos(np.deg2rad(self.o)) + y*math.sin(np.deg2rad(self.o)))/self.getPosMag()
        U=np.rad2deg(getAngle(s,c))
        <span class="hljs-keyword">return</span> np.deg2rad((U-self.v)%<span class="hljs-number">360</span>) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> (U-self.v)%<span class="hljs-number">360</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTrueAnom</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the true anomaly
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the true anomaly in degrees or radians
        """</span>
        c=<span class="hljs-number">1</span>/self.e*(self.a*(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)/self.getPosMag() - <span class="hljs-number">1</span>)
        s=self.a*(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)/(self.getAngMomentMag() * self.e)*dot(self.pos,self.vel)/self.getPosMag()
        <span class="hljs-keyword">return</span> getAngle(s,c) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(getAngle(s,c))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPeriT</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the time of perihelion
            Args:
                None
            Returns:
                float: the time of perihelion
        """</span>
        n=self.k/(self.a**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>))
        <span class="hljs-keyword">return</span> self.time-np.deg2rad(self.M)/n
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getMeanAnomaly</span>(<span class="hljs-params">self,rad:bool=False</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates and returns the mean anomaly
            Args:
                rad (bool): True if return in radians
            Returns:
                float: the mean anomaly in degrees or radians
        """</span>
        s=(self.getPosMag()*math.sin(np.deg2rad(self.v)))/(self.a*np.sqrt(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>))
        c=(self.e+np.cos(np.deg2rad(self.v)))/(<span class="hljs-number">1</span>+self.e*np.cos(np.deg2rad(self.v)))
        E=getAngle(s,c)
        <span class="hljs-keyword">return</span> E-self.e*np.sin(E) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(E-self.e*np.sin(E))
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTimeMeanAnomaly</span>(<span class="hljs-params">self, time:float, date:str</span>)-&gt;float:</span>
        <span class="hljs-string">""" Calculates mean anomaly for given date
            Args:
                time (float): time in Julian days for the Mean Anomaly
                date (str): date for Mean Anomaly
            Returns:
                float: mean anomaly in degrees
        """</span>
        n=self.k*np.sqrt(self.mu/(self.a**<span class="hljs-number">3</span>))
        M=np.rad2deg(n*(time-self.T))
        <span class="hljs-keyword">return</span> M
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printError</span>(<span class="hljs-params">self, results:list</span>):</span>
        <span class="hljs-string">""" Prints everything
            Args:
                None
            Returns:
                None
        """</span>
        <span class="hljs-comment"># EC, QR, IN, OM, W, Tp, N, MA, TA, A, AD, PR,</span>
        print(<span class="hljs-string">"Semi-major axis:"</span>, <span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">9</span>], <span class="hljs-string">"\n\tcalculated:"</span>,self.a, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">9</span>],self.a))
        print(<span class="hljs-string">"Eccentricity:"</span>, <span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">0</span>], <span class="hljs-string">"\n\tcalculated:"</span>,self.e, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">0</span>],self.e))
        print(<span class="hljs-string">"Inclination:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">2</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.i, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">2</span>],self.i))
        print(<span class="hljs-string">"Longitude of Ascending Node:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">3</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.o, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">3</span>],self.o))
        <span class="hljs-comment">#print("True anomaly:",results[8],self.v,error(results[8],self.v))</span>
        print(<span class="hljs-string">"Argument of perihelion:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">4</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.w, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">4</span>],self.w))
        print(<span class="hljs-string">"Time of Perihelion Passage T:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">5</span>],<span class="hljs-string">"\n\tcalculated:"</span>, self.T,<span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">5</span>],self.T))
        <span class="hljs-comment">#print("Mean Anomaly:",results[7],self.M,error(results[7],self.M))</span>
        <span class="hljs-comment">#print(od.a, od.e, od.i, od.o, od.v, od.w)</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getElements</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">""" Returns all orbital elements
            Args:
                rad (bool): True if return in radians
            Returns:
                floats: a,e,i,o,v,w,T,M
        """</span>
        <span class="hljs-keyword">return</span> self.a, self.e, self.i, self.o, self.v, self.w, self.T, self.M</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="odlib.ODElements.getAngMoment"><code class="name flex">
<span>def <span class="ident">getAngMoment</span></span>(<span>self) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the specific angular momentum</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>specific angular momentum components</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngMoment</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
    <span class="hljs-string">""" Calculates and returns the specific angular momentum
        Args:
            None
        Returns:
            list: specific angular momentum components
    """</span>
    pos,vel=self.getPos(),self.getVel()
    res=cross(pos,vel)
    <span class="hljs-keyword">return</span> np.array([res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>], res[<span class="hljs-number">2</span>]])</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getAngMomentMag"><code class="name flex">
<span>def <span class="ident">getAngMomentMag</span></span>(<span>self) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the magnitude of the specific angular momentum</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the magnitude of specific angular momentum</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAngMomentMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the magnitude of the specific angular momentum
        Args:
            None
        Returns:
            float: the magnitude of specific angular momentum
    """</span>
    <span class="hljs-keyword">return</span> math.sqrt(sum([self.angMoment[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getArgPer"><code class="name flex">
<span>def <span class="ident">getArgPer</span></span>(<span>self, rad:&nbsp;bool&nbsp;=&nbsp;False) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the argument of perihelion in degrees</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the longitude of ascending node in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getArgPer</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the argument of perihelion in degrees
        Args:
            rad (bool): True if return in radians
        Returns:
            float: the longitude of ascending node in degrees or radians
    """</span>
    x,y,z=self.pos[<span class="hljs-number">0</span>],self.pos[<span class="hljs-number">1</span>],self.pos[<span class="hljs-number">2</span>]
    s=z/(self.getPosMag()*math.sin(np.deg2rad(self.i)))
    c=(x*math.cos(np.deg2rad(self.o)) + y*math.sin(np.deg2rad(self.o)))/self.getPosMag()
    U=np.rad2deg(getAngle(s,c))
    <span class="hljs-keyword">return</span> np.deg2rad((U-self.v)%<span class="hljs-number">360</span>) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> (U-self.v)%<span class="hljs-number">360</span></code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getEcc"><code class="name flex">
<span>def <span class="ident">getEcc</span></span>(<span>self) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the eccentricity</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>eccentricity</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getEcc</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the eccentricity
        Args:
            None
        Returns:
            float: eccentricity
    """</span>
    <span class="hljs-keyword">return</span> math.sqrt(<span class="hljs-number">1</span>-dot(self.angMoment, self.angMoment)/(self.mu*self.a))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getElements"><code class="name flex">
<span>def <span class="ident">getElements</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns all orbital elements</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>floats</code></dt>
<dd>a,e,i,o,v,w,T,M</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getElements</span>(<span class="hljs-params">self</span>):</span>
    <span class="hljs-string">""" Returns all orbital elements
        Args:
            rad (bool): True if return in radians
        Returns:
            floats: a,e,i,o,v,w,T,M
    """</span>
    <span class="hljs-keyword">return</span> self.a, self.e, self.i, self.o, self.v, self.w, self.T, self.M</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getInc"><code class="name flex">
<span>def <span class="ident">getInc</span></span>(<span>self, rad:&nbsp;bool&nbsp;=&nbsp;False) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the inclination in degrees</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the inclination in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInc</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the inclination in degrees
        Args:
            rad (bool): True if return in radians
        Returns:
            float: the inclination in degrees or radians
    """</span>
    <span class="hljs-keyword">return</span> math.acos(self.angMoment[<span class="hljs-number">2</span>]/self.getAngMomentMag()) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(math.acos(self.angMoment[<span class="hljs-number">2</span>]/self.getAngMomentMag()))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getInfo"><code class="name flex">
<span>def <span class="ident">getInfo</span></span>(<span>self) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Returns info from given day from initialization</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>all info</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns info from given day from initialization
        Args:
            None
        Returns:
            list: all info
    """</span>
    <span class="hljs-keyword">return</span> self.info</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getLongAsc"><code class="name flex">
<span>def <span class="ident">getLongAsc</span></span>(<span>self, rad:&nbsp;bool&nbsp;=&nbsp;False)</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the longitude of ascending node in degrees</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the longitude of ascending node in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getLongAsc</span>(<span class="hljs-params">self, rad:bool=False</span>):</span>
    <span class="hljs-string">""" Calculates and returns the longitude of ascending node in degrees
        Args:
            rad (bool): True if return in radians
        Returns:
            float: the longitude of ascending node in degrees or radians
    """</span>
    s=self.angMoment[<span class="hljs-number">0</span>]/(self.getAngMomentMag()*math.sin(np.deg2rad(self.i)))
    c=-self.angMoment[<span class="hljs-number">1</span>]/(self.getAngMomentMag()*math.sin(np.deg2rad(self.i)))
    <span class="hljs-keyword">return</span> getAngle(s,c) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(getAngle(s,c))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getMeanAnomaly"><code class="name flex">
<span>def <span class="ident">getMeanAnomaly</span></span>(<span>self, rad:&nbsp;bool&nbsp;=&nbsp;False) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the mean anomaly</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the mean anomaly in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getMeanAnomaly</span>(<span class="hljs-params">self,rad:bool=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the mean anomaly
        Args:
            rad (bool): True if return in radians
        Returns:
            float: the mean anomaly in degrees or radians
    """</span>
    s=(self.getPosMag()*math.sin(np.deg2rad(self.v)))/(self.a*np.sqrt(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>))
    c=(self.e+np.cos(np.deg2rad(self.v)))/(<span class="hljs-number">1</span>+self.e*np.cos(np.deg2rad(self.v)))
    E=getAngle(s,c)
    <span class="hljs-keyword">return</span> E-self.e*np.sin(E) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(E-self.e*np.sin(E))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getPeriT"><code class="name flex">
<span>def <span class="ident">getPeriT</span></span>(<span>self) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the time of perihelion</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the time of perihelion</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPeriT</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the time of perihelion
        Args:
            None
        Returns:
            float: the time of perihelion
    """</span>
    n=self.k/(self.a**(<span class="hljs-number">3</span>/<span class="hljs-number">2</span>))
    <span class="hljs-keyword">return</span> self.time-np.deg2rad(self.M)/n</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getPos"><code class="name flex">
<span>def <span class="ident">getPos</span></span>(<span>self) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the position of the asteroid</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>the position</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPos</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns the position of the asteroid
        Args:
            None
        Returns:
            list: the position
    """</span>
    <span class="hljs-keyword">return</span> self.pos</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getPosMag"><code class="name flex">
<span>def <span class="ident">getPosMag</span></span>(<span>self) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the magnitude of the position vector</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>magnitude of position</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPosMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the magnitude of the position vector
        Args:
            None
        Returns:
            float: magnitude of position
    """</span>
    <span class="hljs-keyword">return</span> math.sqrt(sum([self.pos[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getSemiMajor"><code class="name flex">
<span>def <span class="ident">getSemiMajor</span></span>(<span>self) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the semi major axis using vis-viva</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the semi major axis</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSemiMajor</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the semi major axis using vis-viva
        Args:
            None
        Returns:
            float: the semi major axis
    """</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/(<span class="hljs-number">2</span>/self.getPosMag() - dot(self.vel,self.vel)/self.mu)</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getTimeMeanAnomaly"><code class="name flex">
<span>def <span class="ident">getTimeMeanAnomaly</span></span>(<span>self, time:&nbsp;float, date:&nbsp;str) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates mean anomaly for given date</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>time</code></strong> : <code>float</code></dt>
<dd>time in Julian days for the Mean Anomaly</dd>
<dt><strong><code>date</code></strong> : <code>str</code></dt>
<dd>date for Mean Anomaly</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>mean anomaly in degrees</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTimeMeanAnomaly</span>(<span class="hljs-params">self, time:float, date:str</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates mean anomaly for given date
        Args:
            time (float): time in Julian days for the Mean Anomaly
            date (str): date for Mean Anomaly
        Returns:
            float: mean anomaly in degrees
    """</span>
    n=self.k*np.sqrt(self.mu/(self.a**<span class="hljs-number">3</span>))
    M=np.rad2deg(n*(time-self.T))
    <span class="hljs-keyword">return</span> M</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getTrueAnom"><code class="name flex">
<span>def <span class="ident">getTrueAnom</span></span>(<span>self, rad:&nbsp;bool&nbsp;=&nbsp;False) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Calculates and returns the true anomaly</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>rad</code></strong> : <code>bool</code></dt>
<dd>True if return in radians</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>the true anomaly in degrees or radians</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTrueAnom</span>(<span class="hljs-params">self, rad:bool=False</span>)-&gt;float:</span>
    <span class="hljs-string">""" Calculates and returns the true anomaly
        Args:
            rad (bool): True if return in radians
        Returns:
            float: the true anomaly in degrees or radians
    """</span>
    c=<span class="hljs-number">1</span>/self.e*(self.a*(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)/self.getPosMag() - <span class="hljs-number">1</span>)
    s=self.a*(<span class="hljs-number">1</span>-self.e**<span class="hljs-number">2</span>)/(self.getAngMomentMag() * self.e)*dot(self.pos,self.vel)/self.getPosMag()
    <span class="hljs-keyword">return</span> getAngle(s,c) <span class="hljs-keyword">if</span> rad <span class="hljs-keyword">else</span> np.rad2deg(getAngle(s,c))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getVel"><code class="name flex">
<span>def <span class="ident">getVel</span></span>(<span>self) ‑&gt;&nbsp;list</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the velocity of the asteroid</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>the velocity</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getVel</span>(<span class="hljs-params">self</span>)-&gt;list:</span>
    <span class="hljs-string">""" Returns the velocity of the asteroid
        Args:
            None
        Returns:
            list: the velocity
    """</span>
    <span class="hljs-keyword">return</span> self.vel</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.getVelMag"><code class="name flex">
<span>def <span class="ident">getVelMag</span></span>(<span>self) ‑&gt;&nbsp;float</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the magnitude of the velocity vector</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>magnitude of velocity</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getVelMag</span>(<span class="hljs-params">self</span>)-&gt;float:</span>
    <span class="hljs-string">""" Returns the magnitude of the velocity vector
        Args:
            None
        Returns:
            float: magnitude of velocity
    """</span>
    <span class="hljs-keyword">return</span> math.sqrt(sum([self.vel[i]**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>)]))</code></pre>
</details>
</dd>
<dt id="odlib.ODElements.printError"><code class="name flex">
<span>def <span class="ident">printError</span></span>(<span>self, results:&nbsp;list)</span>
</code></dt>
<dd>
<div class="desc"><p>Prints everything</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printError</span>(<span class="hljs-params">self, results:list</span>):</span>
    <span class="hljs-string">""" Prints everything
        Args:
            None
        Returns:
            None
    """</span>
    <span class="hljs-comment"># EC, QR, IN, OM, W, Tp, N, MA, TA, A, AD, PR,</span>
    print(<span class="hljs-string">"Semi-major axis:"</span>, <span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">9</span>], <span class="hljs-string">"\n\tcalculated:"</span>,self.a, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">9</span>],self.a))
    print(<span class="hljs-string">"Eccentricity:"</span>, <span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">0</span>], <span class="hljs-string">"\n\tcalculated:"</span>,self.e, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">0</span>],self.e))
    print(<span class="hljs-string">"Inclination:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">2</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.i, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">2</span>],self.i))
    print(<span class="hljs-string">"Longitude of Ascending Node:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">3</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.o, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">3</span>],self.o))
    <span class="hljs-comment">#print("True anomaly:",results[8],self.v,error(results[8],self.v))</span>
    print(<span class="hljs-string">"Argument of perihelion:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">4</span>],<span class="hljs-string">"\n\tcalculated:"</span>,self.w, <span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">4</span>],self.w))
    print(<span class="hljs-string">"Time of Perihelion Passage T:"</span>,<span class="hljs-string">"\n\tactual:"</span>,results[<span class="hljs-number">5</span>],<span class="hljs-string">"\n\tcalculated:"</span>, self.T,<span class="hljs-string">"\n\terror:"</span>,error(results[<span class="hljs-number">5</span>],self.T))</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="odlib.DECdecimalToDMS" href="http://localhost:1111/odlib.html#odlib.DECdecimalToDMS">DECdecimalToDMS</a></code></li>
<li><code><a title="odlib.DMStoDeg" href="http://localhost:1111/odlib.html#odlib.DMStoDeg">DMStoDeg</a></code></li>
<li><code><a title="odlib.GenerateEphemeris" href="http://localhost:1111/odlib.html#odlib.GenerateEphemeris">GenerateEphemeris</a></code></li>
<li><code><a title="odlib.HMStoDeg" href="http://localhost:1111/odlib.html#odlib.HMStoDeg">HMStoDeg</a></code></li>
<li><code><a title="odlib.RAdecimalToHMS" href="http://localhost:1111/odlib.html#odlib.RAdecimalToHMS">RAdecimalToHMS</a></code></li>
<li><code><a title="odlib.RunCompleteOD" href="http://localhost:1111/odlib.html#odlib.RunCompleteOD">RunCompleteOD</a></code></li>
<li><code><a title="odlib.cross" href="http://localhost:1111/odlib.html#odlib.cross">cross</a></code></li>
<li><code><a title="odlib.decToRad" href="http://localhost:1111/odlib.html#odlib.decToRad">decToRad</a></code></li>
<li><code><a title="odlib.det2x2" href="http://localhost:1111/odlib.html#odlib.det2x2">det2x2</a></code></li>
<li><code><a title="odlib.dot" href="http://localhost:1111/odlib.html#odlib.dot">dot</a></code></li>
<li><code><a title="odlib.error" href="http://localhost:1111/odlib.html#odlib.error">error</a></code></li>
<li><code><a title="odlib.getAngle" href="http://localhost:1111/odlib.html#odlib.getAngle">getAngle</a></code></li>
<li><code><a title="odlib.getMag" href="http://localhost:1111/odlib.html#odlib.getMag">getMag</a></code></li>
<li><code><a title="odlib.newton" href="http://localhost:1111/odlib.html#odlib.newton">newton</a></code></li>
<li><code><a title="odlib.rotX" href="http://localhost:1111/odlib.html#odlib.rotX">rotX</a></code></li>
<li><code><a title="odlib.rotZX" href="http://localhost:1111/odlib.html#odlib.rotZX">rotZX</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="odlib.Data" href="http://localhost:1111/odlib.html#odlib.Data">Data</a></code></h4>
<ul class="two-column">
<li><code><a title="odlib.Data.exportEphemeris" href="http://localhost:1111/odlib.html#odlib.Data.exportEphemeris">exportEphemeris</a></code></li>
<li><code><a title="odlib.Data.exportMonteCarlo" href="http://localhost:1111/odlib.html#odlib.Data.exportMonteCarlo">exportMonteCarlo</a></code></li>
<li><code><a title="odlib.Data.formatTestInputInfo" href="http://localhost:1111/odlib.html#odlib.Data.formatTestInputInfo">formatTestInputInfo</a></code></li>
<li><code><a title="odlib.Data.getAllSunPos" href="http://localhost:1111/odlib.html#odlib.Data.getAllSunPos">getAllSunPos</a></code></li>
<li><code><a title="odlib.Data.getInput" href="http://localhost:1111/odlib.html#odlib.Data.getInput">getInput</a></code></li>
<li><code><a title="odlib.Data.getJDTime" href="http://localhost:1111/odlib.html#odlib.Data.getJDTime">getJDTime</a></code></li>
<li><code><a title="odlib.Data.getRADECInput" href="http://localhost:1111/odlib.html#odlib.Data.getRADECInput">getRADECInput</a></code></li>
<li><code><a title="odlib.Data.getSunInput" href="http://localhost:1111/odlib.html#odlib.Data.getSunInput">getSunInput</a></code></li>
<li><code><a title="odlib.Data.getSunPos" href="http://localhost:1111/odlib.html#odlib.Data.getSunPos">getSunPos</a></code></li>
<li><code><a title="odlib.Data.getTestInput" href="http://localhost:1111/odlib.html#odlib.Data.getTestInput">getTestInput</a></code></li>
<li><code><a title="odlib.Data.printResults" href="http://localhost:1111/odlib.html#odlib.Data.printResults">printResults</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="odlib.OD" href="http://localhost:1111/odlib.html#odlib.OD">OD</a></code></h4>
<ul class="two-column">
<li><code><a title="odlib.OD.MoG" href="http://localhost:1111/odlib.html#odlib.OD.MoG">MoG</a></code></li>
<li><code><a title="odlib.OD.MoGCalcPos" href="http://localhost:1111/odlib.html#odlib.OD.MoGCalcPos">MoGCalcPos</a></code></li>
<li><code><a title="odlib.OD.MoGCalcRhos" href="http://localhost:1111/odlib.html#odlib.OD.MoGCalcRhos">MoGCalcRhos</a></code></li>
<li><code><a title="odlib.OD.MoGGenData" href="http://localhost:1111/odlib.html#odlib.OD.MoGGenData">MoGGenData</a></code></li>
<li><code><a title="odlib.OD.MoGGetAdjustedTaus" href="http://localhost:1111/odlib.html#odlib.OD.MoGGetAdjustedTaus">MoGGetAdjustedTaus</a></code></li>
<li><code><a title="odlib.OD.MoGGetErr" href="http://localhost:1111/odlib.html#odlib.OD.MoGGetErr">MoGGetErr</a></code></li>
<li><code><a title="odlib.OD.SEL" href="http://localhost:1111/odlib.html#odlib.OD.SEL">SEL</a></code></li>
<li><code><a title="odlib.OD.ephemeris" href="http://localhost:1111/odlib.html#odlib.OD.ephemeris">ephemeris</a></code></li>
<li><code><a title="odlib.OD.exportResults" href="http://localhost:1111/odlib.html#odlib.OD.exportResults">exportResults</a></code></li>
<li><code><a title="odlib.OD.fg" href="http://localhost:1111/odlib.html#odlib.OD.fg">fg</a></code></li>
<li><code><a title="odlib.OD.genElements" href="http://localhost:1111/odlib.html#odlib.OD.genElements">genElements</a></code></li>
<li><code><a title="odlib.OD.genEphemeris" href="http://localhost:1111/odlib.html#odlib.OD.genEphemeris">genEphemeris</a></code></li>
<li><code><a title="odlib.OD.getDCoef" href="http://localhost:1111/odlib.html#odlib.OD.getDCoef">getDCoef</a></code></li>
<li><code><a title="odlib.OD.getElements" href="http://localhost:1111/odlib.html#odlib.OD.getElements">getElements</a></code></li>
<li><code><a title="odlib.OD.getError" href="http://localhost:1111/odlib.html#odlib.OD.getError">getError</a></code></li>
<li><code><a title="odlib.OD.getFGVals" href="http://localhost:1111/odlib.html#odlib.OD.getFGVals">getFGVals</a></code></li>
<li><code><a title="odlib.OD.monteCarlo" href="http://localhost:1111/odlib.html#odlib.OD.monteCarlo">monteCarlo</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="odlib.ODElements" href="http://localhost:1111/odlib.html#odlib.ODElements">ODElements</a></code></h4>
<ul class="two-column">
<li><code><a title="odlib.ODElements.getAngMoment" href="http://localhost:1111/odlib.html#odlib.ODElements.getAngMoment">getAngMoment</a></code></li>
<li><code><a title="odlib.ODElements.getAngMomentMag" href="http://localhost:1111/odlib.html#odlib.ODElements.getAngMomentMag">getAngMomentMag</a></code></li>
<li><code><a title="odlib.ODElements.getArgPer" href="http://localhost:1111/odlib.html#odlib.ODElements.getArgPer">getArgPer</a></code></li>
<li><code><a title="odlib.ODElements.getEcc" href="http://localhost:1111/odlib.html#odlib.ODElements.getEcc">getEcc</a></code></li>
<li><code><a title="odlib.ODElements.getElements" href="http://localhost:1111/odlib.html#odlib.ODElements.getElements">getElements</a></code></li>
<li><code><a title="odlib.ODElements.getInc" href="http://localhost:1111/odlib.html#odlib.ODElements.getInc">getInc</a></code></li>
<li><code><a title="odlib.ODElements.getInfo" href="http://localhost:1111/odlib.html#odlib.ODElements.getInfo">getInfo</a></code></li>
<li><code><a title="odlib.ODElements.getLongAsc" href="http://localhost:1111/odlib.html#odlib.ODElements.getLongAsc">getLongAsc</a></code></li>
<li><code><a title="odlib.ODElements.getMeanAnomaly" href="http://localhost:1111/odlib.html#odlib.ODElements.getMeanAnomaly">getMeanAnomaly</a></code></li>
<li><code><a title="odlib.ODElements.getPeriT" href="http://localhost:1111/odlib.html#odlib.ODElements.getPeriT">getPeriT</a></code></li>
<li><code><a title="odlib.ODElements.getPos" href="http://localhost:1111/odlib.html#odlib.ODElements.getPos">getPos</a></code></li>
<li><code><a title="odlib.ODElements.getPosMag" href="http://localhost:1111/odlib.html#odlib.ODElements.getPosMag">getPosMag</a></code></li>
<li><code><a title="odlib.ODElements.getSemiMajor" href="http://localhost:1111/odlib.html#odlib.ODElements.getSemiMajor">getSemiMajor</a></code></li>
<li><code><a title="odlib.ODElements.getTimeMeanAnomaly" href="http://localhost:1111/odlib.html#odlib.ODElements.getTimeMeanAnomaly">getTimeMeanAnomaly</a></code></li>
<li><code><a title="odlib.ODElements.getTrueAnom" href="http://localhost:1111/odlib.html#odlib.ODElements.getTrueAnom">getTrueAnom</a></code></li>
<li><code><a title="odlib.ODElements.getVel" href="http://localhost:1111/odlib.html#odlib.ODElements.getVel">getVel</a></code></li>
<li><code><a title="odlib.ODElements.getVelMag" href="http://localhost:1111/odlib.html#odlib.ODElements.getVelMag">getVelMag</a></code></li>
<li><code><a title="odlib.ODElements.printError" href="http://localhost:1111/odlib.html#odlib.ODElements.printError">printError</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
<script>
setInterval(() =>
fetch(window.location.href, {
method: "HEAD",
cache: "no-store",
headers: {"If-None-Match": "1658383381.3163657"},
}).then(response => response.ok && window.location.reload()), 700);
</script>

</body></html>